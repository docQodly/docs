<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-language/CollectionClass">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Collection | Qodly Developer Center</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="robots" content="noindex, nofollow"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docQodly.github.io/docs/language/CollectionClass"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Collection | Qodly Developer Center"><meta data-rh="true" name="description" content="The Collection class manages collection type elements."><meta data-rh="true" property="og:description" content="The Collection class manages collection type elements."><link data-rh="true" rel="icon" href="/docs/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://docQodly.github.io/docs/language/CollectionClass"><link data-rh="true" rel="alternate" href="https://docQodly.github.io/docs/language/CollectionClass" hreflang="en"><link data-rh="true" rel="alternate" href="https://docQodly.github.io/docs/language/CollectionClass" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/docs/blog/rss.xml" title="Qodly Developer Center RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs/blog/atom.xml" title="Qodly Developer Center Atom Feed"><link rel="stylesheet" href="/docs/assets/css/styles.07ff9d41.css">
<link rel="preload" href="/docs/assets/js/runtime~main.f90c87c6.js" as="script">
<link rel="preload" href="/docs/assets/js/main.2be75749.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/Qodly-beta-D.png" alt="Qodly" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/Qodly-beta-W.png" alt="Qodly" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Docs</b></a><a class="navbar__item navbar__link" href="/docs/concepts/quickstart">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/studio/overview">Develop</a><a class="navbar__item navbar__link" href="/docs/cloud/getStarted">Run &amp; Manage</a><a class="navbar__item navbar__link" href="/docs/concepts/platform">Architecture</a><a class="navbar__item navbar__link" href="/docs/api/overview">REST API</a><a class="navbar__item navbar__link" href="/docs/customComponent/overview">Custom Components</a><a class="navbar__item navbar__link" href="/docs/faq/">FAQ</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/studio/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/studio/model/model-editor-interface">Model</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/studio/design-webforms/create-webform">Webforms</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/studio/settings">Settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/data-explorer/">Data Explorer</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/studio/coding">Coding and Debugging</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/studio/roles/accessControlMechanisms">Access Control</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/orda/data-model">Programming Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/qodlyscript">QodlyScript Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;QodlyScript Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/basics/lang-quicktour">A Quick Tour</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/language-basics">Basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/language/commands/command-list">Commands</a><button aria-label="Toggle the collapsible sidebar category &#x27;Commands&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/classes">Classes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Classes&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/BlobClass">Blob</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/ClassClass">Class</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/language/CollectionClass">Collection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/CryptoKeyClass">CryptoKey</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/DataClassClass">DataClass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/DataStoreClass">DataStore</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/EmailObjectClass">Email</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/EntityClass">Entity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/EntitySelectionClass">EntitySelection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/FileClass">File</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/FileHandleClass">FileHandle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/FolderClass">Folder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/FunctionClass">Function</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/HTTPRequestClass">HTTPRequest</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/IMAPTransporterClass">IMAPTransporter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/MailAttachmentClass">MailAttachment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/SessionClass">Session</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/SignalClass">Signal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/SystemWorkerClass">SystemWorker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/UsersClass">Users</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/WebFormClass">WebForm</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/WebFormItemClass">WebFormItem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/WebServerClass">WebServer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/ZipArchiveClass">ZIPArchive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/ZipFileClass">ZIPFile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/language/ZipFolderClass">ZIPFolder</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/qodlyscript"><span itemprop="name">QodlyScript Reference</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/classes"><span itemprop="name">Classes</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Collection</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Collection</h1></header><p>The Collection class manages <a href="/docs/language/basics/lang-collection">collection</a> type elements.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h3><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c : collection //declaration of collection type variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection() //initialization of the collection and assignment to the variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(&quot;Hello&quot;,42,{o : &quot;World&quot;}) // c contains [Hello,42,{&quot;o&quot;:&quot;World&quot;}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="functions-and-properties">Functions and properties<a href="#functions-and-properties" class="hash-link" aria-label="Direct link to Functions and properties" title="Direct link to Functions and properties">​</a></h3><table><thead><tr><th></th></tr></thead><tbody><tr><td><a href="#at"><strong>.at</strong>( <em>index</em> : integer ) : any </a> <!-- --> <!-- --> <!-- --> <!-- -->returns the item at position <em>index</em>, allowing for positive and negative integers</td></tr><tr><td><a href="#average"><strong>.average</strong>( {<em>propertyPath</em> : string } ) : number</a> <!-- --> <!-- --> <!-- --> <!-- -->returns the arithmetic mean (average) of defined values in the collection instance</td></tr><tr><td><a href="#clear"><strong>.clear</strong>() : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->removes all elements from the collection instance and returns an empty collection</td></tr><tr><td><a href="#combine"><strong>.combine</strong>( <em>col2</em> : collection {, <em>index</em> : integer } ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->inserts <em>col2</em> elements at the end or at the specified <em>index</em> position in the collection instance and returns the edited collection</td></tr><tr><td><a href="#concat"><strong>.concat</strong>( <em>value</em> : any { <em>,...valueN</em> } ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->returns a new collection containing the elements of the original collection with all elements of the <em>value</em> parameter added to the end</td></tr><tr><td><a href="#copy"><strong>.copy</strong>() : collection<br><strong>.copy</strong>( <em>option</em> : integer ) : collection<br><strong>.copy</strong>( <em>option</em> : integer , <em>groupWithCol</em> : collection ) : collection<br><strong>.copy</strong>( <em>option</em> : integer , <em>groupWithObj</em> : object ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- --> returns a deep copy of the collection instance</td></tr><tr><td><a href="#count"><strong>.count</strong>( { <em>propertyPath</em> : string } ) : number</a> <!-- --> <!-- --> <!-- --> <!-- -->returns the number of non-null elements in the collection</td></tr><tr><td><a href="#countvalues"><strong>.countValues</strong>( <em>value</em> : any {, <em>propertyPath</em> : string } ) : number</a> <!-- --> <!-- --> <!-- --> <!-- -->returns the number of times <em>value</em> is found in the collection</td></tr><tr><td><a href="#distinct"><strong>.distinct</strong>( {<em>options</em> : integer} ) : collection<br><strong>.distinct</strong>( <em>propertyPath</em> : string {, <em>options</em> : integer } ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->returns a collection containing only distinct (different) values from the original collection</td></tr><tr><td><a href="#equal"><strong>.equal</strong>( <em>collection2</em> : collection {, <em>option</em> : integer } ) : boolean</a> <!-- --> <!-- --> <!-- --> <!-- -->compares the collection with collection2</td></tr><tr><td><a href="#every"><strong>.every</strong>( { <em>startFrom</em> : integer , } <em>formula</em> : 4D.Function { ,<em>...param</em> : any } ) : boolean<br><strong>.every</strong>( { <em>startFrom</em> : integer , } <em>methodName</em> : string { ,<em>...param</em> : any } ) : boolean</a> <!-- --> <!-- --> <!-- --> <!-- -->returns <strong>true</strong> if all elements in the collection successfully passed a test implemented in the provided <em>formula</em> object or <em>methodName</em> name</td></tr><tr><td><a href="#extract"><strong>.extract</strong>( <em>propertyPath</em> : string { , <em>option</em> : integer } ) : collection<br><strong>.extract</strong>( <em>propertyPath</em> : string ,  <em>targetPath</em> : string  { ,...<em>propertyPathN</em> : string ,... <em>targetPathN</em> : string } ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->creates and returns a new collection containing <em>propertyPath</em> values extracted from the original collection of objects</td></tr><tr><td><a href="#fill"><strong>.fill</strong>( <em>value</em> : any ) : collection<br><strong>.fill</strong>( <em>value</em> : any ,  <em>startFrom</em>  : integer { , <em>end</em> : integer } ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->fills the collection with the specified <em>value</em>, optionally from <em>startFrom</em> index to <em>end</em> index, and returns the resulting collection</td></tr><tr><td><a href="#filter"><strong>.filter</strong>( <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : collection<br><strong>.filter</strong>( <em>methodName</em> : string { , <em>...param</em> : any } ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->returns a new collection containing all elements of the original collection for which the <em>formula</em> or <em>methodName</em> result is <strong>true</strong></td></tr><tr><td><a href="#find"><strong>.find</strong>( { <em>startFrom</em> : integer , }  <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : any<br><strong>.find</strong>( { <em>startFrom</em> : integer , }  <em>methodName</em> : string { , <em>...param</em> : any } ) : any</a> <!-- --> <!-- --> <!-- --> <!-- -->returns the first value in the collection for which <em>formula</em> or <em>methodName</em> result, applied on each element, returns <strong>true</strong></td></tr><tr><td><a href="#find"><strong>.findIndex</strong>( { <em>startFrom</em> : integer , }  <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : integer<br><strong>.findIndex</strong>( { <em>startFrom</em> : integer , }  <em>methodName</em> : string { , <em>...param</em> : any } ) : integer</a> <!-- --> <!-- --> <!-- --> <!-- -->returns the index, in the collection, of the first value for which <em>formula</em> or <em>methodName</em>, applied on each element, returns <strong>true</strong></td></tr><tr><td><a href="#first"><strong>.first</strong>() : any </a> <!-- --> <!-- --> <!-- --> <!-- -->returns the first element of the collection</td></tr><tr><td><a href="#flat"><strong>.flat</strong>( { <em>depth</em> : integer } ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->creates a new collection with all sub-collection elements concatenated into it recursively up to the specified <em>depth</em></td></tr><tr><td><a href="#flatMap"><strong>.flatMap</strong>( <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : collection<br><strong>.flatMap</strong>( <em>methodName</em> : string { , <em>...param</em> : any } ) : collection </a> <!-- --> <!-- --> <!-- --> <!-- -->creates a new collection based upon the result of the call of the <em>formula</em> 4D function or <em>methodName</em> method on each element of the original collection and flattened by a depth of 1</td></tr><tr><td><a href="#includes"><strong>.includes</strong>( <em>toSearch</em> : expression { , <em>startFrom</em> : integer } ) : boolean</a> <!-- --> <!-- --> <!-- --> <!-- -->returns true if the <em>toSearch</em> expression is found among collection elements, otherwise False</td></tr><tr><td><a href="#indexof"><strong>.indexOf</strong>(  <em>toSearch</em> : expression { , <em>startFrom</em> : integer } ) : integer </a> <!-- --> <!-- --> <!-- --> <!-- -->searches the <em>toSearch</em> expression among collection elements and returns the index of the first found occurrence, or -1 if it was not found</td></tr><tr><td><a href="#indices"><strong>.indices</strong>(  <em>queryString</em> : string { , <em>...value</em> : any } ) : collection </a> <!-- --> <!-- --> <!-- --> <!-- -->returns indexes, in the original collection, of object collection elements that match the <em>queryString</em> search conditions</td></tr><tr><td><a href="#insert"><strong>.insert</strong>( <em>index</em> : integer , <em>element</em> : any ) : collection </a> <!-- --> <!-- --> <!-- --> <!-- -->inserts <em>element</em> at the specified <em>index</em> position in the collection instance and returns the edited collection</td></tr><tr><td><a href="#join"><strong>.join</strong>( <em>delimiter</em> : string { , <em>option</em> : integer } ) : string </a> <!-- --> <!-- --> <!-- --> <!-- -->converts all elements of the collection to strings and concatenates them using the specified <em>delimiter</em> string as separator</td></tr><tr><td><a href="#last"><strong>.last</strong>() : any </a> <!-- --> <!-- --> <!-- --> <!-- -->returns the last element of the collection</td></tr><tr><td><a href="#lastindexof"><strong>.lastIndexOf</strong>( <em>toSearch</em> : expression { , <em>startFrom</em> : integer } ) : integer </a> <!-- --> <!-- --> <!-- --> <!-- -->searches the <em>toSearch</em> expression among collection elements and returns the index of the last occurrence</td></tr><tr><td><a href="#length"><strong>.length</strong> : integer</a> <!-- --> <!-- --> <!-- --> <!-- -->returns the number of elements in the collection</td></tr><tr><td><a href="#map"><strong>.map</strong>( <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : collection<br><strong>.map</strong>( <em>methodName</em> : string { , <em>...param</em> : any } ) : collection </a> <!-- --> <!-- --> <!-- --> <!-- -->creates a new collection based upon the result of the call of the <em>formula</em> 4D function or <em>methodName</em> method on each element of the original collection</td></tr><tr><td><a href="#max"><strong>.max</strong>( { <em>propertyPath</em> : string } ) : any </a> <!-- --> <!-- --> <!-- --> <!-- -->returns the element with the highest value in the collection</td></tr><tr><td><a href="#min"><strong>.min</strong>( { <em>propertyPath</em> : string } ) : any </a> <!-- --> <!-- --> <!-- --> <!-- -->returns the element with the smallest value in the collection</td></tr><tr><td><a href="#multisort"><strong>.multiSort</strong>() : collection<br><strong>.multiSort</strong>( <em>colsToSort</em> : collection ) : collection<br><strong>.multiSort</strong>( <em>formula</em> : 4D.Function , <em>colsToSort</em> : collection ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->enables you to carry out a multi-level synchronized sort on a set of collections</td></tr><tr><td><a href="#orderby"><strong>.orderBy</strong>() : collection<br><strong>.orderBy</strong>( <em>pathStrings</em> : string ) : collection<br><strong>.orderBy</strong>( <em>pathobjects</em> : collection ) : collection<br><strong>.orderBy</strong>( <em>ascOrDesc</em> : integer ) : collection </a> <!-- --> <!-- --> <!-- --> <!-- -->returns a new collection containing all elements of the collection in the specified order</td></tr><tr><td><a href="#orderbymethod"><strong>.orderByMethod</strong>( <em>formula</em> : 4D.Function { , ...<em>extraParam</em> : expression } ) : collection<br><strong>.orderByMethod</strong>( <em>methodName</em> : string { , ...<em>extraParam</em> : expression } ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->returns a new collection containing all elements of the collection in the order defined through the <em>formula</em> function or <em>methodName</em> method</td></tr><tr><td><a href="#pop"><strong>.pop</strong>() : any </a> <!-- --> <!-- --> <!-- --> <!-- -->removes the last element from the collection and returns it as the function result</td></tr><tr><td><a href="#push"><strong>.push</strong>( <em>element</em> : any { ,...<em>elementN</em> } ) : collection </a> <!-- --> <!-- --> <!-- --> <!-- -->appends one or more <em>element</em>(s) to the end of the collection instance and returns the edited collection</td></tr><tr><td><a href="#query"><strong>.query</strong>( <em>queryString</em> : string , <em>...value</em> : any ) : collection<br><strong>.query</strong>( <em>queryString</em> : string , <em>querySettings</em> : object ) : collection </a> <!-- --> <!-- --> <!-- --> <!-- -->returns all elements of a collection of objects that match the search conditions</td></tr><tr><td><a href="#reduce"><strong>.reduce</strong>( <em>formula</em> : 4D.Function { , <em>initValue</em> : any { , <em>...param</em> : expression }} ) : any<br><strong>.reduce</strong>( <em>methodName</em> : string { , <em>initValue</em> : any { , <em>...param</em> : expression }} ) : any </a> <!-- --> <!-- --> <!-- --> <!-- -->applies the <em>formula</em> or <em>methodName</em> callback against an accumulator and each element in the collection (from left to right) to reduce it to a single value</td></tr><tr><td><a href="#reduceRight"><strong>.reduceRight</strong>( <em>formula</em> : 4D.Function { , <em>initValue</em> : any { , <em>...param</em> : expression }} ) : any<br><strong>.reduceRight</strong>( <em>methodName</em> : string { , <em>initValue</em> : any { , <em>...param</em> : expression }} ) : any </a> <!-- --> <!-- --> <!-- --> <!-- -->applies the <em>formula</em> or <em>methodName</em> callback against an accumulator and each element in the collection (from right to left) to reduce it to a single value</td></tr><tr><td><a href="#remove"><strong>.remove</strong>( <em>index</em> : integer { , <em>howMany</em> : integer } ) : collection </a> <!-- --> <!-- --> <!-- --> <!-- -->removes one or more element(s) from the specified <em>index</em> position in the collection and returns the edited collection</td></tr><tr><td><a href="#resize"><strong>.resize</strong>( <em>size</em> : integer { , <em>defaultValue</em> : any } ) : collection </a> <!-- --> <!-- --> <!-- --> <!-- -->sets the collection length to the specified new <em>size</em> and returns the resized collection</td></tr><tr><td><a href="#reverse"><strong>.reverse</strong>() : collection </a> <!-- --> <!-- --> <!-- --> <!-- -->returns a deep copy of the collection with all its elements in reverse order</td></tr><tr><td><a href="#shift"><strong>.shift</strong>() : any</a> <!-- --> <!-- --> <!-- --> <!-- -->removes the first element of the collection and returns it as the function result</td></tr><tr><td><a href="#slice"><strong>.slice</strong>( <em>startFrom</em> : integer { , <em>end</em> : integer } ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->returns a portion of a collection into a new collection</td></tr><tr><td><a href="#some"><strong>.some</strong>( { <em>startFrom</em> : integer , } <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : boolean<br><strong>.some</strong>( { <em>startFrom</em> : integer , } <em>methodName</em> : string { , <em>...param</em> : any } ) : boolean</a> <!-- --> <!-- --> <!-- --> <!-- -->returns true if at least one element in the collection successfully passed a test implemented in the provided <em>formula</em> or <em>methodName</em> code</td></tr><tr><td><a href="#sort"><strong>.sort</strong>() : collection<br><strong>.sort</strong>( <em>formula</em> : 4D.Function { , <em>...extraParam</em> : any } ) : collection<br><strong>.sort</strong>( <em>methodName</em> : string { , <em>...extraParam</em> : any } ) : collection </a> <!-- --> <!-- --> <!-- --> <!-- -->sorts the elements of the original collection and also returns the sorted collection</td></tr><tr><td><a href="#sum"><strong>.sum</strong>( { <em>propertyPath</em> : string } ) : number</a> <!-- --> <!-- --> <!-- --> <!-- -->returns the sum for all values in the collection instance</td></tr><tr><td><a href="#unshift"><strong>.unshift</strong>( <em>value</em> : any { ,...<em>valueN</em> : any } ) : collection</a> <!-- --> <!-- --> <!-- --> <!-- -->inserts the given <em>value</em>(s) at the beginning of the collection</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="at">.at()<a href="#at" class="hash-link" aria-label="Direct link to .at()" title="Direct link to .at()">​</a></h2><p><strong>.at</strong>( <em>index</em> : integer ) : any </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>index</td><td>integer</td><td align="center">-&gt;</td><td>Index of element to return</td></tr><tr><td>Result</td><td>any</td><td align="center">&lt;-</td><td>The element at that index</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description">Description<a href="#description" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.at()</code> function returns the item at position <em>index</em>, allowing for positive and negative integers.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>Negative integers count back from the last item in the collection.</p><p>The function returns Undefined if <em>index</em> is beyond collection limits.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1">Example<a href="#example-1" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(10, 20, 30, 40, 50)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">element = col.at(0) // 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">element = col.at(1) // 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">element = col.at(-1) // 50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">element = col.at(-2) // 40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">element = col.at(10) // undefined</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="average">.average()<a href="#average" class="hash-link" aria-label="Direct link to .average()" title="Direct link to .average()">​</a></h2><p><strong>.average</strong>( {<em>propertyPath</em> : string } ) : number</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>string</td><td align="center">-&gt;</td><td>object property path to be used for calculation</td></tr><tr><td>Result</td><td>number, undefined</td><td align="center">&lt;-</td><td>Arithmetic mean (average) of collection values</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-1">Description<a href="#description-1" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.average()</code> function returns the arithmetic mean (average) of defined values in the collection instance.</p><p>Only numerical elements are taken into account for the calculation (other element types are ignored).</p><p>If the collection contains objects, pass the <em>propertyPath</em> parameter to indicate the object property to take into account.</p><p><code>.average()</code> returns <code>undefined</code> if:</p><ul><li>the collection is empty,</li><li>the collection does not contain numerical elements,</li><li><em>propertyPath</em> is not found in the collection.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-1">Example 1<a href="#example-1-1" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var vAvg : integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(10,20,&quot;Monday&quot;,true,6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> vAvg = col.average() //12</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2">Example 2<a href="#example-2" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var vAvg : integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Smith&quot;,&quot;salary&quot;,10000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Wesson&quot;,&quot;salary&quot;,50000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Gross&quot;,&quot;salary&quot;,10500))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> vAvg = col.average(&quot;salary&quot;) //23500</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="clear">.clear()<a href="#clear" class="hash-link" aria-label="Direct link to .clear()" title="Direct link to .clear()">​</a></h2><p><strong>.clear</strong>() : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Original collection with all elements removed</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-2">Description<a href="#description-2" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.clear()</code> function removes all elements from the collection instance and returns an empty collection.</p><blockquote><p>This function modifies the original collection.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-3">Example<a href="#example-3" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(1,2,5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col.clear()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//col.length: 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="combine">.combine()<a href="#combine" class="hash-link" aria-label="Direct link to .combine()" title="Direct link to .combine()">​</a></h2><p><strong>.combine</strong>( <em>col2</em> : collection {, <em>index</em> : integer } ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>col2</td><td>collection</td><td align="center">-&gt;</td><td>collection to combine</td></tr><tr><td>index</td><td>integer</td><td align="center">-&gt;</td><td>Position to which insert elements to combine in collection (default = length+1)</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Original collection containing combined element(s)</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-3">Description<a href="#description-3" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.combine()</code> function inserts <em>col2</em> elements at the end or at the specified <em>index</em> position in the collection instance and returns the edited collection. Unlike the <code>.insert()</code> function, <code>.combine()</code> adds each value of <em>col2</em> in the original collection, and not as a single collection element.</p><blockquote><p>This function modifies the original collection.</p></blockquote><p>By default, <em>col2</em> elements are added at the end of the orginal collection. You can pass in <em>index</em> the position where you want the <em>col2</em> elements to be inserted in the collection.</p><blockquote><p><strong>Warning</strong>: Keep in mind that collection elements are numbered from 0.</p></blockquote><ul><li>If <em>index</em> &gt; the length of the collection, the actual starting <em>index</em> will be set to the length of the collection.</li><li>If <em>index</em> &lt; 0, it is recalculated as <em>index = index+length</em> (it is considered as the offset from the end of the collection).</li><li>If the calculated value is negative, <em>index</em> is set to 0.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-4">Example<a href="#example-4" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c, fruits : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection(1,2,3,4,5,6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fruits = newCollection(&quot;Orange&quot;,&quot;Banana&quot;,&quot;Apple&quot;,&quot;Grape&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.combine(fruits,3) //[1,2,3,&quot;Orange&quot;,&quot;Banana&quot;,&quot;Apple&quot;,&quot;Grape&quot;,4,5,6]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="concat">.concat()<a href="#concat" class="hash-link" aria-label="Direct link to .concat()" title="Direct link to .concat()">​</a></h2><p><strong>.concat</strong>( <em>value</em> : any { <em>,...valueN</em> } ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>integer, number, string, object, collection, date, time, boolean, picture</td><td align="center">-&gt;</td><td>Value(s) to concatenate. If <em>value</em> is a collection, all collection elements are added to the original collection</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>New collection with value(s) added to the original collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-4">Description<a href="#description-4" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.concat()</code> function returns a new collection containing the elements of the original collection with all elements of the <em>value</em> parameter added to the end.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>If <em>value</em> is a collection, all its elements are added as new elements at the end of the original collection. If <em>value</em> is not a collection, it is added itself as a new element.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-5">Example<a href="#example-5" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c,c2, fruits : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection(1,2,3,4,5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fruits = newCollection(&quot;Orange&quot;,&quot;Banana&quot;,&quot;Apple&quot;,&quot;Grape&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fruits.push(newObject(&quot;Intruder&quot;,&quot;Tomato&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c2 = c.concat(fruits) //[1,2,3,4,5,&quot;Orange&quot;,&quot;Banana&quot;,&quot;Apple&quot;,&quot;Grape&quot;,{&quot;Intruder&quot;:&quot;Tomato&quot;}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c2 = c.concat(6,7,8) //[1,2,3,4,5,6,7,8]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="copy">.copy()<a href="#copy" class="hash-link" aria-label="Direct link to .copy()" title="Direct link to .copy()">​</a></h2><p><strong>.copy</strong>() : collection<br><strong>.copy</strong>( <em>option</em> : integer ) : collection<br><strong>.copy</strong>( <em>option</em> : integer , <em>groupWithCol</em> : collection ) : collection<br><strong>.copy</strong>( <em>option</em> : integer , <em>groupWithObj</em> : object ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>option</td><td>integer</td><td align="center">-&gt;</td><td><code>kShared</code>: return a shared collection</td></tr><tr><td>groupWithCol</td><td>collection</td><td align="center">-&gt;</td><td>Shared collection to be grouped with the resulting collection</td></tr><tr><td>groupWithObj</td><td>object</td><td align="center">-&gt;</td><td>Shared object to be grouped with the resulting collection</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Deep copy of the original collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-5">Description<a href="#description-5" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.copy()</code> function  returns a deep copy of the collection instance.<strong><em>Deep copy</em></strong> means that objects or collections within the original collection are duplicated and do not share any reference with the returned collection.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>If passed, the <em>option</em> parameter can contain the following constant:</p><table><thead><tr><th>option</th><th>Description</th></tr></thead><tbody><tr><td><code>kShared</code></td><td>By default, <code>copy()</code> returns a regular (not shared) collection, even if the command is applied to a shared collection. Pass the <code>kShared</code> constant to create a shared collection. In this case, you can use the <em>groupWith</em> parameter to associate the shared collection with another collection or object (see below).</td></tr></tbody></table><p>The <em>groupWithCol</em> or <em>groupWithObj</em> parameters allow you to designate a collection or an object with which the resulting collection should be associated.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Datastore, dataclass, and entity objects are not copiable. If <code>.copy()</code> is called with them, <code>null</code> values are returned.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-2">Example 1<a href="#example-1-2" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><p>We want to copy the <em>lastnames</em> regular (non shared) collection into the <em>sharedobject</em> shared object. To do this, we must create a shared copy of the collection (<em>sharedLastnames</em>).</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var sharedobject : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var lastnames,sharedLastnames : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var text : string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sharedobject = newSharedObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">text = file(&quot;/SOURCES/lastnames.txt&quot;).getText()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lastnames = jsonParse(text) //lastnames is a regular collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sharedLastnames = lastnames.copy(kShared) //sharedLastnames is a shared collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//Now we can put sharedLastnames into sharedobject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use(sharedobject)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sharedobject.lastnames = sharedLastnames</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-1">Example 2<a href="#example-2-1" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><p>We want to combine <em>sharedColl1</em> and <em>sharedColl2</em>. Since they belong to different shared groups, a direct combination would result in an error. Therefore, we must make a shared copy of <em>sharedColl1</em> and designate <em>sharedColl2</em> as a shared group for the copy.</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var sharedColl1,sharedColl2,copyColl : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sharedColl1 = newSharedcollection(newSharedObject(&quot;lastname&quot;,&quot;Smith&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sharedColl2 = newSharedcollection(newSharedObject(&quot;lastname&quot;,&quot;Brown&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//copyColl belongs to the same shared group as sharedColl2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> copyColl = sharedColl1.copy(kShared,sharedColl2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> use(sharedColl2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sharedColl2.combine(copyColl)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-3-1">Example 3<a href="#example-3-1" class="hash-link" aria-label="Direct link to Example 3" title="Direct link to Example 3">​</a></h4><p>We have a regular collection (<em>lastnames</em>) and we want to put it in the <strong>Storage</strong> of the application. To do this, we must create a shared copy beforehand (<em>sharedLastnames</em>).</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var lastnames,sharedLastnames : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var text : string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">text = file(&quot;/SOURCES/lastnames.txt&quot;).getText()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lastnames = jsonParse(text) //lastnames is a regular collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sharedLastnames = lastnames.copy(kShared) // shared copy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">use(storage)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    storage.lastnames = sharedLastnames</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="count">.count()<a href="#count" class="hash-link" aria-label="Direct link to .count()" title="Direct link to .count()">​</a></h2><p><strong>.count</strong>( { <em>propertyPath</em> : string } ) : number</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>string</td><td align="center">-&gt;</td><td>object property path to be used for calculation</td></tr><tr><td>Result</td><td>number</td><td align="center">&lt;-</td><td>Number of elements in the collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-6">Description<a href="#description-6" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.count()</code> function returns the number of non-null elements in the collection.</p><p>If the collection contains objects, you can pass the <em>propertyPath</em> parameter. In this case, only elements that contain the <em>propertyPath</em> are taken into account.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-6">Example<a href="#example-6" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var count1,count2 : number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(20,30,null,40)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Smith&quot;,&quot;salary&quot;,10000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Wesson&quot;,&quot;salary&quot;,50000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Gross&quot;,&quot;salary&quot;,10500))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;lastName&quot;,&quot;Henry&quot;,&quot;salary&quot;,12000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> count1 = col.count() //count1: 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> count2 = col.count(&quot;name&quot;) //count2: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="countvalues">.countValues()<a href="#countvalues" class="hash-link" aria-label="Direct link to .countValues()" title="Direct link to .countValues()">​</a></h2><p><strong>.countValues</strong>( <em>value</em> : any {, <em>propertyPath</em> : string } ) : number</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>string, Number, boolean, date, object, collection</td><td align="center">-&gt;</td><td>Value to count</td></tr><tr><td>propertyPath</td><td>string</td><td align="center">-&gt;</td><td>Object property path to be used for calculation</td></tr><tr><td>Result</td><td>number</td><td align="center">&lt;-</td><td>Number of occurrences of the value</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-7">Description<a href="#description-7" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.countValues()</code> function returns the number of times <em>value</em> is found in the collection.</p><p>You can pass in <em>value</em>:</p><ul><li>a scalar value (text, number, boolean, date),</li><li>an object or a collection reference.</li></ul><p>For an element to be found, the type of <em>value</em> must be equivalent to the type of the element, the method uses the equality operator.</p><p>The optional <em>propertyPath</em> parameter allows you to count values inside a collection of objects: pass in <em>propertyPath</em> the path of the property whose values you want to count.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-3">Example 1<a href="#example-1-3" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var vCount : integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(1,2,5,5,5,3,6,4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> vCount = col.countValues(5) // vCount: 3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-2">Example 2<a href="#example-2-2" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var vCount : integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Smith&quot;,&quot;age&quot;,5))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Wesson&quot;,&quot;age&quot;,2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Jones&quot;,&quot;age&quot;,3))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Henry&quot;,&quot;age&quot;,4))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Gross&quot;,&quot;age&quot;,5))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> vCount = col.countValues(5,&quot;age&quot;) //vCount = 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-3-2">Example 3<a href="#example-3-2" class="hash-link" aria-label="Direct link to Example 3" title="Direct link to Example 3">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var numbers, letters : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var vCount : integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> letters = newCollection(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> numbers = newCollection(1,2,letters,3,4,5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> vCount = numbers.countValues(letters) //vCount: 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="distinct">.distinct()<a href="#distinct" class="hash-link" aria-label="Direct link to .distinct()" title="Direct link to .distinct()">​</a></h2><p><strong>.distinct</strong>( {<em>options</em> : integer} ) : collection<br><strong>.distinct</strong>( <em>propertyPath</em> : string {, <em>options</em> : integer } ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>string</td><td align="center">-&gt;</td><td>Path of attribute whose distinct values you want to get</td></tr><tr><td>options</td><td>integer</td><td align="center">-&gt;</td><td><code>kDiacritical</code>, <code>kCountValues</code></td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>New collection with only distinct values</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-8">Description<a href="#description-8" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.distinct()</code> function returns a collection containing only distinct (different) values from the original collection.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>The returned collection is automatically sorted. <strong>null</strong> values are not returned.</p><p>If the collection contains objects, you can pass the <em>propertyPath</em> parameter to indicate the object property whose distinct values you want to get.</p><p>In the <em>options</em> parameter, you can pass one or a combination of the following constants:</p><table><thead><tr><th>Constant</th><th>Value</th><th>Comment</th></tr></thead><tbody><tr><td><code>kDiacritical</code></td><td>8</td><td>Evaluation is case sensitive and differentiates accented characters. By default if omitted, a non-diacritical evaluation is performed</td></tr><tr><td><code>kCountValues</code></td><td>32</td><td>Return the count of elements for every distinct value. When this option is passed, <code>.distinct()</code> returns a collection of objects containing a pair of <code>{&quot;value&quot;:value,&quot;count&quot;:count}</code> attributes.</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c, c2, c3 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;A&quot;,&quot;B&quot;,&quot;c&quot;,&quot;b&quot;,&quot;b&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;size&quot;,1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;size&quot;,3))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;size&quot;,1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.distinct() //c2 = [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,{&quot;size&quot;:1},{&quot;size&quot;:3},{&quot;size&quot;:1}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.distinct(kDiacritical) //c2: [&quot;a&quot;,&quot;A&quot;,&quot;b&quot;,&quot;B&quot;,&quot;c&quot;,{&quot;size&quot;:1},{&quot;size&quot;:3},{&quot;size&quot;:1}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.distinct(&quot;size&quot;) //c2: [1,3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c3 = c.distinct(&quot;size&quot;,kCountValues) //c3: [{value:1,count:2},{value:3,count:1}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="equal">.equal()<a href="#equal" class="hash-link" aria-label="Direct link to .equal()" title="Direct link to .equal()">​</a></h2><p><strong>.equal</strong>( <em>collection2</em> : collection {, <em>option</em> : integer } ) : boolean</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>collection2</td><td>collection</td><td align="center">-&gt;</td><td>collection to compare</td></tr><tr><td>option</td><td>integer</td><td align="center">-&gt;</td><td><code>kDiacritical</code>: diacritical evaluation (&quot;A&quot; # &quot;a&quot; for example)</td></tr><tr><td>Result</td><td>boolean</td><td align="center">&lt;-</td><td>true if collections are identical, false otherwise</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-9">Description<a href="#description-9" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.equal()</code> function compares the collection with collection2 and returns <strong>true</strong> if they are identical (deep comparison).</p><p>By default, a non-diacritical evaluation is performed. If you want the evaluation to be case sensitive or to differentiate accented characters, pass the <code>kDiacritical</code> constant in the option parameter.</p><blockquote><p>Elements with <strong>null</strong> values are not equal to Undefined elements.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-7">Example<a href="#example-7" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c, c2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var b : boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(newObject(&quot;a&quot;,1,&quot;b&quot;,&quot;orange&quot;),2,3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = newCollection(newObject(&quot;a&quot;,1,&quot;b&quot;,&quot;orange&quot;),2,3,4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> b = c.equal(c2) // false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(newObject(&quot;1&quot;,&quot;a&quot;,&quot;b&quot;,&quot;orange&quot;),2,3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = newCollection(newObject(&quot;a&quot;,1,&quot;b&quot;,&quot;orange&quot;),2,3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> b = c.equal(c2) // false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(newObject(&quot;a&quot;,1,&quot;b&quot;,&quot;orange&quot;),2,3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = newCollection(newObject(&quot;a&quot;,1,&quot;b&quot;,&quot;ORange&quot;),2,3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> b = c.equal(c2) // true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(newObject(&quot;a&quot;,1,&quot;b&quot;,&quot;orange&quot;),2,3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = newCollection(newObject(&quot;a&quot;,1,&quot;b&quot;,&quot;ORange&quot;),2,3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> b = c.equal(c2,kDiacritical) //false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="every">.every()<a href="#every" class="hash-link" aria-label="Direct link to .every()" title="Direct link to .every()">​</a></h2><p><strong>.every</strong>( { <em>startFrom</em> : integer , } <em>formula</em> : 4D.Function { ,<em>...param</em> : any } ) : boolean<br><strong>.every</strong>( { <em>startFrom</em> : integer , } <em>methodName</em> : string { ,<em>...param</em> : any } ) : boolean</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startFrom</td><td>integer</td><td align="center">-&gt;</td><td>Index to start the test at</td></tr><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>formula object</td></tr><tr><td>methodName</td><td>string</td><td align="center">-&gt;</td><td>Name of a method</td></tr><tr><td>param</td><td>any</td><td align="center">-&gt;</td><td>Parameter(s) to pass to <em>formula</em> or <em>methodName</em></td></tr><tr><td>Result</td><td>boolean</td><td align="center">&lt;-</td><td>true if all elements successfully passed the test</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-10">Description<a href="#description-10" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.every()</code> function returns <strong>true</strong> if all elements in the collection successfully passed a test implemented in the provided <em>formula</em> object or <em>methodName</em> name.</p><p>You designate the callback to be executed to evaluate collection elements using either:</p><ul><li><em>formula</em> (recommended syntax), a <a href="/docs/language/FunctionClass">formula object</a> that can encapsulate any executable expressions, including functions and project methods,</li><li>or <em>methodName</em>, the name of a project method (string).</li></ul><p>The callback is called with the parameter(s) passed in <em>param</em> (optional). The callback can perform any test, with or without the parameter(s) and must return <strong>true</strong> for every element fulfilling the test. It receives an <code>object</code> in first parameter named <code>$1</code>.</p><p>The callback receives the following parameters:</p><ul><li>in <em>$1.value</em>: element value to be evaluated</li><li>in <em>$2</em>: param</li><li>in <em>$N...</em>: paramN...</li></ul><p>It can set the following parameter(s):</p><ul><li>(mandatory if you used a method) <em>$1.result</em> (boolean): <strong>true</strong> if the element value evaluation is successful, <strong>false</strong> otherwise.</li><li><em>$1.stop</em> (boolean, optional): <strong>true</strong> to stop the method callback. The returned value is the last calculated.</li></ul><p>In all cases, at the point when the <code>.every()</code> function encounters the first collection element evaluated to <strong>false</strong>, it stops calling the callback and returns <strong>false</strong>.</p><p>By default, <code>.every()</code> tests the whole collection. Optionally, you can pass in <em>startFrom</em> the index of the element from which to start the test.</p><ul><li>If <em>startFrom</em> &gt;=  the collection&#x27;s length, <strong>false</strong> is returned, which means the collection is not tested.</li><li>If <em>startFrom</em> &lt; 0, it is considered as the offset from the end of the collection ( <em>startFrom = startFrom+length</em>).</li><li>If <em>startFrom</em>  ==  0, the whole collection is searched (default).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-4">Example 1<a href="#example-1-4" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c : collection  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var b : boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var f : 4D.Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f = formula($1.value&gt;0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(5,3,1,4,6,2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b = c.every(f) //returns true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(-1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b = c.every(f) //returns false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-3">Example 2<a href="#example-2-3" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><p>This example tests that all elements of a collection are of the number type:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var b : boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var f : 4D.Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f = formula(valueType($1.value) == $2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(5,3,1,4,6,2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b = c.every(f,Is number) //b = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = c.push(newObject(&quot;name&quot;,&quot;Cleveland&quot;,&quot;zc&quot;,35049))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = c.push(newObject(&quot;name&quot;,&quot;Blountsville&quot;,&quot;zc&quot;,35031))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b = c.every(f,Is number) //b = false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="extract">.extract()<a href="#extract" class="hash-link" aria-label="Direct link to .extract()" title="Direct link to .extract()">​</a></h2><p><strong>.extract</strong>( <em>propertyPath</em> : string { , <em>option</em> : integer } ) : collection<br><strong>.extract</strong>( <em>propertyPath</em> : string ,  <em>targetPath</em> : string  { ,...<em>propertyPathN</em> : string ,... <em>targetPathN</em> : string } ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>string</td><td align="center">-&gt;</td><td>Object property path whose values must be extracted to the new collection</td></tr><tr><td>targetpath</td><td>string</td><td align="center">-&gt;</td><td>Target property path or property name</td></tr></tbody></table><p>|option|integer|-&gt;|<code>kKeepNull</code>: include null properties in the returned collection (ignored by default). Parameter ignored if <em>targetPath</em> passed.|
|Result|collection|&lt;-|new collection containing extracted values|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-11">Description<a href="#description-11" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.extract()</code> function creates and returns a new collection containing <em>propertyPath</em> values extracted from the original collection of objects.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>The contents of the returned collection depends on the <em>targetPath</em> parameter:</p><ul><li><p>If the <em>targetPath</em> parameter is omitted, <code>.extract()</code> populates the new collection with the <em>propertyPath</em> values of the original collection.</p><p>By default, elements for which <em>propertyPath</em> is null or undefined are ignored in the resulting collection. You can pass the <code>kKeepNull</code> constant in the <em>option</em> parameter to include these values as null elements in the returned collection.</p></li></ul><ul><li>If one or more <em>targetPath</em> parameter(s) are passed, <code>.extract()</code> populates the new collection with the <em>propertyPath</em> properties and each element of the new collection is an object with <em>targetPath</em> properties filled with the corresponding <em>propertyPath</em> properties. null values are kept (<em>option</em> parameter is ignored with this syntax).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-5">Example 1<a href="#example-1-5" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Cleveland&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;zip&quot;,5321))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Blountsville&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(42)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c2 = c.extract(&quot;name&quot;) // c2: [Cleveland,Blountsville]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c2 = c.extract(&quot;name&quot;,kKeepNull) //c2: [Cleveland,null,Blountsville,null]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-4">Example 2<a href="#example-2-4" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;zc&quot;,35060))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,null,&quot;zc&quot;,35049))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Cleveland&quot;,&quot;zc&quot;,35049))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Blountsville&quot;,&quot;zc&quot;,35031))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Adger&quot;,&quot;zc&quot;,35006))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Clanton&quot;,&quot;zc&quot;,35046))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Clanton&quot;,&quot;zc&quot;,35045))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c2 = c.extract(&quot;name&quot;,&quot;City&quot;) //c2: [{City:null},{City:Cleveland},{City:Blountsville},{City:Adger},{City:Clanton},{City:Clanton}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c2 = c.extract(&quot;name&quot;,&quot;City&quot;,&quot;zc&quot;,&quot;Zip&quot;) //c2: [{Zip:35060},{City:null,Zip:35049},{City:Cleveland,Zip:35049},{City:Blountsville,Zip:35031},{City:Adger,Zip:35006},{City:Clanton,Zip:35046},{City:Clanton,Zip:35045}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fill">.fill()<a href="#fill" class="hash-link" aria-label="Direct link to .fill()" title="Direct link to .fill()">​</a></h2><p><strong>.fill</strong>( <em>value</em> : any ) : collection<br><strong>.fill</strong>( <em>value</em> : any ,  <em>startFrom</em>  : integer { , <em>end</em> : integer } ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>number, string, collection, object, date, boolean</td><td align="center">-&gt;</td><td>Filling value</td></tr><tr><td>startFrom</td><td>integer</td><td align="center">-&gt;</td><td>Start index (included)</td></tr><tr><td>end</td><td>integer</td><td align="center">-&gt;</td><td>End index (not included)</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Original collection with filled values</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-12">Description<a href="#description-12" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.fill()</code> function fills the collection with the specified <em>value</em>, optionally from <em>startFrom</em> index to <em>end</em> index, and returns the resulting collection.</p><blockquote><p>This function modifies the original collection.</p></blockquote><ul><li>If the <em>startFrom</em> parameter is omitted, <em>value</em> is set to all collection elements (<em>startFrom</em> = 0).</li><li>If the <em>startFrom</em> parameter is passed and <em>end</em> omitted, <em>value</em> is set to collection elements starting at <em>startFrom</em> to the last element of the collection (<em>end</em> == length).</li><li>If both the <em>startFrom</em> parameter and <em>end</em> are passed, <em>value</em> is set to collection elements starting at <em>startFrom</em> to the element <em>end</em>.</li></ul><p>In case of inconsistency, the following rules apply:</p><ul><li>If <em>startFrom</em> &lt; 0, it is recalculated as <em>startFrom = startFrom+length</em> (it is considered as the offset from the end of the collection). If the calculated value is negative, <em>startFrom</em> is set to 0.</li><li>If <em>end</em> &lt; 0 , it is recalculated as <em>end = end+length</em>.</li><li>If <em>end</em> &lt; <em>startFrom</em> (passed or calculated values), the method does nothing.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-8">Example<a href="#example-8" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(1,2,3,&quot;Lemon&quot;,null,&quot;&quot;,4,5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.fill(&quot;2&quot;) // c:[2,2,2,2,2,2,2,2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.fill(&quot;Hello&quot;,5) // c:[2,2,2,2,2,Hello,Hello,Hello]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.fill(0,1,5) // c:[2,0,0,0,0,Hello,Hello,Hello]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.fill(&quot;world&quot;,1,-5) //-5+8 = 3 -&gt; c:[2,&quot;world&quot;,&quot;world&quot;,0,0,Hello,Hello,Hello]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="filter">.filter()<a href="#filter" class="hash-link" aria-label="Direct link to .filter()" title="Direct link to .filter()">​</a></h2><p><strong>.filter</strong>( <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : collection<br><strong>.filter</strong>( <em>methodName</em> : string { , <em>...param</em> : any } ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>formula object</td></tr><tr><td>methodName</td><td>string</td><td align="center">-&gt;</td><td>Name of a method</td></tr><tr><td>param</td><td>any</td><td align="center">-&gt;</td><td>Parameter(s) to pass to <em>formula</em> or <em>methodName</em></td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>new collection containing filtered elements (shallow copy)</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-13">Description<a href="#description-13" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.filter()</code> function returns a new collection containing all elements of the original collection for which the <em>formula</em> or <em>methodName</em> result is <strong>true</strong>. This function returns a <strong><em>shallow copy</em></strong>, which means that objects or collections in both collections share the same reference. If the original collection is a shared collection, the returned collection is also a shared collection.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>You designate the callback to be executed to filter collection elements using either:</p><ul><li><em>formula</em> (recommended syntax), a <a href="/docs/language/FunctionClass">formula object</a> that can encapsulate any executable expressions, including functions and project methods,</li><li>or <em>methodName</em>, the name of a project method (string).</li></ul><p>The callback is called with the parameter(s) passed in <em>param</em> (optional) and an object in first parameter (<em>$1</em>). The callback can perform any test, with or without the parameter(s) and must return <strong>true</strong> for each element fulfilling the condition and thus, to push to the new collection.  </p><p>The callback receives the following parameters:</p><ul><li>in <em>$1.value</em>: element value to be evaluated</li><li>in <em>$2</em>: param</li><li>in <em>$N...</em>: paramN...</li></ul><p>It can set the following parameter(s):</p><ul><li><em>$1.result</em> (boolean): <strong>true</strong> if the element value matches the filter condition and must be kept, <strong>false</strong> otherwise.</li><li><em>$1.stop</em> (boolean, optional): <strong>true</strong> to stop the method callback. The returned value is the last calculated.</li></ul><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>When using <em>methodName</em> as callback, and if the method does not return any value, <code>.filter()</code> will look at the property <em>$1.result</em> that you must set to <strong>true</strong> for each element fulfilling the condition.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-6">Example 1<a href="#example-1-6" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><p>You want to get the collection of text elements whose length is smaller than 6:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var col,colNew : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(&quot;hello&quot;,&quot;world&quot;,&quot;red horse&quot;,66,&quot;tim&quot;,&quot;san jose&quot;,&quot;miami&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">colNew = col.filter(formula((valueType($1.value) == Is text) &amp;&amp; (length($1.value)&lt;$2)), 6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //colNew:[&quot;hello&quot;,&quot;world&quot;,&quot;tim&quot;,&quot;miami&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-5">Example 2<a href="#example-2-5" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><p>You want to filter elements according to their value type:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c,c2,c3 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var f : 4D.Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> f = formula(valueType($1.value) == $2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(5,3,1,4,6,2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Cleveland&quot;,&quot;zc&quot;,35049))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Blountsville&quot;,&quot;zc&quot;,35031))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.filter(f,Is number) // c2 = [5,3,1,4,6,2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c3 = c.filter(f,Is object)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // c3 = [{name:Cleveland,zc:35049},{name:Blountsville,zc:35031}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="find">.find()<a href="#find" class="hash-link" aria-label="Direct link to .find()" title="Direct link to .find()">​</a></h2><p><strong>.find</strong>( { <em>startFrom</em> : integer , }  <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : any<br><strong>.find</strong>( { <em>startFrom</em> : integer , }  <em>methodName</em> : string { , <em>...param</em> : any } ) : any</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startFrom</td><td>integer</td><td align="center">-&gt;</td><td>Index to start the search at</td></tr><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>formula object</td></tr><tr><td>methodName</td><td>string</td><td align="center">-&gt;</td><td>Name of a method</td></tr><tr><td>param</td><td>any</td><td align="center">-&gt;</td><td>Parameter(s) to pass to <em>formula</em> or <em>methodName</em></td></tr><tr><td>Result</td><td>any</td><td align="center">&lt;-</td><td>First value found, or Undefined if not found</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-14">Description<a href="#description-14" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.find()</code> function returns the first value in the collection for which <em>formula</em> or <em>methodName</em> result, applied on each element, returns <strong>true</strong>.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>You designate the callback to be executed to evaluate collection elements using either:</p><ul><li><em>formula</em> (recommended syntax), a <a href="/docs/language/FunctionClass">formula object</a> that can encapsulate any executable expressions, including functions and project methods,</li><li>or <em>methodName</em>, the name of a project method (string).</li></ul><p>The callback is called with the parameter(s) passed in <em>param</em> (optional). The callback can perform any test, with or without the parameter(s) and must return <strong>true</strong> for the first element fulfilling the condition. It receives an <code>object</code> in first parameter ($1).</p><p>The callback receives the following parameters:</p><ul><li>in <em>$1.value</em>: element value to be evaluated</li><li>in <em>$2</em>: param</li><li>in <em>$N...</em>: paramN...</li></ul><p>It can set the following parameter(s):</p><ul><li>(mandatory if you used a method) <em>$1.result</em> (boolean): <strong>true</strong> if the element value matches the search condition, <strong>false</strong> otherwise.</li><li><em>$1.stop</em> (boolean, optional): <strong>true</strong> to stop the method callback. The returned value is the last calculated.</li></ul><p>By default, <code>.find()</code> searches in the whole collection. Optionally, you can pass in <em>startFrom</em> the index of element from which to start the search.</p><ul><li>If <em>startFrom</em> &gt;=  the collection&#x27;s length, -1 is returned, which means the collection is not searched.</li><li>If <em>startFrom</em> &lt; 0, it is considered as the offset from the end of the collection (<em>startFrom = startFrom+length</em>).
<strong>Note</strong>: Even if <em>startFrom</em> is negative, the collection is still searched from left to right.</li><li>If <em>startFrom</em>  ==  0, the whole collection is searched (default).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-7">Example 1<a href="#example-1-7" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><p>You want to get the first text element with a length smaller than 5:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(&quot;hello&quot;,&quot;world&quot;,4,&quot;red horse&quot;,&quot;tim&quot;,&quot;san jose&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">value = col.find(formula((valueType($1.value) == Is text) &amp;&amp; (length($1.value)&lt;$2)), 5) //value: &quot;tim&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-6">Example 2<a href="#example-2-6" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><p>You want to find a city name within a collection:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var c2 : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;, &quot;Cleveland&quot;, &quot;zc&quot;, 35049))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;, &quot;Blountsville&quot;, &quot;zc&quot;, 35031))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;, &quot;Adger&quot;, &quot;zc&quot;, 35006))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;, &quot;Clanton&quot;, &quot;zc&quot;, 35046))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;, &quot;Clanton&quot;, &quot;zc&quot;, 35045))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c2 = c.find(formula($1.value.name == $2), &quot;Clanton&quot;)  //c2 = {name:Clanton,zc:35046}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="findindex">.findIndex()<a href="#findindex" class="hash-link" aria-label="Direct link to .findIndex()" title="Direct link to .findIndex()">​</a></h2><p><strong>.findIndex</strong>( { <em>startFrom</em> : integer , }  <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : integer<br><strong>.findIndex</strong>( { <em>startFrom</em> : integer , }  <em>methodName</em> : string { , <em>...param</em> : any } ) : integer</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startFrom</td><td>integer</td><td align="center">-&gt;</td><td>Index to start the search at</td></tr><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>formula object</td></tr><tr><td>methodName</td><td>string</td><td align="center">-&gt;</td><td>Name of a method</td></tr><tr><td>param</td><td>any</td><td align="center">-&gt;</td><td>Parameter(s) to pass to <em>formula</em> or <em>methodName</em></td></tr><tr><td>Result</td><td>integer</td><td align="center">&lt;-</td><td>Index of first value found, or -1 if not found</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-15">Description<a href="#description-15" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.findIndex()</code> function returns the index, in the collection, of the first value for which <em>formula</em> or <em>methodName</em>, applied on each element, returns <strong>true</strong>.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>You designate the callback to be executed to evaluate collection elements using either:</p><ul><li><em>formula</em> (recommended syntax), a <a href="/docs/language/FunctionClass">formula object</a> that can encapsulate any executable expressions, including functions and project methods,</li><li><em>methodName</em>, the name of a project method (string).</li></ul><p>The callback is called with the parameter(s) passed in <em>param</em> (optional). The callback can perform any test, with or without the parameter(s) and must return <strong>true</strong> for the first element fulfilling the condition. It receives an <code>object</code> in the first parameter named <em>$1</em>.</p><p>The callback receives the following parameters:</p><ul><li>in <em>$1.value</em>: element value to be evaluated</li><li>in <em>$2</em>: param</li><li>in <em>$N...</em>: paramN...</li></ul><p>It can set the following parameter(s):</p><ul><li>(mandatory if you used a method) <em>$1.result</em> (boolean): <strong>true</strong> if the element value matches the search condition, <strong>false</strong> otherwise.</li><li><em>$1.stop</em> (boolean, optional): <strong>true</strong> to stop the method callback. The returned value is the last calculated.</li></ul><p>By default, <code>.findIndex()</code> searches in the whole collection. Optionally, you can pass in <em>startFrom</em> the index of element from which to start the search.</p><ul><li>If <em>startFrom</em> &gt;=  the collection&#x27;s length, -1 is returned, which means the collection is not searched.</li><li>If <em>startFrom</em> &lt; 0, it is considered as the offset from the end of the collection (<em>startFrom = startFrom+length</em>).
<strong>Note</strong>: Even if <em>startFrom</em> is negative, the collection is still searched from left to right.</li><li>If <em>startFrom</em>  ==  0, the whole collection is searched (default).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-9">Example<a href="#example-9" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><p>You want to find the position of the first city name within a collection:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var val2,val3 : integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Cleveland&quot;,&quot;zc&quot;,35049))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Blountsville&quot;,&quot;zc&quot;,35031))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Adger&quot;,&quot;zc&quot;,35006))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Clanton&quot;,&quot;zc&quot;,35046))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c.push(newObject(&quot;name&quot;,&quot;Clanton&quot;,&quot;zc&quot;,35045))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val2 = c.findIndex(formula($1.value.name == $2),&quot;Clanton&quot;) // val2: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">val3 = c.findIndex(val2+1,formula($1.value.name == $2),&quot;Clanton&quot;) //val3:4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="first">.first()<a href="#first" class="hash-link" aria-label="Direct link to .first()" title="Direct link to .first()">​</a></h2><p><strong>.first</strong>() : any </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Result</td><td>any</td><td align="center">&lt;-</td><td>First element of collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-16">Description<a href="#description-16" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.first()</code> function returns the first element of the collection.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>The function returns Undefined if the collection is empty.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-10">Example<a href="#example-10" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var col, emptyCol : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var first : variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(10, 20, 30, &quot;hello&quot;, 50)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">first = col.first() // 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emptyCol = newCollection() //empty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// first = emptyCol[0] //would return error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">first = emptyCol.first() // returns undefined</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="flat">.flat()<a href="#flat" class="hash-link" aria-label="Direct link to .flat()" title="Direct link to .flat()">​</a></h2><p><strong>.flat</strong>( { <em>depth</em> : integer } ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>depth</td><td>integer</td><td align="center">-&gt;</td><td>How deep a nested collection structure should be flattened. Default = 1</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Flattened collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-17">Description<a href="#description-17" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.flat()</code> function creates a new collection with all sub-collection elements concatenated into it recursively up to the specified <em>depth</em>.</p><p>By default, if the <em>depth</em> parameter is omitted, only the first level of the nested collection structure will be flattened.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-11">Example<a href="#example-11" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(1, 2, newCollection(3, 4))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col.flat()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// [1, 2, 3, 4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(1, 2, newCollection(3, 4, newCollection(5, 6)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col.flat()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// [1, 2, 3, 4, [5, 6]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(1, 2, newCollection(3, 4, newCollection(5, 6)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col.flat(2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// [1, 2, 3, 4, 5, 6]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(1, 2, newCollection(3, 4, 5, 6, newCollection(7, 8, newCollection(9, 10))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col.flat(MAXLONG)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="flatmap">.flatMap()<a href="#flatmap" class="hash-link" aria-label="Direct link to .flatMap()" title="Direct link to .flatMap()">​</a></h2><p><strong>.flatMap</strong>( <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : collection<br><strong>.flatMap</strong>( <em>methodName</em> : string { , <em>...param</em> : any } ) : collection </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>formula object</td></tr><tr><td>methodName</td><td>string</td><td align="center">-&gt;</td><td>Name of a method</td></tr><tr><td>param</td><td>any</td><td align="center">-&gt;</td><td>Parameter(s) to pass to <em>formula</em> or <em>methodName</em></td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Collection of transformed values and flattened by a depth of 1</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-18">Description<a href="#description-18" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.flatMap()</code> function creates a new collection based upon the result of the call of the <em>formula</em> 4D function or <em>methodName</em> method on each element of the original collection and flattened by a depth of 1. Optionally, you can pass parameters to <em>formula</em> or <em>methodName</em> using the <em>param</em> parameter(s).</p><p>This function is identical to a <a href="#map"><code>map()</code></a> call followed by a <a href="#flat"><code>flat()</code></a> call of depth 1.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>You designate the callback to be executed to evaluate collection elements using either:</p><ul><li><em>formula</em> (recommended syntax), a <a href="/docs/language/FunctionClass">formula object</a> that can encapsulate any executable expressions, including functions and project methods,</li><li>or <em>methodName</em>, the name of a project method (string).</li></ul><p>The callback is called with the parameter(s) passed in <em>param</em> (optional). The callback can perform any operation, with or without the parameter(s) and must return new transformed value to add to the resulting collection. It receives an <code>object</code> in first parameter named <em>$1</em>.</p><p>The callback receives the following parameters:</p><ul><li>in <em>$1.value</em>: element value to be evaluated</li><li>in <em>$2</em>: param</li><li>in <em>$N...</em>: paramN...</li></ul><p>It can set the following parameter(s):</p><ul><li>(mandatory if you used a method) <em>$1.result</em> (any type): new transformed value to add to the resulting collection</li><li><em>$1.stop</em> (boolean, optional): <strong>true</strong> to stop the method callback. The returned value is the last calculated.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-8">Example 1<a href="#example-1-8" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var col , result : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(1, 2, 3, 4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result = col.map(formula(newCollection($1.value*2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> // [[2],[4],[6],[8]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result = col.flatMap(formula(newCollection($1.value*2))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// [2,4,6,8]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-7">Example 2<a href="#example-2-7" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var col, result : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(&quot;Hello how&quot;, &quot;&quot;, &quot;are you ?&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result = col.map(formula(splitString($1.value, &quot; &quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// [[&quot;Hello&quot;, &quot;how&quot;], [], [&quot;are&quot;, &quot;you&quot;, &quot;?&quot;]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result = col.flatMap(formula(splitString($1.value, &quot; &quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// [&quot;Hello&quot;, &quot;how&quot;, &quot;are&quot;, &quot;you&quot;, &quot;?&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-3-3">Example 3<a href="#example-3-3" class="hash-link" aria-label="Direct link to Example 3" title="Direct link to Example 3">​</a></h4><p>You want to compute the percentage of each value in the collection to the total:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c, c2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var f : 4D.Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection(1, 4, 9, 10, 20)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f = formula(newCollection($1.value,round(($1.value/$2)*100, 2)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c2 = c.flatMap(f, c.sum())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //c2: [1, 2.27, 4, 9.09,9, 20.45,10, 22.73, 20, 45.45]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="includes">.includes()<a href="#includes" class="hash-link" aria-label="Direct link to .includes()" title="Direct link to .includes()">​</a></h2><p><strong>.includes</strong>( <em>toSearch</em> : expression { , <em>startFrom</em> : integer } ) : boolean</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>toSearch</td><td>expression</td><td align="center">-&gt;</td><td>Expression to search in the collection</td></tr><tr><td>startFrom</td><td>integer</td><td align="center">-&gt;</td><td>Index to start the search at</td></tr><tr><td>Result</td><td>boolean</td><td align="center">&lt;-</td><td>true if <em>toSearch</em> is found in the collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-19">Description<a href="#description-19" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.includes()</code> function returns true if the <em>toSearch</em> expression is found among collection elements, otherwise False.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>In <em>toSearch</em>, pass the expression to find in the collection. You can pass:</p><ul><li>a scalar value (text, number, boolean, date),</li><li>the null value,</li><li>an object or a collection reference.</li></ul><p><em>toSearch</em> must match exactly the element to find (the same rules as for the equality operator of the data type are applied).</p><p>Optionally, you can pass the index of collection from which to start the search in <em>startFrom</em>.</p><ul><li>If <em>startFrom</em> &gt;=  collection&#x27;s length, False is returned, which means the collection is not searched.</li><li>If <em>startFrom</em> &lt; 0, it is considered as the offset from the end of the collection (<em>startFrom = startFrom+length</em>). Note that even if <em>startFrom</em> is negative, the collection is still searched from left to right.</li><li>If <em>startFrom</em>  ==  0, the whole collection is searched (default).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-12">Example<a href="#example-12" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var in : boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var obj : object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> obj = newObject(&quot;value&quot;, 10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(1,2,&quot;Henry&quot;,5,3,&quot;Albert&quot;,6,4,&quot;Alan&quot;,5,obj)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> in = col.includes(3) //true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> in = col.includes(5,6) //true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> in = col.includes(&quot;al@&quot;) //true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> in = col.includes(&quot;Hello&quot;) //false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> in = col.includes(obj)  //true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> in = col.includes(newObject(&quot;value&quot;, 10)) //false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="indexof">.indexOf()<a href="#indexof" class="hash-link" aria-label="Direct link to .indexOf()" title="Direct link to .indexOf()">​</a></h2><p><strong>.indexOf</strong>(  <em>toSearch</em> : expression { , <em>startFrom</em> : integer } ) : integer </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>toSearch</td><td>expression</td><td align="center">-&gt;</td><td>Expression to search in the collection</td></tr><tr><td>startFrom</td><td>integer</td><td align="center">-&gt;</td><td>Index to start the search at</td></tr><tr><td>Result</td><td>integer</td><td align="center">&lt;-</td><td>Index of the first occurrence of toSearch in the collection, -1 if not found</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-20">Description<a href="#description-20" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.indexOf()</code> function searches the <em>toSearch</em> expression among collection elements and returns the index of the first found occurrence, or -1 if it was not found.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>In <em>toSearch</em>, pass the expression to find in the collection. You can pass:</p><ul><li>a scalar value (string, number, boolean, date),</li><li>the null value,</li><li>an object or a collection reference.</li></ul><p><em>toSearch</em> must match exactly the element to find (the same rules as for the equality operator of the data type are applied).</p><p>Optionally, you can pass the index of collection from which to start the search in <em>startFrom</em>.</p><ul><li>If <em>startFrom</em> &gt;=  the collection&#x27;s length, -1 is returned, which means the collection is not searched.</li><li>If <em>startFrom</em> &lt; 0, it is considered as the offset from the end of the collection (<em>startFrom = startFrom+length</em>).
<strong>Note</strong>: Even if <em>startFrom</em> is negative, the collection is still searched from left to right.</li><li>If <em>startFrom</em>  ==  0, the whole collection is searched (default).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-13">Example<a href="#example-13" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var i : integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(1,2,&quot;Henry&quot;,5,3,&quot;Albert&quot;,6,4,&quot;Alan&quot;,5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> i = col.indexOf(3) //i = 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> i = col.indexOf(5,5) //i = 9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> i = col.indexOf(&quot;al@&quot;) //i = 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> i = col.indexOf(&quot;Hello&quot;) //i = -1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="indices">.indices()<a href="#indices" class="hash-link" aria-label="Direct link to .indices()" title="Direct link to .indices()">​</a></h2><p><strong>.indices</strong>(  <em>queryString</em> : string { , <em>...value</em> : any } ) : collection </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>queryString</td><td>string</td><td align="center">-&gt;</td><td>Search criteria</td></tr><tr><td>value</td><td>any</td><td align="center">-&gt;</td><td>Value(s) to compare when using placeholder(s)</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Element index(es) matching queryString in the collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-21">Description<a href="#description-21" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.indices()</code> function works exactly the same as the <a href="#query"><code>.query()</code></a> function but returns indexes, in the original collection, of object collection elements that match the <em>queryString</em> search conditions, and not elements themselves. Indexes are returned in ascending order.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>The <em>queryString</em> parameter uses the following syntax:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">propertyPath comparator value {logicalOperator propertyPath comparator value}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For a detailed description of the <em>queryString</em> and <em>value</em> parameters, please refer to the <a href="/docs/language/DataClassClass#query"><code>dataClass.query()</code></a> function.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-14">Example<a href="#example-14" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c, icol : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Cleveland&quot;,&quot;zc&quot;,35049))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Blountsville&quot;,&quot;zc&quot;,35031))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Adger&quot;,&quot;zc&quot;,35006))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Clanton&quot;,&quot;zc&quot;,35046))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Clanton&quot;,&quot;zc&quot;,35045))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> icol = c.indices(&quot;name = :1&quot;,&quot;Cleveland&quot;) // icol: [0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> icol = c.indices(&quot;zc &gt; 35040&quot;) // icol: [0,3,4]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="insert">.insert()<a href="#insert" class="hash-link" aria-label="Direct link to .insert()" title="Direct link to .insert()">​</a></h2><p><strong>.insert</strong>( <em>index</em> : integer , <em>element</em> : any ) : collection </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>index</td><td>integer</td><td align="center">-&gt;</td><td>Where to insert the element</td></tr><tr><td>element</td><td>any</td><td align="center">-&gt;</td><td>Element to insert in the collection</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Original collection containing inserted element</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-22">Description<a href="#description-22" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.insert()</code> function inserts <em>element</em> at the specified <em>index</em> position in the collection instance and returns the edited collection.</p><blockquote><p>This function modifies the original collection.</p></blockquote><p>In <em>index</em>, pass the position where you want the element to be inserted in the collection.</p><blockquote><p><strong>Warning</strong>: Keep in mind that collection elements are numbered from 0.</p></blockquote><ul><li>If <em>index</em> &gt; the length of the collection, actual starting index will be set to the length of the collection.</li><li>If <em>index</em> &lt;0, it is recalculated as <em>index = index+length</em> (it is considered as the offset from the end of the collection).</li><li>If the calculated value is negative, index is set to 0.</li></ul><p>Any type of element accepted by a collection can be inserted, even another collection.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-15">Example<a href="#example-15" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;) //col:[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.insert(2,&quot;X&quot;) //col:[&quot;a&quot;,&quot;b&quot;,&quot;X&quot;,&quot;c&quot;,&quot;d&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.insert(-2,&quot;Y&quot;) //col:[&quot;a&quot;,&quot;b&quot;,&quot;X&quot;,&quot;Y&quot;,&quot;c&quot;,&quot;d&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.insert(-10,&quot;Hi&quot;) //col:[&quot;Hi&quot;,&quot;a&quot;,&quot;b&quot;,&quot;X&quot;,&quot;Y&quot;,&quot;c&quot;,&quot;d&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="join">.join()<a href="#join" class="hash-link" aria-label="Direct link to .join()" title="Direct link to .join()">​</a></h2><p><strong>.join</strong>( <em>delimiter</em> : string { , <em>option</em> : integer } ) : string </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>delimiter</td><td>string</td><td align="center">-&gt;</td><td>Separator to use between elements</td></tr><tr><td>option</td><td>integer</td><td align="center">-&gt;</td><td><code>kIgnoreNullOrEmpty</code>: ignore null and empty strings in the result</td></tr><tr><td>Result</td><td>string</td><td align="center">&lt;-</td><td>String containing all elements of the collection, separated by delimiter</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-23">Description<a href="#description-23" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.join()</code> function converts all elements of the collection to strings and concatenates them using the specified <em>delimiter</em> string as separator.The function returns the resulting string.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>By default, null or empty elements of the collection are returned in the resulting string. Pass the <code>kIgnoreNullOrEmpty</code> constant in the <em>option</em> parameter if you want to remove them from the resulting string.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-16">Example<a href="#example-16" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var t1,t2 : string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(1,2,3,&quot;Paris&quot;,null,&quot;&quot;,4,5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> t1 = c.join(&quot;|&quot;) //1|2|3|Paris|null||4|5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> t2 = c.join(&quot;|&quot;,kIgnoreNullOrEmpty) //1|2|3|Paris|4|5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="last">.last()<a href="#last" class="hash-link" aria-label="Direct link to .last()" title="Direct link to .last()">​</a></h2><p><strong>.last</strong>() : any </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Result</td><td>any</td><td align="center">&lt;-</td><td>Last element of collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-24">Description<a href="#description-24" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.last()</code> function returns the last element of the collection.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>The function returns undefined if the collection is empty.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-17">Example<a href="#example-17" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var col, emptyCol : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var last : variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(10, 20, 30, &quot;hello&quot;, 50)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">last = col.last() // 50</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">emptyCol = newCollection() //empty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// last = emptyCol[emptyCol.length-1] //returns an error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">last = emptyCol.last() // returns Undefined</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lastindexof">.lastIndexOf()<a href="#lastindexof" class="hash-link" aria-label="Direct link to .lastIndexOf()" title="Direct link to .lastIndexOf()">​</a></h2><p><strong>.lastIndexOf</strong>( <em>toSearch</em> : expression { , <em>startFrom</em> : integer } ) : integer </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>toSearch</td><td>expression</td><td align="center">-&gt;</td><td>The element that is to be searched for within the collection</td></tr><tr><td>startFrom</td><td>integer</td><td align="center">-&gt;</td><td>Index to start the search at</td></tr><tr><td>Result</td><td>integer</td><td align="center">&lt;-</td><td>Index of last occurrence of toSearch in the collection, -1 if not found</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-25">Description<a href="#description-25" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.lastIndexOf()</code> function searches the <em>toSearch</em> expression among collection elements and returns the index of the last occurrence, or -1 if it was not found.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>In <em>toSearch</em>, pass the expression to find in the collection. You can pass:</p><ul><li>a scalar value (string, number, boolean, date),</li><li>the null value,</li><li>an object or a collection reference.</li></ul><p><em>toSearch</em> must match exactly the element to find (the same rules as for the equality operator are applied).</p><p>Optionally, you can pass the index of collection from which to start a reverse search in <em>startFrom</em>.</p><ul><li>If <em>startFrom</em> &gt;=  the collection&#x27;s length minus one (coll.length-1), the whole collection is searched (default).</li><li>If <em>startFrom</em> &lt; 0, it is recalculated as <em>startFrom = startFrom+length</em> (it is considered as the offset from the end of the collection). If the calculated value is negative, -1 is returned (the collection is not searched).
<strong>Note:</strong> Even if <em>startFrom</em> is negative, the collection is still searched from right to left.</li><li>If <em>startFrom</em>  ==  0, -1 is returned, which means the collection is not searched.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-18">Example<a href="#example-18" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var pos1,pos2,pos3,pos4,pos5 : integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = splitString(&quot;a,b,c,d,e,f,g,h,i,j,e,k,e&quot;,&quot;,&quot;) //col.length: 13</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pos1 = col.lastIndexOf(&quot;e&quot;) //returns 12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pos2 = col.lastIndexOf(&quot;e&quot;,6) //returns 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pos3 = col.lastIndexOf(&quot;e&quot;,15) //returns 12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pos4 = col.lastIndexOf(&quot;e&quot;,-2) //returns 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pos5 = col.lastIndexOf(&quot;x&quot;) //returns -1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="length">.length<a href="#length" class="hash-link" aria-label="Direct link to .length" title="Direct link to .length">​</a></h2><p><strong>.length</strong> : integer</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-26">Description<a href="#description-26" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.length</code> property returns the number of elements in the collection.</p><p>The <code>.length</code> property is initialized when the collection is created. Adding or removing elements updates the length, if necessary. This property is <strong>read-only</strong> (you cannot use it to set the size of the collection).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-19">Example<a href="#example-19" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection //col.length initialized to 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var vSize : integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(&quot;one&quot;,&quot;two&quot;,&quot;three&quot;) //col.length updated to 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col[4] = &quot;five&quot; //col.length updated to 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> vSize = col.remove(0,3).length //vSize: 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="map">.map()<a href="#map" class="hash-link" aria-label="Direct link to .map()" title="Direct link to .map()">​</a></h2><p><strong>.map</strong>( <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : collection<br><strong>.map</strong>( <em>methodName</em> : string { , <em>...param</em> : any } ) : collection </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>formula object</td></tr><tr><td>methodName</td><td>string</td><td align="center">-&gt;</td><td>Name of a method</td></tr><tr><td>param</td><td>any</td><td align="center">-&gt;</td><td>Parameter(s) to pass to <em>formula</em> or <em>methodName</em></td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>collection of transformed values</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-27">Description<a href="#description-27" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.map()</code> function creates a new collection based upon the result of the call of the <em>formula</em> 4D function or <em>methodName</em> method on each element of the original collection. Optionally, you can pass parameters to <em>formula</em> or <em>methodName</em> using the <em>param</em> parameter(s). <code>.map()</code> always returns a collection with the same size as the original collection, except if <em>$1.stop</em> was used (see below).</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>You designate the callback to be executed to evaluate collection elements using either:</p><ul><li><em>formula</em> (recommended syntax), a <a href="/docs/language/FunctionClass">formula object</a> that can encapsulate any executable expressions, including functions and project methods,</li><li>or <em>methodName</em>, the name of a project method (text).</li></ul><p>The callback is called with the parameter(s) passed in <em>param</em> (optional). The callback can perform any operation, with or without the parameter(s) and must return new transformed value to add to the resulting collection. It receives an <code>object</code> in first parameter, named <em>$1</em>.</p><p>The callback receives the following parameters:</p><ul><li>in <em>$1.value</em>: element value to be evaluated</li><li>in <em>$2</em>: param</li><li>in <em>$N...</em>: paramN...</li></ul><p>It can set the following parameter(s):</p><ul><li>(mandatory if you used a method) <em>$1.result</em> (any type): new transformed value to add to the resulting collection</li><li><em>$1.stop</em> (boolean, optional): <strong>true</strong> to stop the method callback. The returned value is the last calculated.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-20">Example<a href="#example-20" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c, c2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection(1, 4, 9, 10, 20)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c2 = c.map(formula(round(($1.value/$2)*100, 2)), c.sum())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //c2: [2.27,9.09,20.45,22.73,45.45]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="max">.max()<a href="#max" class="hash-link" aria-label="Direct link to .max()" title="Direct link to .max()">​</a></h2><p><strong>.max</strong>( { <em>propertyPath</em> : string } ) : any </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>string</td><td align="center">-&gt;</td><td>object property path to be used for evaluation</td></tr><tr><td>Result</td><td>boolean, string, Number, collection, object, date</td><td align="center">&lt;-</td><td>Maximum value in the collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-28">Description<a href="#description-28" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.max()</code> function returns the element with the highest value in the collection (the last element of the collection as it would be sorted in ascending order using the <a href="#sort"><code>.sort()</code></a> function).</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>If the collection contains different types of values, the <code>.max()</code> function will return the maximum value within the last element type in the type list order (see <a href="#sort"><code>.sort()</code></a> description).</p><p>If the collection contains objects, pass the <em>propertyPath</em> parameter to indicate the object property whose maximum value you want to get.</p><p>If the collection is empty, <code>.max()</code> returns <code>undefined</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-21">Example<a href="#example-21" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var max, maxSal, maxName : variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(200,150,55)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Smith&quot;,&quot;salary&quot;,10000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Wesson&quot;,&quot;salary&quot;,50000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Alabama&quot;,&quot;salary&quot;,10500))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> max = col.max() //{name:Alabama,salary:10500}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> maxSal = col.max(&quot;salary&quot;) //50000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> maxName = col.max(&quot;name&quot;) //&quot;Wesson&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="min">.min()<a href="#min" class="hash-link" aria-label="Direct link to .min()" title="Direct link to .min()">​</a></h2><p><strong>.min</strong>( { <em>propertyPath</em> : string } ) : any </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>string</td><td align="center">-&gt;</td><td>object property path to be used for evaluation</td></tr><tr><td>Result</td><td>boolean, string, Number, collection, object, date</td><td align="center">&lt;-</td><td>Minimum value in the collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-29">Description<a href="#description-29" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.min()</code> function returns the element with the smallest value in the collection (the first element of the collection as it would be sorted in ascending order using the <a href="#sort"><code>.sort()</code></a> function).</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>If the collection contains different types of values, the <code>.min()</code> function will return the minimum value within the first element type in the type list order (see <a href="#sort"><code>.sort()</code></a> description).</p><p>If the collection contains objects, pass the <em>propertyPath</em> parameter to indicate the object property whose minimum value you want to get.</p><p>If the collection is empty, <code>.min()</code> returns <code>undefined</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-22">Example<a href="#example-22" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var min, minSal, minName : variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(200,150,55)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Smith&quot;,&quot;salary&quot;,10000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Wesson&quot;,&quot;salary&quot;,50000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Alabama&quot;,&quot;salary&quot;,10500))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> min = col.min() //55</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> minSal = col.min(&quot;salary&quot;) //10000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> minName = col.min(&quot;name&quot;) //&quot;Alabama&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="multisort">.multiSort()<a href="#multisort" class="hash-link" aria-label="Direct link to .multiSort()" title="Direct link to .multiSort()">​</a></h2><p><strong>.multiSort</strong>() : collection<br><strong>.multiSort</strong>( <em>colsToSort</em> : collection ) : collection<br><strong>.multiSort</strong>( <em>formula</em> : 4D.Function , <em>colsToSort</em> : collection ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>Formula object</td></tr><tr><td>colsToSort</td><td>collection</td><td align="center">-&gt;</td><td>Collection of collections and/or objects with {<code>collection</code>:<em>colToSort</em>,<code>order</code>:<code>ck ascending</code> or <code>ck descending</code>} properties</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Original collection sorted</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-30">Description<a href="#description-30" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.multiSort()</code> function enables you to carry out a multi-level synchronized sort on a set of collections.</p><blockquote><p>This function modifies the original collection as well as all collections used in <em>colsToSort</em> parameter.</p></blockquote><p>If <code>.multiSort()</code> is called with no parameters, the function has the same effect as the <a href="#sort"><code>.sort()</code></a> function: the collection is sorted (only scalar values) in ascending order by default, according to their type. If the collection contains values of different types, they are first grouped by type and sorted afterwards. Types are returned in the following order:</p><ol><li>null</li><li>booleans</li><li>strings</li><li>numbers</li><li>objects</li><li>collections</li><li>dates</li></ol><p><strong>Single-level synchronized sort</strong></p><p>To sort several collections synchronously, just pass in <em>colsToSort</em> a collection of collections to sort. You can pass an unlimited number of collections. The original collection will be sorted in ascending order and all <em>colsToSort</em> collections will be sorted in a synchronized manner. </p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>All <em>colsToSort</em> collections must have the same number of elements, otherwise an error is returned.</p></div></div><p>If you want to sort the collections in some other order than ascending, you must supply a <em>formula</em> (<a href="/docs/language/FunctionClass#formula">Formula object</a> that defines the sort order. The return value should be a boolean that indicates the relative order of the two elements: <strong>true</strong> if <em>$1.value</em> is less than <em>$1.value2</em>, <strong>false</strong> if <em>$1.value</em> is greater than <em>$1.value2</em>. You can provide additional parameters to the formula if necessary.</p><p>The formula receives the following parameters:</p><ul><li>$1 (object), where:<ul><li><em>$1.value</em> (any type): first element value to be compared</li><li><em>$1.value2</em> (any type): second element value to be compared</li></ul></li><li>$2...$N (any type): extra parameters</li></ul><p><strong>Multi-level synchronized sort</strong></p><p>Defining a multi-level synchronized sort requires that you pass an object containing {<code>collection</code>:<em>colToSort</em>,<code>order</code>:<code>ck ascending</code> or <code>ck descending</code>} properties instead of the <em>colToSort</em> itself for every collection to use as sub-level. </p><p>The sort levels are determined by the order in which the collections are passed in the <em>colsToSort</em> parameter: the position of a <code>collection</code>/<code>order</code> object in the syntax determines its sort level.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>The <code>.multiSort()</code> function uses a <a href="https://en.wikipedia.org/wiki/Sorting_algorithm#Stability" target="_blank" rel="noopener noreferrer">stable</a> sort algorithm. </p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-9">Example 1<a href="#example-1-9" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><p>A simple synchronized sort of collections with different value types:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var col,col2,col3 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = [&quot;A&quot;, &quot;C&quot;, &quot;B&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col2 = [1, 2, 3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col3 = [[&quot;Jim&quot;, &quot;Philip&quot;, &quot;Maria&quot;], [&quot;blue&quot;, &quot;green&quot;], [&quot;11&quot;, 22, &quot;33&quot;]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col.multiSort([col2 , col3])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//col : [&quot;A&quot;,&quot;B&quot;,&quot;C&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//col2 : [1,3,2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//col3[0] : [&quot;Jim&quot;,&quot;Philip&quot;,&quot;Maria&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//col3[1] : [&quot;11&quot;,22,&quot;33&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//col3[2] : [&quot;blue&quot;,&quot;green&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-8">Example 2<a href="#example-2-8" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><p>You want to sort three synchronized collections: city, country, and continent. You want an ascending sort of the first and the third collections, and synchronization for the second collection:</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var city, country, continent : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">city = [&quot;Paris&quot;, &quot;Lyon&quot;, &quot;Rabat&quot;, &quot;Eching&quot;, &quot;San Diego&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">country = [&quot;France&quot;, &quot;France&quot;, &quot;Morocco&quot;, &quot;Germany&quot;, &quot;US&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">continent = [&quot;Europe&quot;, &quot;Europe&quot;, &quot;Africa&quot;, &quot;Europe&quot;, &quot;America&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">continent.multiSort(country, {collection : city , order : ck ascending})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//continent : [&quot;Africa&quot;, &quot;America&quot;,&quot;Europe&quot;,&quot;Europe&quot;,&quot;Europe&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//country : [&quot;Morocco&quot;, &quot;US&quot;,&quot;Germany&quot;,&quot;France&quot;,&quot;France&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//city : [&quot;Rabat&quot;,&quot;San Diego&quot;,&quot;Eching&quot;,&quot;Lyon&quot;,&quot;Paris&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-3-4">Example 3<a href="#example-3-4" class="hash-link" aria-label="Direct link to Example 3" title="Direct link to Example 3">​</a></h4><p>You can also synchronize collections of objects.</p><div class="language-4d codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-4d codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var name, address : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name.push({firstname: &quot;John&quot;, lastname: &quot;Smith&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name.push({firstname: &quot;Alain&quot;, lastname: &quot;Martin&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name.push({firstname: &quot;Jane&quot;, lastname: &quot;Doe&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name.push({firstname: &quot;John&quot;, lastname: &quot;Doe&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address.push({city: &quot;Paris&quot;, country: &quot;France&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address.push({city: &quot;Lyon&quot;, country: &quot;France&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address.push({city: &quot;Eching&quot;, country: &quot;Germany&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">address.push({city: &quot;Berlin&quot;, country: &quot;Germany&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name.multiSort(formula($1.value.firstname &lt; $1.value2.firstname), [address])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//&quot;Alain Martin&quot;,&quot;Jane Doe&quot;,&quot;John Smith&quot;,&quot;John Doe&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//&quot;Lyon France&quot;,&quot;Eching Germany&quot;,&quot;Paris France&quot;,&quot;Berlin Germany&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="orderby">.orderBy()<a href="#orderby" class="hash-link" aria-label="Direct link to .orderBy()" title="Direct link to .orderBy()">​</a></h2><p><strong>.orderBy</strong>() : collection<br><strong>.orderBy</strong>( <em>pathStrings</em> : string ) : collection<br><strong>.orderBy</strong>( <em>pathobjects</em> : collection ) : collection<br><strong>.orderBy</strong>( <em>ascOrDesc</em> : integer ) : collection </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>pathStrings</td><td>string</td><td align="center">-&gt;</td><td>Property path(s) on which to order the collection</td></tr><tr><td>pathobjects</td><td>collection</td><td align="center">-&gt;</td><td>collection of criteria objects</td></tr><tr><td>ascOrDesc</td><td>integer</td><td align="center">-&gt;</td><td><code>kAscending</code> or <code>kDescending</code> (scalar values)</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Ordered copy of the collection (shallow copy)</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-31">Description<a href="#description-31" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.orderBy()</code> function returns a new collection containing all elements of the collection in the specified order.</p><p>This function returns a <em>shallow copy</em>, which means that objects or collections in both collections share the same reference. If the original collection is a shared collection, the returned collection is also a shared collection.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>If you pass no parameter, the function orders scalar values in the collection in ascending order (other element types such as objects or collections are returned unordered). You can modify this automatic order by passing the <code>kAscending</code> or <code>kDescending</code> constants in the <em>ascOrDesc</em> parameter (see below).</p><p>You can also pass a criteria parameter to define how the collection elements must be sorted. Three syntaxes are supported for this parameter:</p><ul><li><p><em>pathStrings</em>: string (formula). <strong>Syntax</strong>: <code>propertyPath1 {desc or asc}, propertyPath2 {desc or asc},...</code> (default order: asc). <em>pathStrings</em> contains a formula made of 1 to x property paths and (optionally) sort orders, separated by commas. The order in which the properties are passed determines the sorting priority of the collection elements. By default, properties are sorted in ascending order. You can set the sort order of a property in the criteria string, separated from the property path by a single space: pass &quot;asc&quot; to sort in ascending order or &quot;desc&quot; in descending order.</p></li><li><p><em>pathobjects</em>: collection. You can add as many objects in the <em>pathobjects</em> collection as necessary. By default, properties are sorted in ascending order (&quot;descending&quot; is false). Each element of the collection contains an object structured in the following way:  </p></li></ul><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;propertyPath&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;descending&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><p><em>ascOrDesc</em>: integer. You pass one of the following constants:</p><table><thead><tr><th>Constant</th><th>Value</th><th>Comment</th></tr></thead><tbody><tr><td>kAscending</td><td>0</td><td>Elements are ordered in ascending order (default)</td></tr><tr><td>kDescending</td><td>1</td><td>Elements are ordered in descending order</td></tr></tbody></table><p>This syntax orders scalar values in the collection only (other element types such as objects or collections are returned unordered).</p></li></ul><p>If the collection contains elements of different types, they are first grouped by type and sorted afterwards. Types are returned in the following order:</p><ol><li>null</li><li>booleans</li><li>strings</li><li>numbers</li><li>objects</li><li>collections</li><li>dates</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-10">Example 1<a href="#example-1-10" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><p>Ordering a collection of numbers in ascending and descending order:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c, c2, c3 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> for(vCounter,1,10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c.push(Random)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.orderBy(kAscending)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c3 = c.orderBy(kDescending)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-9">Example 2<a href="#example-2-9" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><p>Ordering a collection of objects based on a text formula with property names:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c, c2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> for(vCounter,1,10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c.push(newObject(&quot;id&quot;,vCounter,&quot;value&quot;,random))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.orderBy(&quot;value desc&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.orderBy(&quot;value desc, id&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.orderBy(&quot;value desc, id asc&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ordering a collection of objects with a property path:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c, c2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Cleveland&quot;,&quot;phones&quot;,newObject(&quot;p1&quot;,&quot;01&quot;,&quot;p2&quot;,&quot;02&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Blountsville&quot;,&quot;phones&quot;,newObject(&quot;p1&quot;,&quot;00&quot;,&quot;p2&quot;,&quot;03&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.orderBy(&quot;phones.p1 asc&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-3-5">Example 3<a href="#example-3-5" class="hash-link" aria-label="Direct link to Example 3" title="Direct link to Example 3">​</a></h4><p>Ordering a collection of objects using a collection of criteria objects:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var crit, c, c2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> crit = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> for(vCounter,1,10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c.push(newObject(&quot;id&quot;,vCounter,&quot;value&quot;,random))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> crit.push(newObject(&quot;propertyPath&quot;,&quot;value&quot;,&quot;descending&quot;,true))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> crit.push(newObject(&quot;propertyPath&quot;,&quot;id&quot;,&quot;descending&quot;,false))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.orderBy(crit)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ordering with a property path:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var crit, c, c2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Cleveland&quot;,&quot;phones&quot;,newObject(&quot;p1&quot;,&quot;01&quot;,&quot;p2&quot;,&quot;02&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Blountsville&quot;,&quot;phones&quot;,newObject(&quot;p1&quot;,&quot;00&quot;,&quot;p2&quot;,&quot;03&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> crit = newCollection(newObject(&quot;propertyPath&quot;,&quot;phones.p2&quot;,&quot;descending&quot;,true))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.orderBy(crit)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="orderbymethod">.orderByMethod()<a href="#orderbymethod" class="hash-link" aria-label="Direct link to .orderByMethod()" title="Direct link to .orderByMethod()">​</a></h2><p><strong>.orderByMethod</strong>( <em>formula</em> : 4D.Function { , ...<em>extraParam</em> : expression } ) : collection<br><strong>.orderByMethod</strong>( <em>methodName</em> : string { , ...<em>extraParam</em> : expression } ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>formula object</td></tr><tr><td>methodName</td><td>string</td><td align="center">-&gt;</td><td>Name of a method</td></tr><tr><td>extraParam</td><td>any</td><td align="center">-&gt;</td><td>Parameter(s) to pass</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Sorted copy of the collection (shallow copy)</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-32">Description<a href="#description-32" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.orderByMethod()</code> function returns a new collection containing all elements of the collection in the order defined through the <em>formula</em> function or <em>methodName</em> method.</p><p>This function returns a <em>shallow copy</em>, which means that objects or collections in both collections share the same reference. If the original collection is a shared collection, the returned collection is also a shared collection.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>You designate the callback to be executed to evaluate collection elements using either:</p><ul><li><p><em>formula</em> (recommended syntax), a <a href="/docs/language/FunctionClass">formula object</a> that can encapsulate any executable expressions, including functions and project methods,</p></li><li><p>or <em>methodName</em>, the name of a project method (string).</p></li></ul><p>In the callback, pass some code that compares two values and returns <strong>true</strong> if the first value is lower than the second value. You can provide <em>extraParam</em> parameters to the callback if necessary.</p><p>The callback receives the following parameters:</p><ul><li>$1 (object), where:<ul><li><em>$1.value</em> (any type): first element value to be compared</li><li><em>$1.value2</em> (any type): second element value to be compared</li></ul></li><li>$2...$N (any type): extra parameters</li></ul><p>If you used a method, it must set the following parameter:</p><ul><li><em>$1.result</em> (boolean): <strong>true</strong> if <em>$1.value &lt; $1.value2</em>, <strong>false</strong> otherwise</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-11">Example 1<a href="#example-1-11" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><p>You want to sort a collection of strings in numerical order rather than alphabetical order:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c, c2, c3 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(&quot;33&quot;,&quot;4&quot;,&quot;1111&quot;,&quot;222&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.orderBy() //c2: [&quot;1111&quot;,&quot;222&quot;,&quot;33&quot;,&quot;4&quot;], alphabetical order</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c3 = c.orderByMethod(formula(num($1.value)&lt;num($1.value2))) // c3: [&quot;4&quot;,&quot;33&quot;,&quot;222&quot;,&quot;1111&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-10">Example 2<a href="#example-2-10" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><p>You want to sort a collection of strings on their length:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var fruits, c2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> fruits = newCollection(&quot;Orange&quot;,&quot;Apple&quot;,&quot;Grape&quot;,&quot;pear&quot;,&quot;Banana&quot;,&quot;fig&quot;,&quot;Blackberry&quot;,&quot;Passion fruit&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = fruits.orderByMethod(formula(length(string($1.value))&gt;length(string($1.value2))))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //c2:[Passion fruit,Blackberry,Orange,Banana,Apple,Grape,pear,fig]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-3-6">Example 3<a href="#example-3-6" class="hash-link" aria-label="Direct link to Example 3" title="Direct link to Example 3">​</a></h4><p>You want to sort a collection by character code or language:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var strings1, strings2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings1 = newCollection(&quot;Alpha&quot;,&quot;Charlie&quot;,&quot;alpha&quot;,&quot;bravo&quot;,&quot;Bravo&quot;,&quot;charlie&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//using the character code:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings2 = strings1.orderByMethod(formula(sortcollection),sk character codes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// result : [&quot;Alpha&quot;,&quot;Bravo&quot;,&quot;Charlie&quot;,&quot;alpha&quot;,&quot;bravo&quot;,&quot;charlie&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//using the language:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strings2 = strings1.orderByMethod(formula(sortcollection),sk strict)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// result : [&quot;alpha&quot;,&quot;Alpha&quot;,&quot;bravo&quot;,&quot;Bravo&quot;,&quot;charlie&quot;,&quot;Charlie&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <strong><em>sortcollection</em></strong> method:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var $1: object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var $2: integer // sort option</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$1.result = (compareStrings($1.value,$1.value2,$2)&lt;0)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pop">.pop()<a href="#pop" class="hash-link" aria-label="Direct link to .pop()" title="Direct link to .pop()">​</a></h2><p><strong>.pop</strong>() : any </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Result</td><td>any</td><td align="center">&lt;-</td><td>Last element of collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-33">Description<a href="#description-33" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.pop()</code> function removes the last element from the collection and returns it as the function result.</p><blockquote><p>This function modifies the original collection.</p></blockquote><p>When applied to an empty collection, <code>.pop()</code> returns <strong><em>undefined</em></strong>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-23">Example<a href="#example-23" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><p><code>.pop()</code>, used in conjunction with <a href="#push"><code>.push()</code></a>, can be used to implement a first-in, last-out stack feature:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var stack : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var result : variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> stack = newCollection() //stack:[]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> stack.push(1,2) //[1,2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> result = stack.pop() //[1], returns 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> stack.push(newCollection(4,5)) //[1,[4,5]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> result = stack.pop() //[1], returns [4,5]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> result = stack.pop() //[], returns 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="push">.push()<a href="#push" class="hash-link" aria-label="Direct link to .push()" title="Direct link to .push()">​</a></h2><p><strong>.push</strong>( <em>element</em> : any { ,...<em>elementN</em> } ) : collection </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>element</td><td>any</td><td align="center">-&gt;</td><td>Element(s) to add to the collection</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Original collection containing added elements</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-34">Description<a href="#description-34" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.push()</code> function appends one or more <em>element</em>(s) to the end of the collection instance and returns the edited collection.</p><blockquote><p>This function modifies the original collection.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-12">Example 1<a href="#example-1-12" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(1,2) //col:[1,2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(3) //[1,2,3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(6,newObject(&quot;firstname&quot;,&quot;John&quot;,&quot;lastname&quot;,&quot;Smith&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //col:[1,2,3,6,{firstname:John,lastname:Smith}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-11">Example 2<a href="#example-2-11" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><p>You want to sort the resulting collection:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col, sortedCol : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(5,3,9) //col:[5,3,9]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> sortedCol = col.push(7,50).sort()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //col:[5,3,9,7,50]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //sortedCol:[3,5,7,9,50]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="query">.query()<a href="#query" class="hash-link" aria-label="Direct link to .query()" title="Direct link to .query()">​</a></h2><p><strong>.query</strong>( <em>queryString</em> : string , <em>...value</em> : any ) : collection<br><strong>.query</strong>( <em>queryString</em> : string , <em>querySettings</em> : object ) : collection </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>queryString</td><td>string</td><td align="center">-&gt;</td><td>Search criteria</td></tr><tr><td>value</td><td>any</td><td align="center">-&gt;</td><td>Value(s) to compare when using placeholder(s)</td></tr><tr><td>querySettings</td><td>object</td><td align="center">-&gt;</td><td>Query options: parameters, attributes</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Element(s) matching <em>queryString</em> in the collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-35">Description<a href="#description-35" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.query()</code> function returns all elements of a collection of objects that match the search conditions defined by <em>queryString</em> and (optionally) <em>value</em> or <em>querySettings</em>. If the original collection is a shared collection, the returned collection is also a shared collection.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>The <em>queryString</em> parameter uses the following syntax:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">propertyPath comparator value {logicalOperator propertyPath comparator value}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For detailed information on how to build a query using <em>queryString</em>, <em>value</em> and <em>querySettings</em> parameters, please refer to the <a href="/docs/language/DataClassClass#query"><code>dataClass.query()</code></a> function description.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Formulas are not supported by the <code>collection.query()</code> function, neither in the <em>queryString</em> parameter nor as <em>formula</em> object parameter.</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-13">Example 1<a href="#example-1-13" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c, c2, c3 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Cleveland&quot;,&quot;zc&quot;,35049))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Blountsville&quot;,&quot;zc&quot;,35031))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Adger&quot;,&quot;zc&quot;,35006))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Clanton&quot;,&quot;zc&quot;,35046))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Clanton&quot;,&quot;zc&quot;,35045))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.query(&quot;name = :1&quot;,&quot;Cleveland&quot;) //c2:[{name:Cleveland,zc:35049}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c3 = c.query(&quot;zc &gt; 35040&quot;) //c3:[{name:Cleveland,zc:35049},{name:Clanton,zc:35046},{name:Clanton,zc:35045}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-12">Example 2<a href="#example-2-12" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Smith&quot;,&quot;dateHired&quot;,!22-05-2002!,&quot;age&quot;,45))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Wesson&quot;,&quot;dateHired&quot;,!30-11-2017!))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Winch&quot;,&quot;dateHired&quot;,!16-05-2018!,&quot;age&quot;,36))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Sterling&quot;,&quot;dateHired&quot;,!10-5-1999!,&quot;age&quot;,null))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newObject(&quot;name&quot;,&quot;Mark&quot;,&quot;dateHired&quot;,!01-01-2002!))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This example returns persons whose name contains &quot;in&quot;:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> col = c.query(&quot;name = :1&quot;,&quot;@in@&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //col:[{name:Winch...},{name:Sterling...}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This example returns persons whose name does not begin with a string from a variable (entered by the user, for example):</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> col = c.query(&quot;name  !=  :1&quot;,aString+&quot;@&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //if astring = &quot;W&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //col:[{name:Smith...},{name:Sterling...},{name:Mark...}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This example returns persons whose age is not known (property set to null or undefined):</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> col = c.query(&quot;age = null&quot;) //placeholders not allowed with &quot;null&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //col:[{name:Wesson...},{name:Sterling...},{name:Mark...}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This example returns persons hired more than 90 days ago:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> col = c.query(&quot;dateHired &lt; :1&quot;,(currentDate-90))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //col:[{name:Smith...},{name:Sterling...},{name:Mark...}] if today is 01/10/2018</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>More examples of queries can be found in the <a href="/docs/language/DataClassClass#query"><code>dataClass.query()</code></a> section.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reduce">.reduce()<a href="#reduce" class="hash-link" aria-label="Direct link to .reduce()" title="Direct link to .reduce()">​</a></h2><p><strong>.reduce</strong>( <em>formula</em> : 4D.Function { , <em>initValue</em> : any { , <em>...param</em> : expression }} ) : any<br><strong>.reduce</strong>( <em>methodName</em> : string { , <em>initValue</em> : any { , <em>...param</em> : expression }} ) : any </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>formula object</td></tr><tr><td>methodName</td><td>string</td><td align="center">-&gt;</td><td>Name of a method</td></tr><tr><td>initValue</td><td>string, Number, object, collection, date, boolean</td><td align="center">-&gt;</td><td>Value to use as the first argument to the first call of <em>formula</em> or <em>methodName</em></td></tr><tr><td>param</td><td>expression</td><td align="center">-&gt;</td><td>Parameter(s) to pass</td></tr><tr><td>Result</td><td>string, Number, object, collection, date, boolean</td><td align="center">&lt;-</td><td>Result of the accumulator value</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-36">Description<a href="#description-36" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.reduce()</code> function applies the <em>formula</em> or <em>methodName</em> callback against an accumulator and each element in the collection (from left to right) to reduce it to a single value.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>You designate the callback to be executed to evaluate collection elements using either:</p><ul><li><em>formula</em> (recommended syntax), a <a href="/docs/language/FunctionClass">formula object</a> that can encapsulate any executable expressions, including functions and project methods,</li><li>or <em>methodName</em>, the name of a project method (string).</li></ul><p>The callback takes each collection element and performs any desired operation to accumulate the result into <em>$1.accumulator</em>, which is returned in <em>$1.value</em>.</p><p>You can pass the value to initialize the accumulator in <em>initValue</em>. If omitted, <em>$1.accumulator</em> starts with <code>undefined</code>.</p><p>The callback receives the following parameters:</p><ul><li>in <em>$1.value</em>: element value to be processed</li><li>in <em>$2: param</em></li><li>in <em>$N...</em>: <em>paramN...</em></li></ul><p>The callback sets the following parameter(s):</p><ul><li><em>$1.accumulator</em>: value to be modified by the function and which is initialized by <em>initValue</em>.</li><li><em>$1.stop</em> (boolean, optional): <strong>true</strong> to stop the method callback. The returned value is the last calculated.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-14">Example 1<a href="#example-1-14" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection(5,3,5,1,3,4,4,6,2,2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r = c.reduce(formula($1.accumulator* = $1.value), 1)  //returns 86400</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-13">Example 2<a href="#example-2-13" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><p>This example allows reducing several collection elements to a single one:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c,r : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newCollection(0,1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newCollection(2,3))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newCollection(4,5))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newCollection(6,7))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> r = c.reduce(formula(Flatten)) //r:[0,1,2,3,4,5,6,7]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With the following <strong><em>Flatten</em></strong> method:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> if($1.accumulator = null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $1.accumulator = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $1.accumulator.combine($1.value)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reduceright">.reduceRight()<a href="#reduceright" class="hash-link" aria-label="Direct link to .reduceRight()" title="Direct link to .reduceRight()">​</a></h2><p><strong>.reduceRight</strong>( <em>formula</em> : 4D.Function { , <em>initValue</em> : any { , <em>...param</em> : expression }} ) : any<br><strong>.reduceRight</strong>( <em>methodName</em> : string { , <em>initValue</em> : any { , <em>...param</em> : expression }} ) : any </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>formula object</td></tr><tr><td>methodName</td><td>string</td><td align="center">-&gt;</td><td>Name of a method</td></tr><tr><td>initValue</td><td>string, Number, object, collection, date, boolean</td><td align="center">-&gt;</td><td>Value to use as the first argument to the first call of <em>formula</em> or <em>methodName</em></td></tr><tr><td>param</td><td>expression</td><td align="center">-&gt;</td><td>Parameter(s) to pass</td></tr><tr><td>Result</td><td>string, Number, object, collection, date, boolean</td><td align="center">&lt;-</td><td>Result of the accumulator value</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-37">Description<a href="#description-37" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.reduceRight()</code> function applies the <em>formula</em> or <em>methodName</em> callback against an accumulator and each element in the collection (from right to left) to reduce it to a single value.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>You designate the callback to be executed to evaluate collection elements using either:</p><ul><li><em>formula</em> (recommended syntax), a <a href="/docs/language/FunctionClass">formula object</a> that can encapsulate any executable expressions, including functions and project methods,</li><li>or <em>methodName</em>, the name of a project method (string).</li></ul><p>The callback takes each collection element and performs any desired operation to accumulate the result into <em>$1.accumulator</em>, which is returned in <em>$1.value</em>.</p><p>You can pass the value to initialize the accumulator in <em>initValue</em>. If omitted, <em>$1.accumulator</em> starts with <code>undefined</code>.</p><p>The callback receives the following parameters:</p><ul><li>in <em>$1.value</em>: element value to be processed</li><li>in <em>$2: param</em></li><li>in <em>$N...</em>: <em>paramN...</em></li></ul><p>The callback sets the following parameter(s):</p><ul><li><em>$1.accumulator</em>: value to be modified by the function and which is initialized by <em>initValue</em>.</li><li><em>$1.stop</em> (boolean, optional): <strong>true</strong> to stop the method callback. The returned value is the last calculated.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-15">Example 1<a href="#example-1-15" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c = newCollection(5,3,5,1,3,4,4,6,2,2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r = c.reduceRight(formula($1.accumulator* = $1.value), 1)  //returns 86400</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-14">Example 2<a href="#example-2-14" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><p>This example allows reducing several collection elements to a single one:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c,r : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newCollection(0,1))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newCollection(2,3))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newCollection(4,5))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(newCollection(6,7))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> r = c.reduceRight(formula(Flatten)) //r:[6,7,4,5,2,3,0,1]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With the following <strong><em>Flatten</em></strong> method:</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    //Flatten project method</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> if($1.accumulator = null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $1.accumulator = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $1.accumulator.combine($1.value)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="remove">.remove()<a href="#remove" class="hash-link" aria-label="Direct link to .remove()" title="Direct link to .remove()">​</a></h2><p><strong>.remove</strong>( <em>index</em> : integer { , <em>howMany</em> : integer } ) : collection </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>index</td><td>integer</td><td align="center">-&gt;</td><td>Element at which to start removal</td></tr><tr><td>howMany</td><td>integer</td><td align="center">-&gt;</td><td>Number of elements to remove, or 1 element if omitted</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Original collection without removed element(s)</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-38">Description<a href="#description-38" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.remove()</code> function removes one or more element(s) from the specified <em>index</em> position in the collection and returns the edited collection.</p><blockquote><p>This function modifies the original collection.</p></blockquote><p>In <em>index</em>, pass the position where you want the element to be removed from the collection.</p><blockquote><p><strong>Warning</strong>: Keep in mind that collection elements are numbered from 0. If <em>index</em> is greater than the length of the collection, actual starting index will be set to the length of the collection.</p></blockquote><ul><li>If <em>index</em> &lt; 0, it is recalculated as <em>index = index+length</em> (it is considered as the offset from the end of the collection).</li><li>If the calculated value &lt; 0, <em>index</em> is set to 0.</li><li>If the calculated value &gt; the length of the collection, <em>index</em> is set to the length.</li></ul><p>In <em>howMany</em>, pass the number of elements to remove from <em>index</em>. If <em>howMany</em> is not specified, then one element is removed.</p><p>If you try to remove an element from an empty collection, the method does nothing (no error is generated).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-24">Example<a href="#example-24" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;,&quot;f&quot;,&quot;g&quot;,&quot;h&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.remove(3) // [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;e&quot;,&quot;f&quot;,&quot;g&quot;,&quot;h&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.remove(3,2) // [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;g&quot;,&quot;h&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.remove(-8,1) // [&quot;b&quot;,&quot;c&quot;,&quot;g&quot;,&quot;h&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.remove(-3,1) // [&quot;b&quot;,&quot;g&quot;,&quot;h&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resize">.resize()<a href="#resize" class="hash-link" aria-label="Direct link to .resize()" title="Direct link to .resize()">​</a></h2><p><strong>.resize</strong>( <em>size</em> : integer { , <em>defaultValue</em> : any } ) : collection </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>size</td><td>integer</td><td align="center">-&gt;</td><td>New size of the collection</td></tr><tr><td>defaultValue</td><td>Number, string, object, collection, date, boolean</td><td align="center">-&gt;</td><td>Default value to fill new elements</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Resized original collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-39">Description<a href="#description-39" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.resize()</code> function sets the collection length to the specified new <em>size</em> and returns the resized collection.</p><blockquote><p>This function modifies the original collection.</p></blockquote><ul><li>If <em>size</em> &lt; collection length, exceeding elements are removed from the collection.</li><li>If <em>size</em> &gt; collection length, the collection length is increased to size.</li></ul><p>By default, new elements are filled will <strong>null</strong> values. You can specify the value to fill in added elements using the <em>defaultValue</em> parameter.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-25">Example<a href="#example-25" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.resize(10) // c:[null,null,null,null,null,null,null,null,null,null]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.resize(10,0) // c:[0,0,0,0,0,0,0,0,0,0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(1,2,3,4,5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.resize(10,newObject(&quot;name&quot;,&quot;X&quot;)) //c:[1,2,3,4,5,{name:X},{name:X},{name:X},{name:X},{name:X}]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(1,2,3,4,5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.resize(2) //c:[1,2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reverse">.reverse()<a href="#reverse" class="hash-link" aria-label="Direct link to .reverse()" title="Direct link to .reverse()">​</a></h2><p><strong>.reverse</strong>() : collection </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Inverted copy of the collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-40">Description<a href="#description-40" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.reverse()</code> function returns a deep copy of the collection with all its elements in reverse order. If the original collection is a shared collection, the returned collection is also a shared collection.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-26">Example<a href="#example-26" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c, c2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(1,3,5,2,4,6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c2 = c.reverse() //c2:[6,4,2,5,3,1]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="shift">.shift()<a href="#shift" class="hash-link" aria-label="Direct link to .shift()" title="Direct link to .shift()">​</a></h2><p><strong>.shift</strong>() : any</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>Result</td><td>any</td><td align="center">&lt;-</td><td>First element of collection</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-41">Description<a href="#description-41" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.shift()</code> function removes the first element of the collection and returns it as the function result.</p><blockquote><p>This function modifies the original collection.</p></blockquote><p>If the collection is empty, this function does nothing.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-27">Example<a href="#example-27" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var val : variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(1,2,4,5,6,7,8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> val = c.shift()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // val:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // c:[2,4,5,6,7,8]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="slice">.slice()<a href="#slice" class="hash-link" aria-label="Direct link to .slice()" title="Direct link to .slice()">​</a></h2><p><strong>.slice</strong>( <em>startFrom</em> : integer { , <em>end</em> : integer } ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startFrom</td><td>integer</td><td align="center">-&gt;</td><td>Start index (included)</td></tr><tr><td>end</td><td>integer</td><td align="center">-&gt;</td><td>End index (not included)</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>new collection containing sliced elements (shallow copy)</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-42">Description<a href="#description-42" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.slice()</code> function returns a portion of a collection into a new collection, selected from <em>startFrom</em> index to <em>end</em> index (<em>end</em> not included). This function returns a <em>shallow copy</em> of the collection. If the original collection is a shared collection, the returned collection is also a shared collection.</p><blockquote><p>This function does not modify the original collection.</p></blockquote><p>The returned collection contains the element specified by <em>startFrom</em> and all subsequent elements up to, but not including, the element specified by <em>end</em>. If only the <em>startFrom</em> parameter is specified, the returned collection contains all elements from <em>startFrom</em> to the last element of the original collection.</p><ul><li>If <em>startFrom</em> &lt; 0, it is recalculated as <em>startFrom = startFrom+length</em> (it is considered as the offset from the end of the collection).</li><li>If the calculated value &lt; 0, <em>startFrom</em> is set to 0.</li><li>If <em>end</em> &lt; 0 , it is recalculated as <em>end = end+length</em>.</li><li>If <em>end &lt; startFrom</em> (passed or calculated values), the method does nothing.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-28">Example<a href="#example-28" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c, nc : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(1,2,3,4,5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> nc = c.slice(0,3) //nc:[1,2,3]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> nc = c.slice(3) //nc:[4,5]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> nc = c.slice(1,-1) //nc:[2,3,4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> nc = c.slice(-3,-2) //nc:[3]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="some">.some()<a href="#some" class="hash-link" aria-label="Direct link to .some()" title="Direct link to .some()">​</a></h2><p><strong>.some</strong>( { <em>startFrom</em> : integer , } <em>formula</em> : 4D.Function { , <em>...param</em> : any } ) : boolean<br><strong>.some</strong>( { <em>startFrom</em> : integer , } <em>methodName</em> : string { , <em>...param</em> : any } ) : boolean</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>startFrom</td><td>integer</td><td align="center">-&gt;</td><td>Index to start the test at</td></tr><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>formula object</td></tr><tr><td>methodName</td><td>string</td><td align="center">-&gt;</td><td>Name of a method</td></tr><tr><td>param</td><td>Mixed</td><td align="center">-&gt;</td><td>Parameter(s) to pass</td></tr><tr><td>Result</td><td>boolean</td><td align="center">&lt;-</td><td>true if at least one element successfully passed the test</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-43">Description<a href="#description-43" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.some()</code> function returns true if at least one element in the collection successfully passed a test implemented in the provided <em>formula</em> or <em>methodName</em> code.</p><p>You designate the QodlyScript code (callback) to be executed to evaluate collection elements using either:</p><ul><li><em>formula</em> (recommended syntax), a <a href="/docs/language/FunctionClass">formula object</a> that can encapsulate any executable expressions, including functions and project methods,</li><li>or <em>methodName</em>, the name of a project method (string).</li></ul><p>The callback is called with the parameter(s) passed in <em>param</em> (optional). The callback can perform any test, with or without the parameter(s) and must return <strong>true</strong> for every element fulfilling the test. It receives an <code>object</code> in first parameter, named <code>$1</code>.</p><p>The callback receives the following parameters:</p><ul><li>in <em>$1.value</em>: element value to be processed</li><li>in <em>$2: param</em></li><li>in <em>$N...</em>: <em>paramN...</em></li></ul><p>It can set the following parameter(s):</p><ul><li>(mandatory if you used a method) <em>$1.result</em> (boolean): <strong>true</strong> if the element value evaluation is successful, <strong>false</strong> otherwise.</li><li><em>$1.stop</em> (boolean, optional): <strong>true</strong> to stop the method callback. The returned value is the last calculated.</li></ul><p>In any case, at the point where <code>.some()</code> function encounters the first collection element returning true, it stops calling the callback and returns <strong>true</strong>.</p><p>By default, <code>.some()</code> tests the whole collection. Optionally, you can pass the index of an element from which to start the test in <em>startFrom</em>.</p><ul><li>If <em>startFrom</em> &gt;=  the collection&#x27;s length, <strong>False</strong> is returned, which means the collection is not tested.</li><li>If <em>startFrom</em> &lt; 0, it is considered as the offset from the end of the collection.</li><li>If <em>startFrom</em>  ==  0, the whole collection is searched (default).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-29">Example<a href="#example-29" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><p>You want to know if at least one collection value is &gt;0.</p><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var b : boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(-5,-3,-1,-4,-6,-2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> b = c.some(formula($1.value&gt;0)) // b:false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> b = c.some(formula($1.value&gt;0)) // b:true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.push(1,-5,-3,-1,-4,-6,-2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> b = c.some(formula($1.value&gt;0)) //b:true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> b = c.some(1,formula($1.value&gt;0)) //b:false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sort">.sort()<a href="#sort" class="hash-link" aria-label="Direct link to .sort()" title="Direct link to .sort()">​</a></h2><p><strong>.sort</strong>() : collection<br><strong>.sort</strong>( <em>formula</em> : 4D.Function { , <em>...extraParam</em> : any } ) : collection<br><strong>.sort</strong>( <em>methodName</em> : string { , <em>...extraParam</em> : any } ) : collection </p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>formula</td><td>4D.Function</td><td align="center">-&gt;</td><td>formula object</td></tr><tr><td>methodName</td><td>string</td><td align="center">-&gt;</td><td>Name of a method</td></tr><tr><td>extraParam</td><td>any</td><td align="center">-&gt;</td><td>Parameter(s) for the method</td></tr><tr><td>Result</td><td>collection</td><td align="center">&lt;-</td><td>Original collection sorted</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-44">Description<a href="#description-44" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.sort()</code> function sorts the elements of the original collection and also returns the sorted collection .</p><blockquote><p>This function modifies the original collection.</p></blockquote><p>If <code>.sort()</code> is called with no parameters, only scalar values (number, text, date, booleans) are sorted. Elements are sorted by default in ascending order, according to their type. If the collection contains elements of different types, they are first grouped by type and sorted afterwards. Types are returned in the following order:</p><ol><li>null</li><li>booleans</li><li>strings</li><li>numbers</li><li>objects</li><li>collections</li><li>dates</li></ol><p>If you want to sort the collection elements in some other order or sort any type of element, you must supply in <em>formula</em> (<a href="/docs/language/FunctionClass">formula object</a>) or <em>methodName</em> (string) a callback that defines the sort order.  The return value should be a boolean that indicates the relative order of the two elements: <strong>true</strong> if <em>$1.value</em> is less than <em>$1.value2</em>, <strong>false</strong> if <em>$1.value</em> is greater than <em>$1.value2</em>. You can provide additional parameters to the callback if necessary.</p><p>The callback receives the following parameters:</p><ul><li>$1 (object), where:<ul><li><em>$1.value</em> (any type): first element value to be compared</li><li><em>$1.value2</em> (any type): second element value to be compared</li></ul></li><li>$2...N (any type): extra parameters</li></ul><p>If you used a method, you must set the following parameter:</p><ul><li><em>$1.result</em> (boolean): <strong>true</strong> if <em>$1.value &lt; $1.value2</em>, <strong>false</strong> otherwise.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-16">Example 1<a href="#example-1-16" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col, col2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(&quot;Tom&quot;,5,&quot;Mary&quot;,3,&quot;Henry&quot;,1,&quot;Jane&quot;,4,&quot;Artie&quot;,6,&quot;Chip&quot;,2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col2 = col.sort() // col2:[&quot;Artie&quot;,&quot;Chip&quot;,&quot;Henry&quot;,&quot;Jane&quot;,&quot;Mary&quot;,&quot;Tom&quot;,1,2,3,4,5,6]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // col:[&quot;Artie&quot;,&quot;Chip&quot;,&quot;Henry&quot;,&quot;Jane&quot;,&quot;Mary&quot;,&quot;Tom&quot;,1,2,3,4,5,6]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-15">Example 2<a href="#example-2-15" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col, col2 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(10,20)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col2 = col.push(5,3,1,4,6,2).sort() //col2:[1,2,3,4,5,6,10,20]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-3-7">Example 3<a href="#example-3-7" class="hash-link" aria-label="Direct link to Example 3" title="Direct link to Example 3">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var col, col2, col3 : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col = newCollection(33,4,66,1111,222)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col2 = col.sort() //numerical sort: [4,33,66,222,1111]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col3 = col.sort(formula(String($1.value)&lt;String($1.value2))) //alphabetical sort: [1111,222,33,4,66]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sum">.sum()<a href="#sum" class="hash-link" aria-label="Direct link to .sum()" title="Direct link to .sum()">​</a></h2><p><strong>.sum</strong>( { <em>propertyPath</em> : string } ) : number</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>propertyPath</td><td>string</td><td align="center">-&gt;</td><td>object property path to be used for calculation</td></tr><tr><td>Result</td><td>number</td><td align="center">&lt;-</td><td>Sum of collection values</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-45">Description<a href="#description-45" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.sum()</code> function returns the sum for all values in the collection instance.</p><p>Only numerical elements are taken into account for the calculation (other element types are ignored).</p><p>If the collection contains objects, pass the <em>propertyPath</em> parameter to indicate the object property to take into account.</p><p><code>.sum()</code> returns 0 if:</p><ul><li>the collection is empty,</li><li>the collection does not contain numerical elements,</li><li><em>propertyPath</em> is not found in the collection.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-17">Example 1<a href="#example-1-17" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var vSum : number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection(10,20,&quot;Monday&quot;,true,2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> vSum = col.sum() //32</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-16">Example 2<a href="#example-2-16" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var col : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> var vSum : number</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col = newCollection()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Smith&quot;,&quot;salary&quot;,10000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Wesson&quot;,&quot;salary&quot;,50000))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> col.push(newObject(&quot;name&quot;,&quot;Gross&quot;,&quot;salary&quot;,10500,5))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> vSum = col.sum(&quot;salary&quot;) //vSum:70500,5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="unshift">.unshift()<a href="#unshift" class="hash-link" aria-label="Direct link to .unshift()" title="Direct link to .unshift()">​</a></h2><p><strong>.unshift</strong>( <em>value</em> : any { ,...<em>valueN</em> : any } ) : collection</p><table><thead><tr><th>Parameter</th><th>Type</th><th align="center"></th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>string, Number, object, collection, date</td><td align="center">-&gt;</td><td>Value(s) to insert at the beginning of the collection</td></tr><tr><td>Result</td><td>number</td><td align="center">&lt;-</td><td>collection containing added element(s)</td></tr></tbody></table><p>|</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="description-46">Description<a href="#description-46" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h4><p>The <code>.unshift()</code> function inserts the given <em>value</em>(s) at the beginning of the collection and returns the modified collection.</p><blockquote><p>This function modifies the original collection.</p></blockquote><p>If several values are passed, they are inserted all at once, which means that they appear in the resulting collection in the same order as in the argument list.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-30">Example<a href="#example-30" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4><div class="language-qs codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-qs codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> var c : collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c = newCollection(1,2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.unshift(4) // c:[4,1,2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.unshift(5) //c:[5,4,1,2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> c.unshift(6,7) // c:[6,7,5,4,1,2]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/docQodly/docs/edit/main/docs/language/CollectionClass.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/language/ClassClass"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Class</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/language/CryptoKeyClass"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CryptoKey</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#functions-and-properties" class="table-of-contents__link toc-highlight">Functions and properties</a></li><li><a href="#at" class="table-of-contents__link toc-highlight">.at()</a></li><li><a href="#average" class="table-of-contents__link toc-highlight">.average()</a></li><li><a href="#clear" class="table-of-contents__link toc-highlight">.clear()</a></li><li><a href="#combine" class="table-of-contents__link toc-highlight">.combine()</a></li><li><a href="#concat" class="table-of-contents__link toc-highlight">.concat()</a></li><li><a href="#copy" class="table-of-contents__link toc-highlight">.copy()</a></li><li><a href="#count" class="table-of-contents__link toc-highlight">.count()</a></li><li><a href="#countvalues" class="table-of-contents__link toc-highlight">.countValues()</a></li><li><a href="#distinct" class="table-of-contents__link toc-highlight">.distinct()</a></li><li><a href="#equal" class="table-of-contents__link toc-highlight">.equal()</a></li><li><a href="#every" class="table-of-contents__link toc-highlight">.every()</a></li><li><a href="#extract" class="table-of-contents__link toc-highlight">.extract()</a></li><li><a href="#fill" class="table-of-contents__link toc-highlight">.fill()</a></li><li><a href="#filter" class="table-of-contents__link toc-highlight">.filter()</a></li><li><a href="#find" class="table-of-contents__link toc-highlight">.find()</a></li><li><a href="#findindex" class="table-of-contents__link toc-highlight">.findIndex()</a></li><li><a href="#first" class="table-of-contents__link toc-highlight">.first()</a></li><li><a href="#flat" class="table-of-contents__link toc-highlight">.flat()</a></li><li><a href="#flatmap" class="table-of-contents__link toc-highlight">.flatMap()</a></li><li><a href="#includes" class="table-of-contents__link toc-highlight">.includes()</a></li><li><a href="#indexof" class="table-of-contents__link toc-highlight">.indexOf()</a></li><li><a href="#indices" class="table-of-contents__link toc-highlight">.indices()</a></li><li><a href="#insert" class="table-of-contents__link toc-highlight">.insert()</a></li><li><a href="#join" class="table-of-contents__link toc-highlight">.join()</a></li><li><a href="#last" class="table-of-contents__link toc-highlight">.last()</a></li><li><a href="#lastindexof" class="table-of-contents__link toc-highlight">.lastIndexOf()</a></li><li><a href="#length" class="table-of-contents__link toc-highlight">.length</a></li><li><a href="#map" class="table-of-contents__link toc-highlight">.map()</a></li><li><a href="#max" class="table-of-contents__link toc-highlight">.max()</a></li><li><a href="#min" class="table-of-contents__link toc-highlight">.min()</a></li><li><a href="#multisort" class="table-of-contents__link toc-highlight">.multiSort()</a></li><li><a href="#orderby" class="table-of-contents__link toc-highlight">.orderBy()</a></li><li><a href="#orderbymethod" class="table-of-contents__link toc-highlight">.orderByMethod()</a></li><li><a href="#pop" class="table-of-contents__link toc-highlight">.pop()</a></li><li><a href="#push" class="table-of-contents__link toc-highlight">.push()</a></li><li><a href="#query" class="table-of-contents__link toc-highlight">.query()</a></li><li><a href="#reduce" class="table-of-contents__link toc-highlight">.reduce()</a></li><li><a href="#reduceright" class="table-of-contents__link toc-highlight">.reduceRight()</a></li><li><a href="#remove" class="table-of-contents__link toc-highlight">.remove()</a></li><li><a href="#resize" class="table-of-contents__link toc-highlight">.resize()</a></li><li><a href="#reverse" class="table-of-contents__link toc-highlight">.reverse()</a></li><li><a href="#shift" class="table-of-contents__link toc-highlight">.shift()</a></li><li><a href="#slice" class="table-of-contents__link toc-highlight">.slice()</a></li><li><a href="#some" class="table-of-contents__link toc-highlight">.some()</a></li><li><a href="#sort" class="table-of-contents__link toc-highlight">.sort()</a></li><li><a href="#sum" class="table-of-contents__link toc-highlight">.sum()</a></li><li><a href="#unshift" class="table-of-contents__link toc-highlight">.unshift()</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://qodly.com/tutorials" target="_blank" rel="noopener noreferrer" class="footer__link-item">Tutorials</a></li><li class="footer__item"><a href="https://support.4d.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Get Support</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/notes/v1.0.0-beta.4">Release Notes</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://qodly.com/about-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">About Qodly</a></li><li class="footer__item"><a href="https://us.4d.com/about-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">About 4D</a></li><li class="footer__item"><a href="mailto:contact@qodly.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us</a></li></ul></div><div class="col footer__col"><div class="footer__title">Follow Us</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://join.slack.com/t/qodly/shared_invite/zt-20ieeffts-NU57SOXcbakmWgIMnJpStQ" target="_blank" rel="noopener noreferrer" class="footer__link-item" src="slack">Slack</a></li><li class="footer__item"><a href="https://www.facebook.com/qodlyby4d" target="_blank" rel="noopener noreferrer" class="footer__link-item" src="facebook">Facebook</a></li><li class="footer__item"><a href="https://twitter.com/qodlyby4d" target="_blank" rel="noopener noreferrer" class="footer__link-item" src="twitter">Twitter</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCLNHKvjJQZ_5D1ziskba6jg" target="_blank" rel="noopener noreferrer" class="footer__link-item" src="youtube">Youtube Channels</a></li><li class="footer__item"><a href="https://linkedin.com/showcase/qodly" target="_blank" rel="noopener noreferrer" class="footer__link-item" src="linkedin">Linkedin</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 4D SAS - All rights reserved</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.f90c87c6.js"></script>
<script src="/docs/assets/js/main.2be75749.js"></script>
</body>
</html>