"use strict";(self.webpackChunkqodly=self.webpackChunkqodly||[]).push([[8959],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>u});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),i=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},m=function(e){var t=i(e.components);return n.createElement(p.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),c=i(a),h=r,u=c["".concat(p,".").concat(h)]||c[h]||d[h]||o;return a?n.createElement(u,s(s({ref:t},m),{},{components:a})):n.createElement(u,s({ref:t},m))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,s=new Array(o);s[0]=h;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[c]="string"==typeof e?e:r,s[1]=l;for(var i=2;i<o;i++)s[i]=a[i];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},61586:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>i});var n=a(87462),r=(a(67294),a(3905));const o={id:"semaphore",title:"semaphore"},s=void 0,l={unversionedId:"language/commands/semaphore",id:"language/commands/semaphore",title:"semaphore",description:"semaphore ( semaphore integer } ) : boolean",source:"@site/docs/language/commands/semaphore.md",sourceDirName:"language/commands",slug:"/language/commands/semaphore",permalink:"/docs/language/commands/semaphore",draft:!1,editUrl:"https://github.com/docQodly/docs/edit/main/docs/language/commands/semaphore.md",tags:[],version:"current",frontMatter:{id:"semaphore",title:"semaphore"},sidebar:"Develop",previous:{title:"round",permalink:"/docs/language/commands/round"},next:{title:"session",permalink:"/docs/language/commands/session"}},p={},i=[{value:"Description",id:"description",level:4},{value:"Example 1",id:"example-1",level:4},{value:"Example 2",id:"example-2",level:4},{value:"See also",id:"see-also",level:4}],m={toc:i};function c(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"semaphore")," ( ",(0,r.kt)("em",{parentName:"p"},"semaphore")," : string { , ",(0,r.kt)("em",{parentName:"p"},"tickCount")," : integer } ) : boolean"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:"center"}),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"semaphore"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:"center"},"->"),(0,r.kt)("td",{parentName:"tr",align:null},"Semaphore to test and set")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"tickCount"),(0,r.kt)("td",{parentName:"tr",align:null},"integer"),(0,r.kt)("td",{parentName:"tr",align:"center"},"->"),(0,r.kt)("td",{parentName:"tr",align:null},"Maximum waiting time")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Result"),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:"center"},"<-"),(0,r.kt)("td",{parentName:"tr",align:null},"false: semaphore has been successfully set, true: semaphore was already set")))),(0,r.kt)("h4",{id:"description"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"semaphore")," command returns ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," and does nothing if ",(0,r.kt)("em",{parentName:"p"},"semaphore")," already exists, or creates ",(0,r.kt)("em",{parentName:"p"},"semaphore")," and returns ",(0,r.kt)("inlineCode",{parentName:"p"},"false")," if it does not exist."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"A ",(0,r.kt)("strong",{parentName:"p"},"semaphore")," is a flag shared among processes. A semaphore simply exists or does not exist. The methods that each process is running can test for the existence of a semaphore. A semaphore can only be removed by the process that created it. By creating and testing semaphores, methods can communicate between processes. You do not use semaphores to protect data access (this is automatically done by the Qodly Server), you use semaphores to prevent several processes from performing the same operation at the same time.")),(0,r.kt)("p",null,"Only one process at a time can create a semaphore. If ",(0,r.kt)("inlineCode",{parentName:"p"},"semaphore")," returns ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),", it means that the semaphore did not exist, but it also means that the ",(0,r.kt)("em",{parentName:"p"},"semaphore")," has been set for the process in which the call has been made."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"semaphore")," returns ",(0,r.kt)("inlineCode",{parentName:"p"},"false")," if the ",(0,r.kt)("em",{parentName:"p"},"semaphore")," was not set. It also returns ",(0,r.kt)("inlineCode",{parentName:"p"},"false")," if the semaphore is already set by the same process in which the call has been made."),(0,r.kt)("p",null,"The ",(0,r.kt)("em",{parentName:"p"},"semaphore")," name is limited to 255 characters. If you pass a longer string, the semaphore will be tested with the truncated string. Keep in mind that semaphore names are case-sensitive."),(0,r.kt)("p",null,"The optional parameter ",(0,r.kt)("em",{parentName:"p"},"tickCount")," allows you to specify a waiting time (in ticks) if ",(0,r.kt)("em",{parentName:"p"},"semaphore")," is already set. In this case, the function will wait either for the semaphore to be freed or the waiting time to expire before returning ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,r.kt)("h4",{id:"example-1"},"Example 1"),(0,r.kt)("p",null,"Here is typical code for using a semaphore:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},'while(semaphore("MySemaphore",300))\n\nend\n  // place code protected by semaphore here\nclearSemaphore("MySemaphore")\n')),(0,r.kt)("h4",{id:"example-2"},"Example 2"),(0,r.kt)("p",null,"This method allows you to not execute a method when a semaphore is present; the method alerts the calling method with an error code and plain text."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},"// calling code\ndeclare -> result : object\nresult = semaphore_proof\n// result.code: error code\n// result.message: error text\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},'  // Protective structure using semaphores\n var result : object\n\n\n  // Start of method\n var L_MyError : integer\n L_MyError = 1\n\n var t_Sema : string\n t_Sema = "tictac"\n\n if(semaphore(t_Sema,300))\n  // We expected 300 ticks but the semaphore\n  // was not released by the one that placed it:\n  // we end up here\n    L_MyError = -1\n\n else\n\n  // This method is only run by one process at a time\n  // We placed the semaphore as we entered\n  // so we\'re the only ones that can remove it\n\n  // Do something\n    ...\n  // Then finish by removing the semaphore\n    clearSemaphore(t_Sema)\n end\n\n var t_Message : string\n if(L_MyError == -1)\n    t_Message = "The semaphore "+t_Sema+" has blocked access to the rest of the code"\n else\n    t_Message = "OK"\n end\n\n result = {code : L_MyError, message : t_Message)\n  // The calling method receives an error code and an explanation in plain text\n')),(0,r.kt)("h4",{id:"see-also"},"See also"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/docs/language/commands/clearSemaphore"},(0,r.kt)("inlineCode",{parentName:"a"},"clearSemaphore")),(0,r.kt)("br",null),"\n",(0,r.kt)("a",{parentName:"p",href:"/docs/language/SignalClass"},(0,r.kt)("inlineCode",{parentName:"a"},"Signal")," class")))}c.isMDXComponent=!0}}]);