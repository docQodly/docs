"use strict";(self.webpackChunkqodly=self.webpackChunkqodly||[]).push([[5491],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>u});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),m=s(a),k=r,u=m["".concat(p,".").concat(k)]||m[k]||c[k]||l;return a?n.createElement(u,i(i({ref:t},d),{},{components:a})):n.createElement(u,i({ref:t},d))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=a.length,i=new Array(l);i[0]=k;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o[m]="string"==typeof e?e:r,i[1]=o;for(var s=2;s<l;s++)i[s]=a[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},28684:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>l,metadata:()=>o,toc:()=>s});var n=a(87462),r=(a(67294),a(3905));const l={id:"EmailObjectClass",title:"Email"},i=void 0,o={unversionedId:"language/EmailObjectClass",id:"language/EmailObjectClass",title:"Email",description:"Creating, sending or receiving emails in Qodly is done by handling an Email object.",source:"@site/docs/language/EmailObjectClass.md",sourceDirName:"language",slug:"/language/EmailObjectClass",permalink:"/docs/language/EmailObjectClass",draft:!1,editUrl:"https://github.com/docQodly/docs/edit/main/docs/language/EmailObjectClass.md",tags:[],version:"current",frontMatter:{id:"EmailObjectClass",title:"Email"},sidebar:"Develop",previous:{title:"DataStore",permalink:"/docs/language/DataStoreClass"},next:{title:"Entity",permalink:"/docs/language/EntityClass"}},p={},s=[{value:"Properties",id:"properties",level:3},{value:"Email Addresses",id:"email-addresses",level:3},{value:"String",id:"string",level:4},{value:"object",id:"object",level:4},{value:"collection",id:"collection",level:4},{value:"Handling body part",id:"handling-body-part",level:3},{value:"Example of bodyStructure and bodyValues objects",id:"example-of-bodystructure-and-bodyvalues-objects",level:4},{value:".attachments",id:"attachments",level:2},{value:"Description",id:"description",level:4},{value:".bcc",id:"bcc",level:2},{value:"Description",id:"description-1",level:4},{value:".bodyStructure",id:"bodystructure",level:2},{value:"Description",id:"description-2",level:4},{value:".bodyValues",id:"bodyvalues",level:2},{value:"Description",id:"description-3",level:4},{value:".cc",id:"cc",level:2},{value:"Description",id:"description-4",level:4},{value:".comments",id:"comments",level:2},{value:"Description",id:"description-5",level:4},{value:".from",id:"from",level:2},{value:"Description",id:"description-6",level:4},{value:".headers",id:"headers",level:2},{value:"Description",id:"description-7",level:4},{value:".htmlBody",id:"htmlbody",level:2},{value:"Description",id:"description-8",level:4},{value:".id",id:"id",level:2},{value:"Description",id:"description-9",level:4},{value:".inReplyTo",id:"inreplyto",level:2},{value:"Description",id:"description-10",level:4},{value:".keywords",id:"keywords",level:2},{value:"Description",id:"description-11",level:4},{value:"Example",id:"example",level:4},{value:".messageId",id:"messageid",level:2},{value:"Description",id:"description-12",level:4},{value:".receivedAt",id:"receivedat",level:2},{value:"Description",id:"description-13",level:4},{value:".references",id:"references",level:2},{value:"Description",id:"description-14",level:4},{value:".replyTo",id:"replyto",level:2},{value:"Description",id:"description-15",level:4},{value:".sendAt",id:"sendat",level:2},{value:"Description",id:"description-16",level:4},{value:".sender",id:"sender",level:2},{value:"Description",id:"description-17",level:4},{value:".size",id:"size",level:2},{value:"Description",id:"description-18",level:4},{value:".subject",id:"subject",level:2},{value:"Description",id:"description-19",level:4},{value:".stringBody",id:"stringbody",level:2},{value:"Description",id:"description-20",level:4},{value:".to",id:"to",level:2},{value:"Description",id:"description-21",level:4}],d={toc:s};function m(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Creating, sending or receiving emails in Qodly is done by handling an ",(0,r.kt)("inlineCode",{parentName:"p"},"Email")," object."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Email")," objects are created when receiving mails through a ",(0,r.kt)("em",{parentName:"p"},"transporter")," class function:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"IMAP - ",(0,r.kt)("a",{parentName:"li",href:"/docs/language/IMAPTransporterClass#getmail"},(0,r.kt)("inlineCode",{parentName:"a"},".getMail()"))," and ",(0,r.kt)("a",{parentName:"li",href:"/docs/language/IMAPTransporterClass#getmails"},(0,r.kt)("inlineCode",{parentName:"a"},".getMails()"))," functions to get emails from an IMAP server"),(0,r.kt)("li",{parentName:"ul"},"POP3 - ",(0,r.kt)("inlineCode",{parentName:"li"},".getMail()")," function to get an email from a POP3 server.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"You can also create a new, blank ",(0,r.kt)("inlineCode",{parentName:"p"},"Email")," object by calling the ",(0,r.kt)("inlineCode",{parentName:"p"},"New object")," command, and then fill it with ",(0,r.kt)("a",{parentName:"p",href:"#email-object"},"Email object properties"),".")),(0,r.kt)("p",null,"You send ",(0,r.kt)("inlineCode",{parentName:"p"},"Email")," objects using the SMTP ",(0,r.kt)("inlineCode",{parentName:"p"},".send()")," function."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/docs/language/commands/mailConvertFromMIME"},(0,r.kt)("inlineCode",{parentName:"a"},"mailConvertFromMIME"))," and ",(0,r.kt)("a",{parentName:"p",href:"/docs/language/commands/mailConvertToMIME"},(0,r.kt)("inlineCode",{parentName:"a"},"mailConvertToMIME"))," commands can be used to convert ",(0,r.kt)("inlineCode",{parentName:"p"},"Email")," objects to and from MIME contents."),(0,r.kt)("h3",{id:"properties"},"Properties"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Email")," objects provide the following properties:"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"QodlyScript follows the ",(0,r.kt)("a",{parentName:"p",href:"https://jmap.io/spec-mail.html"},"JMAP specification")," to format the ",(0,r.kt)("inlineCode",{parentName:"p"},"Email")," object.")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#attachments"},(0,r.kt)("strong",{parentName:"a"},".attachments")," : collection"),"\xa0","\xa0","\xa0","\xa0","collection of ",(0,r.kt)("inlineCode",{parentName:"td"},"4D.MailAttachment")," object(s)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#bcc"},(0,r.kt)("strong",{parentName:"a"},".bcc")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".bcc")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".bcc")," : collection"),"\xa0","\xa0","\xa0","\xa0","Blind Carbon Copy (BCC) hidden email recipient ",(0,r.kt)("a",{parentName:"td",href:"#email-addresses"},"addresse(s)")," of the email")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#bodystructure"},(0,r.kt)("strong",{parentName:"a"},".bodyStructure")," : object"),"\xa0","\xa0","\xa0","\xa0",(0,r.kt)("em",{parentName:"td"},"EmailBodyPart")," object, i.e. the full MIME structure of the message body (optional)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#bodyvalues"},(0,r.kt)("strong",{parentName:"a"},".bodyValues")," : object"),"\xa0","\xa0","\xa0","\xa0",(0,r.kt)("em",{parentName:"td"},"EmailBodyValue")," object, containing an object for each ",(0,r.kt)("em",{parentName:"td"},"partID")," of ",(0,r.kt)("inlineCode",{parentName:"td"},"bodyStructure")," (optional)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#cc"},(0,r.kt)("strong",{parentName:"a"},".cc")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".cc")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".cc")," : collection"),"\xa0","\xa0","\xa0","\xa0","Carbon Copy (CC) additional email recipient ",(0,r.kt)("a",{parentName:"td",href:"#email-addresses"},"addresse(s)")," of the email")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#comments"},(0,r.kt)("strong",{parentName:"a"},".comments")," : string"),"\xa0","\xa0","\xa0","\xa0","additional comments header")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#from"},(0,r.kt)("strong",{parentName:"a"},".from")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".from")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".from")," : collection"),"\xa0","\xa0","\xa0","\xa0","originating ",(0,r.kt)("a",{parentName:"td",href:"#email-addresses"},"address(es)")," of the email")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#headers"},(0,r.kt)("strong",{parentName:"a"},".headers")," : collection"),"\xa0","\xa0","\xa0","\xa0","collection of ",(0,r.kt)("inlineCode",{parentName:"td"},"EmailHeader")," objects, in the order they appear in the message")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#htmlbody"},(0,r.kt)("strong",{parentName:"a"},".htmlBody")," : string"),"\xa0","\xa0","\xa0","\xa0","HTML representation of the email message (default charset is UTF-8) (optional, SMTP only)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#id"},(0,r.kt)("strong",{parentName:"a"},".id")," : string"),"\xa0","\xa0","\xa0","\xa0","unique ID from the IMAP server")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#inreplyto"},(0,r.kt)("strong",{parentName:"a"},".inReplyTo")," : string"),"\xa0","\xa0","\xa0","\xa0","message identifier(s) of the original message(s) to which the current message is a reply")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#keywords"},(0,r.kt)("strong",{parentName:"a"},".keywords")," : object"),"\xa0","\xa0","\xa0","\xa0","set of keywords as an object, where each property name is a keyword and each value is true")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#messageid"},(0,r.kt)("strong",{parentName:"a"},".messageId")," : string"),"\xa0","\xa0","\xa0","\xa0",'message identifier header ("message-id")')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#receivedat"},(0,r.kt)("strong",{parentName:"a"},".receivedAt")," : string"),"\xa0","\xa0","\xa0","\xa0","timestamp of the email's arrival on the IMAP server in ISO 8601 UTC format (ex: 2020-09-13T16:11:53Z)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#references"},(0,r.kt)("strong",{parentName:"a"},".references")," : collection"),"\xa0","\xa0","\xa0","\xa0","collection of all message-ids of messages in the preceding reply chain")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#replyto"},(0,r.kt)("strong",{parentName:"a"},".replyTo")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".replyTo")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".replyTo")," : collection"),"\xa0","\xa0","\xa0","\xa0",(0,r.kt)("a",{parentName:"td",href:"#email-addresses"},"addresse(s)")," for responses")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#sendat"},(0,r.kt)("strong",{parentName:"a"},".sendAt")," : string"),"\xa0","\xa0","\xa0","\xa0","Email timestamp in ISO 8601 UTC format")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#sender"},(0,r.kt)("strong",{parentName:"a"},".sender")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".sender")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".sender")," : collection"),"\xa0","\xa0","\xa0","\xa0","email source ",(0,r.kt)("a",{parentName:"td",href:"#email-addresses"},"addresse(s)")," of the email")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#size"},(0,r.kt)("strong",{parentName:"a"},".size")," : integer"),"\xa0","\xa0","\xa0","\xa0","size (expressed in bytes) of the Email object returned by the IMAP server")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#subject"},(0,r.kt)("strong",{parentName:"a"},".subject")," : string"),"\xa0","\xa0","\xa0","\xa0","description of topic")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#stringbody"},(0,r.kt)("strong",{parentName:"a"},".stringBody")," : string"),"\xa0","\xa0","\xa0","\xa0","Plain string representation of the email message (default charset is UTF-8) (optional, SMTP only)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#to"},(0,r.kt)("strong",{parentName:"a"},".to")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".to")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"a"},".to")," : collection"),"\xa0","\xa0","\xa0","\xa0","primary recipient ",(0,r.kt)("a",{parentName:"td",href:"#email-addresses"},"addresse(s)")," of the email")))),(0,r.kt)("h3",{id:"email-addresses"},"Email Addresses"),(0,r.kt)("p",null,"All properties that contain email addresses (",(0,r.kt)("a",{parentName:"p",href:"#from"},(0,r.kt)("inlineCode",{parentName:"a"},"from")),", ",(0,r.kt)("a",{parentName:"p",href:"#cc"},(0,r.kt)("inlineCode",{parentName:"a"},"cc")),", ",(0,r.kt)("a",{parentName:"p",href:"#bcc"},(0,r.kt)("inlineCode",{parentName:"a"},"bcc")),", ",(0,r.kt)("a",{parentName:"p",href:"#to"},(0,r.kt)("inlineCode",{parentName:"a"},"to")),", ",(0,r.kt)("a",{parentName:"p",href:"#sender"},(0,r.kt)("inlineCode",{parentName:"a"},"sender")),", ",(0,r.kt)("a",{parentName:"p",href:"#replyto"},(0,r.kt)("inlineCode",{parentName:"a"},"replyTo")),") accept a value of string, object, or collection type."),(0,r.kt)("h4",{id:"string"},"String"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'single email: "',(0,r.kt)("a",{parentName:"li",href:"mailto:somebody@domain.com"},"somebody@domain.com"),'"'),(0,r.kt)("li",{parentName:"ul"},'single display name+email: "Somebody ',(0,r.kt)("a",{parentName:"li",href:"mailto:somebody@domain.com"},"somebody@domain.com"),'"'),(0,r.kt)("li",{parentName:"ul"},'several emails: "Somebody ',(0,r.kt)("a",{parentName:"li",href:"mailto:somebody@domain.com"},"somebody@domain.com"),",",(0,r.kt)("a",{parentName:"li",href:"mailto:me@home.org"},"me@home.org"),'"')),(0,r.kt)("h4",{id:"object"},"object"),(0,r.kt)("p",null,"An object with two properties:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"name"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Display name (can be null)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"email"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Email address")))),(0,r.kt)("h4",{id:"collection"},"collection"),(0,r.kt)("p",null,"A collection of address objects."),(0,r.kt)("h3",{id:"handling-body-part"},"Handling body part"),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"#stringbody"},(0,r.kt)("inlineCode",{parentName:"a"},"stringBody"))," and ",(0,r.kt)("a",{parentName:"p",href:"#htmlbody"},(0,r.kt)("inlineCode",{parentName:"a"},"htmlBody"))," properties are only used with the ",(0,r.kt)("inlineCode",{parentName:"p"},"SMTP.send()")," function to allow sending simple mails. When both property are filled, the MIME content-type multipart/alternative is used. The email client should then recognize the multipart/alternative part and display the string part or html part as necessary."),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"#bodystructure"},(0,r.kt)("inlineCode",{parentName:"a"},"bodyStructure"))," and ",(0,r.kt)("a",{parentName:"p",href:"#bodyvalues"},(0,r.kt)("inlineCode",{parentName:"a"},"bodyValues"))," are used for ",(0,r.kt)("inlineCode",{parentName:"p"},"SMTP")," when the ",(0,r.kt)("a",{parentName:"p",href:"#email-object"},"Email object")," is built from a MIME document, e.g. when generated by the ",(0,r.kt)("inlineCode",{parentName:"p"},"MAIL Convert from MIME")," command. In this case, both ",(0,r.kt)("inlineCode",{parentName:"p"},"bodyStructure")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"bodyValues")," properties must be passed together, and it is not recommended to use ",(0,r.kt)("inlineCode",{parentName:"p"},"stringBody")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"htmlBody"),"."),(0,r.kt)("h4",{id:"example-of-bodystructure-and-bodyvalues-objects"},"Example of bodyStructure and bodyValues objects"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'"bodyStructure": {\n  "type": "multipart/mixed",\n  "subParts": [\n    {\n      "partId": "p0001",\n      "type": "string/plain"\n    },\n    {\n      "partId": "p0002",\n      "type": "string/html"\n    }\n  ]\n},\n"bodyValues": {\n  "p0001": {\n    "value": "I have the most brilliant plan. Let me tell you all about it."\n  },\n  "p0002": {\n    "value": "<!DOCTYPE html><html><head><title></title><style type = \\"string/css\\">div{font-size:16px}</style></head><body><div>I have the most brilliant plan. Let me tell you all about it.</div></body></html>"\n  }\n}\n')),(0,r.kt)("h2",{id:"attachments"},".attachments"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".attachments")," : collection"),(0,r.kt)("h4",{id:"description"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".attachments")," property contains a collection of ",(0,r.kt)("inlineCode",{parentName:"p"},"4D.MailAttachment")," object(s)."),(0,r.kt)("p",null,"Attachment objects are defined through the ",(0,r.kt)("a",{parentName:"p",href:"/docs/language/MailAttachmentClass#mailnewattachment"},(0,r.kt)("inlineCode",{parentName:"a"},"mailNewAttachment"))," command. Attachment objects have specific ",(0,r.kt)("a",{parentName:"p",href:"/docs/language/MailAttachmentClass"},"properties and functions"),"."),(0,r.kt)("h2",{id:"bcc"},".bcc"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".bcc")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".bcc")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".bcc")," : collection"),(0,r.kt)("h4",{id:"description-1"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".bcc")," property contains the Blind Carbon Copy (BCC) hidden email recipient ",(0,r.kt)("a",{parentName:"p",href:"#email-addresses"},"addresse(s)")," of the email."),(0,r.kt)("h2",{id:"bodystructure"},".bodyStructure"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".bodyStructure")," : object"),(0,r.kt)("h4",{id:"description-2"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".bodyStructure")," property contains the ",(0,r.kt)("em",{parentName:"p"},"EmailBodyPart")," object, i.e. the full MIME structure of the message body (optional). See ",(0,r.kt)("a",{parentName:"p",href:"#handling-body-part"},"Handling body part")," section."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".bodyStructure")," object contains the following properties:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"partID"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Identifies the part uniquely within the email")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"type"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"(mandatory) Value of the Content-Type header field of the part")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"charset"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Value of the charset parameter of the Content-Type header field")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"encoding"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"If ",(0,r.kt)("inlineCode",{parentName:"td"},"isEncodingProblem == true"),", the Content-Transfer-Encoding value is added (by default undefined)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"disposition"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Value of the Content-Disposition header field of the part")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"language"),(0,r.kt)("td",{parentName:"tr",align:null},"collection of strings"),(0,r.kt)("td",{parentName:"tr",align:null},"List of language tags, as defined in ",(0,r.kt)("a",{parentName:"td",href:"https://tools.ietf.org/html/rfc3282"},"RFC3282"),", in the Content-Language header field of the part, if present.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"location"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"URI, as defined in ",(0,r.kt)("a",{parentName:"td",href:"https://tools.ietf.org/html/rfc2557"},"RFC2557"),", in the Content-Location header field of the part, if present.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"subParts"),(0,r.kt)("td",{parentName:"tr",align:null},"collection of objects"),(0,r.kt)("td",{parentName:"tr",align:null},"Body parts of each child (collection of ",(0,r.kt)("em",{parentName:"td"},"EmailBodyPart")," objects)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"headers"),(0,r.kt)("td",{parentName:"tr",align:null},"collection of objects"),(0,r.kt)("td",{parentName:"tr",align:null},"List of all header fields in the part, in the order they appear in the message (collection of ",(0,r.kt)("em",{parentName:"td"},"EmailHeader")," objects, see ",(0,r.kt)("a",{parentName:"td",href:"#headers-"},"headers")," property)")))),(0,r.kt)("h2",{id:"bodyvalues"},".bodyValues"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".bodyValues")," : object"),(0,r.kt)("h4",{id:"description-3"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".bodyValues")," property contains the ",(0,r.kt)("em",{parentName:"p"},"EmailBodyValue")," object, containing an object for each ",(0,r.kt)("em",{parentName:"p"},"partID")," of ",(0,r.kt)("inlineCode",{parentName:"p"},"bodyStructure")," (optional). See ",(0,r.kt)("a",{parentName:"p",href:"#handling-body-part"},"Handling body part")," section."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".bodyValues")," object contains the following properties:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"td"},"partID"),".value"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Value of the body part")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"td"},"partID"),".isEncodingProblem"),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"True if malformed sections are found while decoding the charset, or unknown charset, or unknown content transfer-encoding. False by default")))),(0,r.kt)("h2",{id:"cc"},".cc"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".cc")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".cc")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".cc")," : collection"),(0,r.kt)("h4",{id:"description-4"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".cc")," property contains the Carbon Copy (CC) additional email recipient ",(0,r.kt)("a",{parentName:"p",href:"#email-addresses"},"addresse(s)")," of the email."),(0,r.kt)("h2",{id:"comments"},".comments"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".comments")," : string"),(0,r.kt)("h4",{id:"description-5"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".comments")," property contains an additional comments header."),(0,r.kt)("p",null,"Comments only appear within the header section of the message (keeping the message's body untouched)."),(0,r.kt)("p",null,"For specific formatting requirements, please consult the ",(0,r.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc5322"},"RFC#5322"),"."),(0,r.kt)("h2",{id:"from"},".from"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".from")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".from")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".from")," : collection"),(0,r.kt)("h4",{id:"description-6"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".from")," property contains the originating ",(0,r.kt)("a",{parentName:"p",href:"#email-addresses"},"address(es)")," of the email."),(0,r.kt)("p",null,"Each email you send out has both the ",(0,r.kt)("a",{parentName:"p",href:"#sender"},"sender")," and ",(0,r.kt)("strong",{parentName:"p"},"from")," addresses:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"the sender domain is what the receiving email server gets when opening the session,"),(0,r.kt)("li",{parentName:"ul"},"the from address is what the recipient(s) will see.")),(0,r.kt)("p",null,"For better deliverability, it is recommended to use the same from and sender addresses."),(0,r.kt)("h2",{id:"headers"},".headers"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".headers")," : collection"),(0,r.kt)("h4",{id:"description-7"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".headers")," property contains a collection of ",(0,r.kt)("inlineCode",{parentName:"p"},"EmailHeader"),' objects, in the order they appear in the message. This property allows users to add extended (registered) headers or user-defined (not registered, starting with "X") headers.'),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"If an ",(0,r.kt)("inlineCode",{parentName:"p"},"EmailHeader"),' object property defines a header such as "from" or "cc" which is already set as a property at the mail level, the ',(0,r.kt)("inlineCode",{parentName:"p"},"EmailHeader")," property is ignored.")),(0,r.kt)("p",null,"Every object of the headers collection can contain the following properties:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"[].name"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"(mandatory) Header field name as defined in ",(0,r.kt)("a",{parentName:"td",href:"https://tools.ietf.org/html/rfc5322"},"RFC#5322"),". If null or undefined, the header field is not added to the MIME header.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"[].value"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Header field values as defined in ",(0,r.kt)("a",{parentName:"td",href:"https://tools.ietf.org/html/rfc5322"},"RFC#5322"))))),(0,r.kt)("h2",{id:"htmlbody"},".htmlBody"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".htmlBody")," : string"),(0,r.kt)("h4",{id:"description-8"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".htmlBody")," property contains the HTML representation of the email message (default charset is UTF-8) (optional, SMTP only). See ",(0,r.kt)("a",{parentName:"p",href:"#handling-body-part"},"Handling body part")," section."),(0,r.kt)("h2",{id:"id"},".id"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".id")," : string"),(0,r.kt)("h4",{id:"description-9"},"Description"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/docs/language/IMAPTransporterClass"},"IMAP transporter")," only."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".id")," property contains the unique ID from the IMAP server."),(0,r.kt)("h2",{id:"inreplyto"},".inReplyTo"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".inReplyTo")," : string"),(0,r.kt)("h4",{id:"description-10"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".inReplyTo")," property contains the message identifier(s) of the original message(s) to which the current message is a reply."),(0,r.kt)("p",null,"For specific formatting requirements, please consult the ",(0,r.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc5322"},"RFC#5322"),"."),(0,r.kt)("h2",{id:"keywords"},".keywords"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".keywords")," : object"),(0,r.kt)("h4",{id:"description-11"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".keywords")," property contains a set of keywords as an object, where each property name is a keyword and each value is true."),(0,r.kt)("p",null,'This property is the "keywords" header (see ',(0,r.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc4021"},"RFC#4021"),")."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".",(0,r.kt)("em",{parentName:"td"},"keyword")),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"Keyword to set (value must be true)")))),(0,r.kt)("p",null,"Reserved keywords:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"draft - Indicates a message is a draft"),(0,r.kt)("li",{parentName:"ul"},"seen - Indicates a message has been read"),(0,r.kt)("li",{parentName:"ul"},"flagged - Indicates a message needs special attention (e.g., Urgent)"),(0,r.kt)("li",{parentName:"ul"},"answered - Indicates a message has been replied to"),(0,r.kt)("li",{parentName:"ul"},"deleted - Indicates a message to delete")),(0,r.kt)("h4",{id:"example"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},' mail.keywords["flagged"] = True\n mail.keywords["qodly"] = True\n')),(0,r.kt)("h2",{id:"messageid"},".messageId"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".messageId")," : string"),(0,r.kt)("h4",{id:"description-12"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".messageId"),' property contains a message identifier header ("message-id").'),(0,r.kt)("p",null,'This header is usually "lettersOrNumbers@domainname", e.g. "',(0,r.kt)("a",{parentName:"p",href:"mailto:abcdef.123456@4d.com"},"abcdef.123456@4d.com"),'". This unique ID is used in particular on forums or public mailing lists. In general, mail servers automatically add this header to the messages they send.'),(0,r.kt)("h2",{id:"receivedat"},".receivedAt"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".receivedAt")," : string"),(0,r.kt)("h4",{id:"description-13"},"Description"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/docs/language/IMAPTransporterClass"},"IMAP transporter")," only."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".receivedAt")," property contains the timestamp of the email's arrival on the IMAP server in ISO 8601 UTC format (ex: 2020-09-13T16:11:53Z)."),(0,r.kt)("h2",{id:"references"},".references"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".references")," : collection"),(0,r.kt)("h4",{id:"description-14"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".references")," property contains the collection of all message-ids of messages in the preceding reply chain."),(0,r.kt)("p",null,"For specific formatting requirements, please consult the ",(0,r.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc5322"},"RFC#5322"),"."),(0,r.kt)("h2",{id:"replyto"},".replyTo"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".replyTo")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".replyTo")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".replyTo")," : collection"),(0,r.kt)("h4",{id:"description-15"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".replyTo")," property contains the ",(0,r.kt)("a",{parentName:"p",href:"#email-addresses"},"addresse(s)")," for responses."),(0,r.kt)("h2",{id:"sendat"},".sendAt"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".sendAt")," : string"),(0,r.kt)("h4",{id:"description-16"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".sendAt")," property contains the Email timestamp in ISO 8601 UTC format."),(0,r.kt)("h2",{id:"sender"},".sender"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".sender")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".sender")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".sender")," : collection"),(0,r.kt)("h4",{id:"description-17"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".sender")," property contains the email source ",(0,r.kt)("a",{parentName:"p",href:"#email-addresses"},"addresse(s)")," of the email."),(0,r.kt)("p",null,"Each email you send out has both the ",(0,r.kt)("strong",{parentName:"p"},"sender")," and ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"#from"},"from"))," addresses:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"the sender domain is what the receiving email server gets when opening the session,"),(0,r.kt)("li",{parentName:"ul"},"the from address is what the recipient(s) will see.")),(0,r.kt)("p",null,"For better deliverability, it is recommended to use the same from and sender addresses."),(0,r.kt)("h2",{id:"size"},".size"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".size")," : integer"),(0,r.kt)("h4",{id:"description-18"},"Description"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"/docs/language/IMAPTransporterClass"},"IMAP transporter")," only."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".size")," property contains the size (expressed in bytes) of the Email object returned by the IMAP server."),(0,r.kt)("h2",{id:"subject"},".subject"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".subject")," : string"),(0,r.kt)("h4",{id:"description-19"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".subject")," property contains the description of topic."),(0,r.kt)("h2",{id:"stringbody"},".stringBody"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".stringBody")," : string"),(0,r.kt)("h4",{id:"description-20"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".stringBody")," property contains the Plain string representation of the email message (default charset is UTF-8) (optional, SMTP only). See ",(0,r.kt)("a",{parentName:"p",href:"#handling-body-part"},"Handling body part")," section."),(0,r.kt)("h2",{id:"to"},".to"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".to")," : string",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".to")," : object",(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"p"},".to")," : collection"),(0,r.kt)("h4",{id:"description-21"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".to")," property contains the primary recipient ",(0,r.kt)("a",{parentName:"p",href:"#email-addresses"},"addresse(s)")," of the email."))}m.isMDXComponent=!0}}]);