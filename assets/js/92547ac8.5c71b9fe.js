"use strict";(self.webpackChunkqodly=self.webpackChunkqodly||[]).push([["70255"],{43908:function(e,s,n){n.r(s),n.d(s,{metadata:()=>r,contentTitle:()=>d,default:()=>a,assets:()=>c,toc:()=>h,frontMatter:()=>l});var r=JSON.parse('{"id":"language/IMAPTransporterClass","title":"IMAPTransporter","description":"The IMAPTransporter class allows you to retrieve messages from an IMAP email server.","source":"@site/versioned_docs/version-1.1.0/language/IMAPTransporterClass.md","sourceDirName":"language","slug":"/language/IMAPTransporterClass","permalink":"/docs/language/IMAPTransporterClass","draft":false,"unlisted":false,"editUrl":"https://github.com/qodly/docs/issues/new?title=Comment%20on%20language%2FIMAPTransporterClass.md%20(1.1.0)&body=Share%20any%20feedback%20about%20this%20page%20%E2%80%94%20report%20issues%2C%20suggest%20improvements%2C%20or%20tell%20us%20what%E2%80%99s%20helpful.%0A%0AIf%20it%E2%80%99s%20an%20issue%3A%0A-%20What%E2%80%99s%20the%20issue%3F%20(e.g.%2C%20typo%2C%20incorrect%20information%2C%20unclear%20explanation)%0A-%20Where%20is%20it%3F%20(e.g.%2C%20section%20name%2C%20specific%20paragraph%2C%20or%20line)%0A%0AThank%20you%20for%20helping%20us%20improve!%20%F0%9F%9A%80%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20","tags":[],"version":"1.1.0","frontMatter":{"id":"IMAPTransporterClass","title":"IMAPTransporter"},"sidebar":"Develop","previous":{"title":"HTTPRequest","permalink":"/docs/language/HTTPRequestClass"},"next":{"title":"IncomingMessage","permalink":"/docs/language/IncomingMessageClass"}}'),t=n("85893"),i=n("50065");let l={id:"IMAPTransporterClass",title:"IMAPTransporter"},d=void 0,c={},h=[{value:"Functions and properties",id:"functions-and-properties",level:3},{value:"4D.IMAPTransporter.new()",id:"4dimaptransporternew",level:2},{value:"Description",id:"description",level:4},{value:"Result",id:"result",level:4},{value:"Example",id:"example",level:4},{value:".acceptUnsecureConnection",id:"acceptunsecureconnection",level:2},{value:"Description",id:"description-1",level:4},{value:".addFlags()",id:"addflags",level:2},{value:"Description",id:"description-2",level:4},{value:"Example",id:"example-1",level:4},{value:".append()",id:"append",level:2},{value:"Description",id:"description-3",level:4},{value:"Example",id:"example-2",level:4},{value:".authenticationMode",id:"authenticationmode",level:2},{value:"Description",id:"description-4",level:4},{value:".checkConnection()",id:"checkconnection",level:2},{value:"Description",id:"description-5",level:4},{value:"Returned object",id:"returned-object",level:4},{value:".checkConnectionDelay",id:"checkconnectiondelay",level:2},{value:"Description",id:"description-6",level:4},{value:".connectionTimeOut",id:"connectiontimeout",level:2},{value:"Description",id:"description-7",level:4},{value:".copy()",id:"copy",level:2},{value:"Description",id:"description-8",level:4},{value:"Example 1",id:"example-1-1",level:4},{value:"Example 2",id:"example-2-1",level:4},{value:".createBox()",id:"createbox",level:2},{value:"Description",id:"description-9",level:4},{value:"Example",id:"example-3",level:4},{value:".delete()",id:"delete",level:2},{value:"Description",id:"description-10",level:4},{value:"Example 1",id:"example-1-2",level:4},{value:"Example 2",id:"example-2-2",level:4},{value:".deleteBox()",id:"deletebox",level:2},{value:"Description",id:"description-11",level:4},{value:"Example",id:"example-4",level:4},{value:".expunge()",id:"expunge",level:2},{value:"Description",id:"description-12",level:4},{value:"Example",id:"example-5",level:4},{value:".getBoxInfo()",id:"getboxinfo",level:2},{value:"Description",id:"description-13",level:4},{value:"Example",id:"example-6",level:4},{value:".getBoxList()",id:"getboxlist",level:2},{value:"Description",id:"description-14",level:4},{value:"Result",id:"result-1",level:4},{value:"Example",id:"example-7",level:4},{value:".getDelimiter()",id:"getdelimiter",level:2},{value:"Description",id:"description-15",level:4},{value:"Result",id:"result-2",level:4},{value:"Example",id:"example-8",level:4},{value:".getMail()",id:"getmail",level:2},{value:"Description",id:"description-16",level:4},{value:"Result",id:"result-3",level:4},{value:"Example",id:"example-9",level:4},{value:".getMails()",id:"getmails",level:2},{value:"Description",id:"description-17",level:4},{value:"Result",id:"result-4",level:4},{value:"Example",id:"example-10",level:4},{value:".getMIMEAsblob()",id:"getmimeasblob",level:2},{value:"Description",id:"description-18",level:4},{value:"Result",id:"result-5",level:4},{value:"Example",id:"example-11",level:4},{value:".host",id:"host",level:2},{value:"Description",id:"description-19",level:4},{value:".logFile",id:"logfile",level:2},{value:"Description",id:"description-20",level:4},{value:".move()",id:"move",level:2},{value:"Description",id:"description-21",level:4},{value:"Example 1",id:"example-1-3",level:4},{value:"Example 2",id:"example-2-3",level:4},{value:".numToID()",id:"numtoid",level:2},{value:"Description",id:"description-22",level:4},{value:"Result",id:"result-6",level:4},{value:"Example",id:"example-12",level:4},{value:".removeFlags()",id:"removeflags",level:2},{value:"Description",id:"description-23",level:4},{value:"Example",id:"example-13",level:4},{value:".renameBox()",id:"renamebox",level:2},{value:"Description",id:"description-24",level:4},{value:"Example",id:"example-14",level:4},{value:".port",id:"port",level:2},{value:"Description",id:"description-25",level:4},{value:".searchMails()",id:"searchmails",level:2},{value:"Description",id:"description-26",level:4},{value:"Search value types",id:"search-value-types",level:4},{value:"Authorized search-keys",id:"authorized-search-keys",level:4},{value:".selectBox()",id:"selectbox",level:2},{value:"Description",id:"description-27",level:4},{value:"Example",id:"example-15",level:4},{value:".subscribe()",id:"subscribe",level:2},{value:"Description",id:"description-28",level:4},{value:"Example",id:"example-16",level:4},{value:".unsubscribe()",id:"unsubscribe",level:2},{value:"Description",id:"description-29",level:4},{value:"Example",id:"example-17",level:4},{value:".user",id:"user",level:2},{value:"Description",id:"description-30",level:4}];function o(e){let s={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"IMAPTransporter"})," class allows you to retrieve messages from an IMAP email server."]}),"\n",(0,t.jsx)(s.h3,{id:"functions-and-properties",children:"Functions and properties"}),"\n",(0,t.jsx)(s.p,{children:"4D.IMAPTransporter objects provide the following properties and functions:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsx)(s.tr,{children:(0,t.jsx)(s.th,{})})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#4dimaptransporternew",children:[(0,t.jsx)(s.strong,{children:"4D.IMAPTransporter.new"}),"( ",(0,t.jsx)(s.em,{children:"server"})," : object ) : 4D.IMAPTransporter"]}),"\xa0\xa0\xa0\xa0configures a new IMAP connection"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#acceptunsecureconnection",children:[(0,t.jsx)(s.strong,{children:".acceptUnsecureConnection"})," : boolean"]}),"\xa0\xa0\xa0\xa0",(0,t.jsx)(s.strong,{children:"true"})," if Qodly is allowed to establish an unencrypted connection"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#addflags",children:[(0,t.jsx)(s.strong,{children:".addFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : collection , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".addFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : string , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".addFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : integer  , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object"]}),"\xa0\xa0\xa0\xa0adds flags to the ",(0,t.jsx)(s.em,{children:"msgIDs"})," for the specified ",(0,t.jsx)(s.code,{children:"keywords"})]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#append",children:[(0,t.jsx)(s.strong,{children:".append"}),"( ",(0,t.jsx)(s.em,{children:"mailObj"})," : object , ",(0,t.jsx)(s.em,{children:"destinationBox"})," : string , ",(0,t.jsx)(s.em,{children:"options"})," : object ) : object"]}),"\xa0\xa0\xa0\xa0appends a ",(0,t.jsx)(s.code,{children:"mailObj"})," to the ",(0,t.jsx)(s.code,{children:"destinationBox"})]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#authenticationmode",children:[(0,t.jsx)(s.strong,{children:".authenticationMode"})," : string"]}),"\xa0\xa0\xa0\xa0the authentication mode used to open the session on the mail server"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#checkconnection",children:[(0,t.jsx)(s.strong,{children:".checkConnection()"})," : object"]}),"\xa0\xa0\xa0\xa0 checks the connection using information stored in the transporter object"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#checkconnectiondelay",children:[(0,t.jsx)(s.strong,{children:".checkConnectionDelay"})," : integer"]}),"\xa0\xa0\xa0\xa0the maximum time (in seconds) allowed prior to checking the connection to the server"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#connectiontimeout",children:[(0,t.jsx)(s.strong,{children:".connectionTimeOut"})," : integer"]}),"\xa0\xa0\xa0\xa0the maximum wait time (in seconds) allowed to establish a connection to the server"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#copy",children:[(0,t.jsx)(s.strong,{children:".copy"}),"( ",(0,t.jsx)(s.em,{children:"msgsIDs"})," : collection , ",(0,t.jsx)(s.em,{children:"destinationBox"})," : string ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".copy"}),"( ",(0,t.jsx)(s.em,{children:"allMsgs"})," : integer , ",(0,t.jsx)(s.em,{children:"destinationBox"})," : string ) : object"]}),"\xa0\xa0\xa0\xa0copies the messages defined by ",(0,t.jsx)(s.em,{children:"msgsIDs"})," or ",(0,t.jsx)(s.em,{children:"allMsgs"})," to the ",(0,t.jsx)(s.em,{children:"destinationBox"})," on the IMAP server"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#createbox",children:[(0,t.jsx)(s.strong,{children:".createBox"}),"( ",(0,t.jsx)(s.em,{children:"name"})," :  string ) : object"]}),"\xa0\xa0\xa0\xa0creates a mailbox with the given ",(0,t.jsx)(s.code,{children:"name"})]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#delete",children:[(0,t.jsx)(s.strong,{children:".delete"}),"( ",(0,t.jsx)(s.em,{children:"msgsIDs"})," : collection ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".delete"}),"( ",(0,t.jsx)(s.em,{children:"msgsIDs"})," : integer ) : object"]}),'\xa0\xa0\xa0\xa0sets the "deleted" flag for the messages defined in ',(0,t.jsx)(s.em,{children:"msgsIDs"})]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#deletebox",children:[(0,t.jsx)(s.strong,{children:".deleteBox"}),"( ",(0,t.jsx)(s.em,{children:"name"})," : string ) : object"]}),"\xa0\xa0\xa0\xa0permanently removes the mailbox with the given ",(0,t.jsx)(s.em,{children:"name"})," from the IMAP server"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#expunge",children:[(0,t.jsx)(s.strong,{children:".expunge"}),"() : object"]}),'\xa0\xa0\xa0\xa0removes all messages with the "deleted" flag from the IMAP mail server.']})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#getboxinfo",children:[(0,t.jsx)(s.strong,{children:".getBoxInfo"}),"({ ",(0,t.jsx)(s.em,{children:"name"})," : string }) : object"]}),"\xa0\xa0\xa0\xa0returns a ",(0,t.jsx)(s.code,{children:"boxInfo"})," object corresponding to the current maibox, or the mailbox ",(0,t.jsx)(s.em,{children:"name"})]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#getboxlist",children:[(0,t.jsx)(s.strong,{children:".getBoxList"}),"( { ",(0,t.jsx)(s.em,{children:"parameters"})," : object } ) : collection"]}),"\xa0\xa0\xa0\xa0returns a collection of mailboxes describing all of the available mailboxes"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#getdelimiter",children:[(0,t.jsx)(s.strong,{children:".getDelimiter"}),"() : string"]}),"\xa0\xa0\xa0\xa0returns the character used to delimit levels of hierarchy in the mailbox name"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#getmail",children:[(0,t.jsx)(s.strong,{children:".getMail"}),"( ",(0,t.jsx)(s.em,{children:"msgNumber"}),": integer { , ",(0,t.jsx)(s.em,{children:"options"})," : object } ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".getMail"}),"( ",(0,t.jsx)(s.em,{children:"msgID"}),": string { , ",(0,t.jsx)(s.em,{children:"options"})," : object } ) : object"]}),"\xa0\xa0\xa0\xa0returns the ",(0,t.jsx)(s.code,{children:"Email"})," object corresponding to the ",(0,t.jsx)(s.em,{children:"msgNumber"})," or ",(0,t.jsx)(s.em,{children:"msgID"})," in the mailbox designated by the ",(0,t.jsx)(s.code,{children:"IMAP transporter"})," object"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#getmails",children:[(0,t.jsx)(s.strong,{children:".getMails"}),"( ",(0,t.jsx)(s.em,{children:"ids"})," : collection { , ",(0,t.jsx)(s.em,{children:"options"})," : object } ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".getMails"}),"( ",(0,t.jsx)(s.em,{children:"startMsg"})," : integer , ",(0,t.jsx)(s.em,{children:"endMsg"})," : integer { , ",(0,t.jsx)(s.em,{children:"options"})," : object } ) : object"]}),"\xa0\xa0\xa0\xa0returns an object containing a collection of ",(0,t.jsx)(s.code,{children:"Email"})," objects"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#getmimeasblob",children:[(0,t.jsx)(s.strong,{children:".getMIMEAsblob"}),"( ",(0,t.jsx)(s.em,{children:"msgNumber"})," : integer { , ",(0,t.jsx)(s.em,{children:"updateSeen"})," : boolean } ) : blob",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".getMIMEAsblob"}),"( ",(0,t.jsx)(s.em,{children:"msgID"})," : string { , ",(0,t.jsx)(s.em,{children:"updateSeen"})," : boolean } ) : blob"]}),"\xa0\xa0\xa0\xa0returns a BLOB containing the MIME contents for the message corresponding to the ",(0,t.jsx)(s.em,{children:"msgNumber"})," or ",(0,t.jsx)(s.em,{children:"msgID"})," in the mailbox designated by the ",(0,t.jsx)(s.code,{children:"IMAP_transporter"})]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#host",children:[(0,t.jsx)(s.strong,{children:".host"})," : string"]}),"\xa0\xa0\xa0\xa0the name or the IP address of the host server"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#logfile",children:[(0,t.jsx)(s.strong,{children:".logFile"})," : string"]}),"\xa0\xa0\xa0\xa0the path of the extended log file defined (if any) for the mail connection"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#move",children:[(0,t.jsx)(s.strong,{children:".move"}),"( ",(0,t.jsx)(s.em,{children:"msgsIDs"})," : collection , ",(0,t.jsx)(s.em,{children:"destinationBox"})," : string ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".move"}),"( ",(0,t.jsx)(s.em,{children:"allMsgs"})," : integer , ",(0,t.jsx)(s.em,{children:"destinationBox"})," : string ) : object"]}),"\xa0\xa0\xa0\xa0moves the messages defined by ",(0,t.jsx)(s.em,{children:"msgsIDs"})," or ",(0,t.jsx)(s.em,{children:"allMsgs"})," to the ",(0,t.jsx)(s.em,{children:"destinationBox"})," on the IMAP server"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#numtoid",children:[(0,t.jsx)(s.strong,{children:".numToID"}),"( ",(0,t.jsx)(s.em,{children:"startMsg"})," : integer , ",(0,t.jsx)(s.em,{children:"endMsg"})," : integer ) : collection"]}),"\xa0\xa0\xa0\xa0converts the sequence numbers to IMAP unique IDs for the messages in the sequential range designated by ",(0,t.jsx)(s.em,{children:"startMsg"})," and ",(0,t.jsx)(s.em,{children:"endMsg"})]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#removeflags",children:[(0,t.jsx)(s.strong,{children:".removeFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : collection , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".removeFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : string , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".removeFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : integer , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object"]}),"\xa0\xa0\xa0\xa0removes flags from the ",(0,t.jsx)(s.em,{children:"msgIDs"})," for the specified ",(0,t.jsx)(s.code,{children:"keywords"})]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#renamebox",children:[(0,t.jsx)(s.strong,{children:".renameBox"}),"( ",(0,t.jsx)(s.em,{children:"currentName"})," : string , ",(0,t.jsx)(s.em,{children:"newName"})," : string ) : object"]}),"\xa0\xa0\xa0\xa0changes the name of a mailbox on the IMAP server"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#port",children:[(0,t.jsx)(s.strong,{children:".port"})," : integer"]}),"\xa0\xa0\xa0\xa0 the port number used for mail transactions"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#searchmails",children:[(0,t.jsx)(s.strong,{children:".searchMails"}),"( ",(0,t.jsx)(s.em,{children:"searchCriteria"})," : string ) : collection"]}),"\xa0\xa0\xa0\xa0searches for messages that match the given ",(0,t.jsx)(s.em,{children:"searchCriteria"})," in the current mailbox"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#selectbox",children:[(0,t.jsx)(s.strong,{children:".selectBox"}),"( ",(0,t.jsx)(s.em,{children:"name"})," : string { , ",(0,t.jsx)(s.em,{children:"state"})," : integer } ) : object"]}),"\xa0\xa0\xa0\xa0selects the ",(0,t.jsx)(s.em,{children:"name"})," mailbox as the current mailbox"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#subscribe",children:[(0,t.jsx)(s.strong,{children:".subscribe"}),"( ",(0,t.jsx)(s.em,{children:"name"})," : string ) : object"]}),"\xa0\xa0\xa0\xa0allows adding or removing of the specified mailbox to/from the IMAP server\u2019s set of \u201Csubscribed\u201D mailboxes"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#unsubscribe",children:[(0,t.jsx)(s.strong,{children:".unsubscribe"}),"( ",(0,t.jsx)(s.em,{children:"name"})," : string ) : object"]}),"\xa0\xa0\xa0\xa0removes a mailbox from a set of subscribed mailboxes"]})}),(0,t.jsx)(s.tr,{children:(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#user",children:[(0,t.jsx)(s.strong,{children:".user"})," : string"]}),"\xa0\xa0\xa0\xa0 the user name used for authentication on the mail server"]})})]})]}),"\n",(0,t.jsx)(s.h2,{id:"4dimaptransporternew",children:"4D.IMAPTransporter.new()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"4D.IMAPTransporter.new"}),"( ",(0,t.jsx)(s.em,{children:"server"})," : object ) : 4D.IMAPTransporter"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"server"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Mail server information"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"4D.IMAPTransporter"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"IMAP transporter object"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"4D.IMAPTransporter.new()"})," function configures a new IMAP connection according to the ",(0,t.jsx)(s.em,{children:"server"})," parameter and returns a new ",(0,t.jsx)(s.em,{children:"transporter"})," object. The returned transporter object will then usually be used to receive emails."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"server"})," parameter, pass an object containing the following properties:"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:(0,t.jsx)(s.em,{children:"server"})}),(0,t.jsx)(s.th,{children:"Default value (if omitted)"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#acceptunsecureconnection",children:[(0,t.jsx)(s.strong,{children:".acceptUnsecureConnection"})," : boolean"]}),(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:"true"})," if Qodly is allowed to establish an unencrypted connection"]}),(0,t.jsx)(s.td,{children:"False"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[".",(0,t.jsx)(s.strong,{children:"accessTokenOAuth2"}),": string",(0,t.jsx)("br",{}),".",(0,t.jsx)(s.strong,{children:"accessTokenOAuth2"}),": object",(0,t.jsx)("br",{}),"string string or token object representing OAuth2 authorization credentials. Used only with OAUTH2 ",(0,t.jsx)(s.code,{children:"authenticationMode"}),". If ",(0,t.jsx)(s.code,{children:"accessTokenOAuth2"})," is used but ",(0,t.jsx)(s.code,{children:"authenticationMode"})," is omitted, the OAuth 2 protocol is used (if allowed by the server). Not returned in the ",(0,t.jsx)(s.code,{children:"IMAP transporter"})," object."]}),(0,t.jsx)(s.td,{children:"none"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#authenticationmode",children:[(0,t.jsx)(s.strong,{children:".authenticationMode"})," : string"]})," - the authentication mode used to open the session on the mail server"]}),(0,t.jsx)(s.td,{children:"the most secure authentication mode supported by the server is used"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#checkconnectiondelay",children:[(0,t.jsx)(s.strong,{children:".checkConnectionDelay"})," : integer"]})," - the maximum time (in seconds) allowed prior to checking the connection to the server"]}),(0,t.jsx)(s.td,{children:"300"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#connectiontimeout",children:[(0,t.jsx)(s.strong,{children:".connectionTimeOut"})," : integer"]})," - the maximum wait time (in seconds) allowed to establish a connection to the server"]}),(0,t.jsx)(s.td,{children:"30"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#host",children:[(0,t.jsx)(s.strong,{children:".host"})," : string"]})," - the name or the IP address of the host server"]}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.em,{children:"mandatory"})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#logfile",children:[(0,t.jsx)(s.strong,{children:".logFile"})," : string"]})," - the path of the extended log file defined (if any) for the mail connection"]}),(0,t.jsx)(s.td,{children:"none"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[".",(0,t.jsx)(s.strong,{children:"password"})," : string",(0,t.jsx)("br",{}),"User password for authentication on the server. Not returned in the ",(0,t.jsx)(s.code,{children:"IMAP transporter"})," object."]}),(0,t.jsx)(s.td,{children:"none"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#port",children:[(0,t.jsx)(s.strong,{children:".port"})," : integer"]})," -  the port number used for mail transactions"]}),(0,t.jsx)(s.td,{children:"993"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsxs)(s.a,{href:"#user",children:[(0,t.jsx)(s.strong,{children:".user"})," : string"]})," -  the user name used for authentication on the mail server"]}),(0,t.jsx)(s.td,{children:"none"})]})]})]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Warning"}),": Make sure the defined timeout is lower than the server timeout, otherwise the client timeout will be useless."]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"result",children:"Result"}),"\n",(0,t.jsxs)(s.p,{children:["The function returns an ",(0,t.jsx)(s.strong,{children:"IMAP transporter object"}),". All returned properties are ",(0,t.jsx)(s.strong,{children:"read-only"}),"."]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"The IMAP connection is automatically closed when the transporter object is destroyed."}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"example",children:"Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:'var server : object\nvar transporter : 4D.IMAPTransporter\nvar status : object\nvar info : string\n\nserver = newObject()\nserver.host = "imap.gmail.com" //Mandatory\nserver.port = 993\nserver.user = "qodly@gmail.com"\nserver.password = "XXXXXXXX"\nserver.logFile = "LogTest.txt" //log to save in the Logs folder\n\ntransporter = 4D.IMAPTransporter.new(server)\n\nstatus = transporter.checkConnection()\nif(not(status.success))\n   info = "An error occurred: "+status.statusText\nend\n'})}),"\n",(0,t.jsx)(s.h2,{id:"acceptunsecureconnection",children:".acceptUnsecureConnection"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".acceptUnsecureConnection"})," : boolean"]}),"\n",(0,t.jsx)(s.h4,{id:"description-1",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".acceptUnsecureConnection"})," property contains ",(0,t.jsx)(s.strong,{children:"true"})," if Qodly is allowed to establish an unencrypted connection when encrypted connection is not possible."]}),"\n",(0,t.jsxs)(s.p,{children:["It contains ",(0,t.jsx)(s.strong,{children:"false"})," if unencrypted connections are unallowed, in which case an error in returned when encrypted connection is not possible."]}),"\n",(0,t.jsx)(s.p,{children:"Available secured ports are:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"SMTP"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"465: SMTPS"}),"\n",(0,t.jsx)(s.li,{children:"587 or 25: SMTP with STARTTLS upgrade if supported by the server."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"IMAP"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"143: IMAP non-encrypted port"}),"\n",(0,t.jsx)(s.li,{children:"993: IMAP with STARTTLS upgrade if supported by the server"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"POP3"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"110: POP3 non-encrypted port"}),"\n",(0,t.jsx)(s.li,{children:"995: POP3 with STARTTLS upgrade if supported by the server."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"addflags",children:".addFlags()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".addFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : collection , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".addFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : string , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".addFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : integer  , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgIDs"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Collection of strings: Message unique IDs (string)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgIDs"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"Unique ID of a message"}),(0,t.jsx)(s.td,{})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgIDs"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"kIMAPAll: All messages in the selected mailbox"}),(0,t.jsx)(s.td,{})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"keywords"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Keyword flags to add"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the addFlags operation"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-2",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".addFlags()"})," function adds flags to the ",(0,t.jsx)(s.em,{children:"msgIDs"})," for the specified ",(0,t.jsx)(s.code,{children:"keywords"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"msgIDs"})," parameter, you can pass either:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["a ",(0,t.jsx)(s.em,{children:"collection"})," containing the unique IDs of specific messages or"]}),"\n",(0,t.jsxs)(s.li,{children:["the unique ID (",(0,t.jsx)(s.em,{children:"string"}),") of a single message or"]}),"\n",(0,t.jsxs)(s.li,{children:["the following constant (",(0,t.jsx)(s.em,{children:"integer"}),") for all messages in the selected mailbox:"]}),"\n"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Constant"}),(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Comment"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"kIMAPAll"}),(0,t.jsx)(s.td,{children:"1"}),(0,t.jsx)(s.td,{children:"Select all messages in the selected mailbox"})]})})]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.em,{children:"keywords"})," parameter lets you define the flags to add to ",(0,t.jsx)(s.em,{children:"msgIDs"}),". You can use the following standard flags as well as custom flags (custom flags support depends on the server implementation):"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"$draft"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:'true to add the "draft" flag to the message'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"$seen"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:'true to add the "seen" flag to the message'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"$flagged"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:'true to add the "flagged" flag to the message'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"$answered"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:'true to add the "answered" flag to the message'})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:['|$deleted |boolean | true to add the "deleted" flag to the message|\n|',(0,t.jsx)(s.code,{children:"<custom flag>"})," |boolean | true to add the custom flag to the message|"]}),"\n",(0,t.jsxs)(s.p,{children:["The custom flags names must respect this rule: the keyword must be a case-insensitive string excluding control chars and space and can not include any of these characters: ",(0,t.jsx)(s.code,{children:'( ) { ] % * " \\'})]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"For a keyword to be taken into account it has to be true."}),"\n",(0,t.jsx)(s.li,{children:"The interpretation of keyword flags may vary per mail client."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"Number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-1",children:"Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:'var transporter : 4D.IMAPTransporter\nvar options,boxInfo,status : object\n\noptions = newObject()\noptions.host = "imap.gmail.com"\noptions.port = 993\noptions.user = "qodly@gmail.com"\noptions.password = "xxxxx"\n\n// Create transporter\ntransporter = 4D.IMAPTransporter.new(options)\n\n// Select mailbox\nboxInfo = transporter.selectBox("INBOX")\n\n// Mark all messages from INBOX as read/seen\nflags = newObject\nflags["$seen"] = true\nstatus = transporter.addFlags(kIMAPAll,flags)\n'})}),"\n",(0,t.jsx)(s.h2,{id:"append",children:".append()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".append"}),"( ",(0,t.jsx)(s.em,{children:"mailObj"})," : object , ",(0,t.jsx)(s.em,{children:"destinationBox"})," : string , ",(0,t.jsx)(s.em,{children:"options"})," : object ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"mailObj"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Email object"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"destinationBox"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Mailbox to receive Email object"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"options"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"object containing charset info"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the append operation"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-3",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".append()"})," function appends a ",(0,t.jsx)(s.code,{children:"mailObj"})," to the ",(0,t.jsx)(s.code,{children:"destinationBox"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.code,{children:"mailObj"})," parameter, pass an Email object. For a comprehensive description of mail properties, see ",(0,t.jsx)(s.a,{href:"EmailObjectClass#properties",children:"Email object"}),". The ",(0,t.jsx)(s.code,{children:".append()"})," function supports keyword tags in the Email object's ",(0,t.jsx)(s.code,{children:"keywords"})," attribute."]}),"\n",(0,t.jsxs)(s.p,{children:["The optional ",(0,t.jsx)(s.code,{children:"destinationBox"})," parameter lets you pass the name of a mailbox where the ",(0,t.jsx)(s.code,{children:"mailObj"})," will be appended. If omitted, the current mailbox is used."]}),"\n",(0,t.jsxs)(s.p,{children:["In the optional ",(0,t.jsx)(s.code,{children:"options"})," parameter, you can pass an object to define the charset and encoding for specific parts of the email. Available properties:"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"headerCharset"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Charset and encoding used for the following parts of the email: subject, attachment filenames, and email name attribute(s). Possible values: See possible charsets table below"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"bodyCharset"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Charset and encoding used for the html and string body contents of the email. Possible values: See possible charsets table below"})]})]})]}),"\n",(0,t.jsx)(s.p,{children:"Possible charsets:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Constant"}),(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Comment"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"kMailModeUTF8"}),(0,t.jsx)(s.td,{children:"US-ASCII_UTF8_QP"}),(0,t.jsxs)(s.td,{children:["headerCharset & bodyCharset: US-ASCII if possible, otherwise UTF-8 & Quoted-printable (",(0,t.jsx)(s.strong,{children:"default value"}),")"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"kMailModeUTF8InBase64"}),(0,t.jsx)(s.td,{children:"US-ASCII_UTF8_B64"}),(0,t.jsx)(s.td,{children:"headerCharset & bodyCharset: US-ASCII if possible, otherwise UTF-8 & base64"})]})]})]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"Number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-2",children:"Example"}),"\n",(0,t.jsx)(s.p,{children:"To save an email in the Drafts mailbox:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:'var imap : 4D.IMAPTransporter\nvar settings, status, msg: object\n\nsettings = newObject("host", "domain.com", "user", "xxxx", "password", "xxxx", "port", 993)\n\nimap = 4D.IMAPTransporter.new(settings)\n\nmsg = newObject()\nmsg.from = "xxxx@domain.com"\nmsg.subject = "Lorem Ipsum"\nmsg.stringBody = "Lorem ipsum dolor sit amet, consectetur adipiscing elit."\nmsg.keywords = newObject\nmsg.keywords["$seen"] = true //flag the message as read\nmsg.keywords["$draft"] = true //flag the message as a draft\n\nstatus = imap.append(msg, "Drafts")\n'})}),"\n",(0,t.jsx)(s.h2,{id:"authenticationmode",children:".authenticationMode"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".authenticationMode"})," : string"]}),"\n",(0,t.jsx)(s.h4,{id:"description-4",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".authenticationMode"})," property contains the authentication mode used to open the session on the mail server."]}),"\n",(0,t.jsx)(s.p,{children:"By default, the most secured mode supported by the server is used."}),"\n",(0,t.jsx)(s.p,{children:"Possible values are:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Constants"}),(0,t.jsx)(s.th,{children:"Comment"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"CRAM-MD5"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"kIMAPAuthenticationCRAMMD5"})}),(0,t.jsx)(s.td,{children:"Authentication using CRAM-MD5 protocol"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"LOGIN"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"kIMAPAuthenticationLogin"})}),(0,t.jsx)(s.td,{children:"Authentication using LOGIN protocol"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"OAUTH2"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"kIMAPAuthenticationOAUTH2"})}),(0,t.jsx)(s.td,{children:"Authentication using OAuth2 protocol"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"PLAIN"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"kIMAPAuthenticationPlain"})}),(0,t.jsx)(s.td,{children:"Authentication using PLAIN protocol"})]})]})]}),"\n",(0,t.jsx)(s.h2,{id:"checkconnection",children:".checkConnection()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".checkConnection()"})," : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the transporter object connection"})]})})]}),"\n",(0,t.jsx)(s.h4,{id:"description-5",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".checkConnection()"})," function  checks the connection using information stored in the transporter object, recreates the connection if necessary, and returns the status. This function allows you to verify that the values provided by the user are valid and consistent."]}),"\n",(0,t.jsx)(s.h4,{id:"returned-object",children:"Returned object"}),"\n",(0,t.jsx)(s.p,{children:"The function sends a request to the mail server and returns an object describing the mail status. This object can contain the following properties:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the check is successful, false otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"status"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:"(SMTP only) Status code returned by the mail server (0 in case of an issue unrelated to the mail processing)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"text"}),(0,t.jsx)(s.td,{children:"Status message returned by the mail server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a mail server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[ ].errCode"}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[ ].message"}),(0,t.jsx)(s.td,{children:"text"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[ ].componentSignature"}),(0,t.jsx)(s.td,{children:"text"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h2,{id:"checkconnectiondelay",children:".checkConnectionDelay"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".checkConnectionDelay"})," : integer"]}),"\n",(0,t.jsx)(s.h4,{id:"description-6",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".checkConnectionDelay"})," property contains the maximum time (in seconds) allowed prior to checking the connection to the server.  If this time is exceeded between two method calls, the connection to the server will be checked. By default, if the property has not been set in the ",(0,t.jsx)(s.em,{children:"server"})," object, the value is 300."]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Warning"}),": Make sure the defined timeout is lower than the server timeout, otherwise the client timeout will be useless."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"connectiontimeout",children:".connectionTimeOut"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".connectionTimeOut"})," : integer"]}),"\n",(0,t.jsx)(s.h4,{id:"description-7",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".connectionTimeOut"})," property contains the maximum wait time (in seconds) allowed to establish a connection to the server. By default, if the property has not been set in the server object (used to create the transporter object with ",(0,t.jsx)(s.code,{children:"SMTP New transporter"}),", ",(0,t.jsx)(s.code,{children:"POP3 New transporter"}),", or ",(0,t.jsx)(s.code,{children:"IMAP New transporter"}),"), the value is 30."]}),"\n",(0,t.jsx)(s.h2,{id:"copy",children:".copy()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".copy"}),"( ",(0,t.jsx)(s.em,{children:"msgsIDs"})," : collection , ",(0,t.jsx)(s.em,{children:"destinationBox"})," : string ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".copy"}),"( ",(0,t.jsx)(s.em,{children:"allMsgs"})," : integer , ",(0,t.jsx)(s.em,{children:"destinationBox"})," : string ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgsIDs"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Collection of message unique IDs (strings)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"allMsgs"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:"kIMAPAll"}),": All messages in the selected mailbox"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"destinationBox"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Mailbox to receive copied messages"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the copy operation"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-8",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".copy()"})," function copies the messages defined by ",(0,t.jsx)(s.em,{children:"msgsIDs"})," or ",(0,t.jsx)(s.em,{children:"allMsgs"})," to the ",(0,t.jsx)(s.em,{children:"destinationBox"})," on the IMAP server."]}),"\n",(0,t.jsx)(s.p,{children:"You can pass:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["in the ",(0,t.jsx)(s.em,{children:"msgsIDs"})," parameter, a collection containing the unique IDs of the specific messages to copy, or"]}),"\n",(0,t.jsxs)(s.li,{children:["in the ",(0,t.jsx)(s.em,{children:"allMsgs"})," parameter, the ",(0,t.jsx)(s.code,{children:"kIMAPAll"})," constant (integer) to copy all messages in the selected mailbox."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.em,{children:"destinationBox"})," parameter allows you to pass a string value with the name of the mailbox where the copies of messages will be placed."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"Number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-1-1",children:"Example 1"}),"\n",(0,t.jsx)(s.p,{children:"To copy a selection of messages:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server,boxInfo,status : object\n var mailIds : collection\n var transporter : 4D.IMAPTransporter\n\n server = newObject()\n server.host = "imap.gmail.com" //Mandatory\n server.port = 993\n server.user = "qodly@gmail.com"\n server.password = "XXXXXXXX"\n\n transporter = 4D.IMAPTransporter.new(server)\n\n  //select mailbox\n boxInfo = transporter.selectBox("inbox")\n\n  //get collection of message unique IDs\n mailIds = transporter.searchMails("subject \\"New feature:\\"")\n\n  // copy found messages to the "documents" mailbox\n status = transporter.copy(mailIds,"documents")\n'})}),"\n",(0,t.jsx)(s.h4,{id:"example-2-1",children:"Example 2"}),"\n",(0,t.jsx)(s.p,{children:"To copy all messages in the current mailbox:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server,boxInfo,status : object\n var transporter : 4D.IMAPTransporter\n\n server = newObject()\n server.host = "imap.gmail.com" //Mandatory\n server.port = 993\n server.user = "qodly@gmail.com"\n server.password = "XXXXXXXX"\n\n transporter = 4D.IMAPTransporter.new(server)\n\n  //select mailbox\n\n boxInfo = transporter.selectBox("inbox")\n\n  // copy all messages to the "documents" mailbox\n status = transporter.copy(kIMAPAll,"documents")\n'})}),"\n",(0,t.jsx)(s.h2,{id:"createbox",children:".createBox()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".createBox"}),"( ",(0,t.jsx)(s.em,{children:"name"})," :  string ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"name"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Name of the new mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the mailbox creation operation"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-9",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".createBox()"})," function creates a mailbox with the given ",(0,t.jsx)(s.code,{children:"name"}),". If the IMAP server\u2019s hierarchy separator character appears elsewhere in the mailbox name, the IMAP server will create any parent names needed to create the given mailbox."]}),"\n",(0,t.jsx)(s.p,{children:'In other words, an attempt to create "Projects/IMAP/Doc" on a server in which "/" is the hierarchy separator character will create:'}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:'Only the "Doc" mailbox if "Projects" & "IMAP" already exist.'}),"\n",(0,t.jsx)(s.li,{children:'"IMAP" & "Doc" mailboxes if only "Projects" already exists.'}),"\n",(0,t.jsx)(s.li,{children:'"Projects" & "IMAP" & "Doc" mailboxes, if they do not already exist.'}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.code,{children:"name"})," parameter, pass the name of the new mailbox."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"Number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-3",children:"Example"}),"\n",(0,t.jsx)(s.p,{children:'To create a new "Invoices" mailbox:'}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:'var info : string\nvar transporter : 4D.IMAPTransporter\nvar options, status : object\n\noptions = newObject()\n\noptions.host = "imap.gmail.com"\noptions.user = "test@gmail.com"\noptions.password = "XXXX"\n\ntransporter = 4D.IMAPTransporter.new(options)\n\nstatus = transporter.createBox("Invoices")\n\nif(status.success)\n	info = "Mailbox creation successful!"\nelse\n	info = "Error: "+status.statusText\nend\n'})}),"\n",(0,t.jsx)(s.h2,{id:"delete",children:".delete()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".delete"}),"( ",(0,t.jsx)(s.em,{children:"msgsIDs"})," : collection ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".delete"}),"( ",(0,t.jsx)(s.em,{children:"msgsIDs"})," : integer ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgsIDs"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"collection of message unique IDs (strings)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgsIDs"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:"kIMAPAll"}),": All messages in the selected mailbox"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the delete operation"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-10",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".delete()"}),' function sets the "deleted" flag for the messages defined in ',(0,t.jsx)(s.em,{children:"msgsIDs"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"msgsIDs"})," parameter, you can pass:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"a collection containing the unique IDs of the specific messages to delete, or"}),"\n",(0,t.jsxs)(s.li,{children:["the ",(0,t.jsx)(s.code,{children:"kIMAPAll"})," constant (integer) to delete all messages in the selected mailbox."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:['Executing this function does not actually remove messages. Messages with the "delete" flag can still be found by the ',(0,t.jsx)(s.a,{href:"#searchmails",children:(0,t.jsx)(s.code,{children:".searchMails()"})})," function. Flagged messages are deleted from the IMAP server with the ",(0,t.jsx)(s.a,{href:"#expunge",children:(0,t.jsx)(s.code,{children:".expunge()"})})," function or by selecting another mailbox or when the IMAP transporter object (created with ",(0,t.jsx)(s.a,{href:"#imap-new-transporter",children:"4D.IMAPTransporter.new"}),") is destroyed."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"Number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-1-2",children:"Example 1"}),"\n",(0,t.jsx)(s.p,{children:"To delete a selection of messages:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server,boxInfo,status : object\n var mailIds : collection\n var transporter : 4D.IMAPTransporter\n\n server = newObject()\n server.host = "imap.gmail.com" //Mandatory\n server.port = 993\n server.user = "qodly@gmail.com"\n server.password = "XXXXXXXX"\n\n transporter = 4D.IMAPTransporter.new(server)\n\n  //select mailbox\n boxInfo = transporter.selectBox("Inbox")\n\n  //get collection of message unique IDs\n mailIds = transporter.searchMails("subject \\"Reports\\"")\n\n  // Delete selected messages\n status = transporter.delete(mailIds)\n'})}),"\n",(0,t.jsx)(s.h4,{id:"example-2-2",children:"Example 2"}),"\n",(0,t.jsx)(s.p,{children:"To delete all messages in the current mailbox:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server,boxInfo,status : object\n var transporter : 4D.IMAPTransporter\n\n server = newObject()\n server.host = "imap.gmail.com" //Mandatory\n server.port = 993\n server.user = "qodly@gmail.com"\n server.password = "XXXXXXXX"\n\n transporter = 4D.IMAPTransporter.new(server)\n\n  //select mailbox\n boxInfo = transporter.selectBox("Junk Email")\n\n  // delete all messages in the current mailbox\n status = transporter.delete(kIMAPAll)\n'})}),"\n",(0,t.jsx)(s.h2,{id:"deletebox",children:".deleteBox()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".deleteBox"}),"( ",(0,t.jsx)(s.em,{children:"name"})," : string ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"name"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Name of the mailbox to delete"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the mailbox deletion operation"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-11",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".deleteBox()"})," function permanently removes the mailbox with the given ",(0,t.jsx)(s.em,{children:"name"})," from the IMAP server. Attempting to delete an INBOX or a mailbox that does not exist will generate an error."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"name"})," parameter, pass the name of the mailbox to delete."]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:'The function cannot delete a mailbox that has child mailboxes if the parent mailbox has the "\\Noselect" attribute.'}),"\n",(0,t.jsx)(s.li,{children:"All messages in the deleted mailbox will also be deleted."}),"\n",(0,t.jsx)(s.li,{children:"The ability to delete a mailbox depends on the mail server."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"Number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-4",children:"Example"}),"\n",(0,t.jsx)(s.p,{children:'To delete the "Nova Orion Industries" child mailbox from the "Bills" mailbox hierarchy:'}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:'var pw, name, info : string\nvar options, status : object\nvar transporter : 4D.IMAPTransporter\n\noptions = newObject()\n\npw = "XXXXXX" //password\n\noptions.host = "imap.gmail.com"\noptions.user = "test@gmail.com"\noptions.password = pw\n\ntransporter = 4D.IMAPTransporter.new(options)\n\n// delete mailbox\nname = "Bills"+transporter.getDelimiter()+"Nova Orion Industries"\nstatus = transporter.deleteBox(name)\n\nif(status.success)\n	info = "Mailbox deletion successful!"\nelse\n	info = "Error: "+status.statusText\nend\n'})}),"\n",(0,t.jsx)(s.h2,{id:"expunge",children:".expunge()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".expunge"}),"() : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the expunge operation"})]})})]}),"\n",(0,t.jsx)(s.h4,{id:"description-12",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".expunge()"}),' function removes all messages with the "deleted" flag from the IMAP mail server. The "deleted" flag can be set with the ',(0,t.jsx)(s.a,{href:"#delete",children:(0,t.jsx)(s.code,{children:".delete()"})})," or ",(0,t.jsx)(s.a,{href:"#addflags",children:(0,t.jsx)(s.code,{children:".addFlags()"})})," functions."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"Number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-5",children:"Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:'var transporter : 4D.IMAPTransporter\nvar options,boxInfo,status : object\nvar ids : collection\n\noptions = newObject()\noptions.host = "imap.gmail.com"\noptions.port = 993\noptions.user = "qodly@gmail.com"\noptions.password = "xxxxx"\n\n// Create transporter\ntransporter = 4D.IMAPTransporter.new(options)\n\n// Select mailbox\nboxInfo = transporter.selectBox("INBOX")\n\n// Find and delete all seen messages in INBOX\nids = transporter.searchMails("SEEN")\nstatus = transporter.delete(ids)\n\n// Purge all messages flagged as deleted\nstatus = transporter.expunge()\n'})}),"\n",(0,t.jsx)(s.h2,{id:"getboxinfo",children:".getBoxInfo()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".getBoxInfo"}),"({ ",(0,t.jsx)(s.em,{children:"name"})," : string }) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"name"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Name of the mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"boxInfo object"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-13",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".getBoxInfo()"})," function returns a ",(0,t.jsx)(s.code,{children:"boxInfo"})," object corresponding to the current maibox, or the mailbox ",(0,t.jsx)(s.em,{children:"name"}),". This function returns the same information as ",(0,t.jsx)(s.a,{href:"#selectbox",children:(0,t.jsx)(s.code,{children:".selectBox()"})})," without changing the current mailbox."]}),"\n",(0,t.jsxs)(s.p,{children:["In the optional ",(0,t.jsx)(s.em,{children:"name"})," parameter, pass the name of the mailbox to access. The name represents an unambiguous left-to-right hierarchy with levels separated by a specific delimiter character. The delimiter can be found with the ",(0,t.jsx)(s.a,{href:"#getdelimiter",children:(0,t.jsx)(s.code,{children:".getDelimiter()"})})," function."]}),"\n",(0,t.jsxs)(s.p,{children:["If the mailbox ",(0,t.jsx)(s.em,{children:"name"})," is not selectable or does not exist, the function generates an error and returns ",(0,t.jsx)(s.strong,{children:"null"}),"."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"boxInfo"})," object returned contains the following properties:"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"name"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Name of the mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"mailCount"}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:"Number of messages in the mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"mailRecent"}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:'Number of messages with the "recent" flag (indicating new messages)'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"id"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Unique id of the mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"mailUnseen"}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:'Number of messages with the "unseen" flag'})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-6",children:"Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server : object\n var transporter : 4D.IMAPTransporter\n var boxInfo : object\n var info : string\n transporter = 4D.IMAPTransporter.new(server)\n\n boxInfo = transporter.getBoxInfo("INBOX")\n info = "INBOX contains "+string(boxInfo.mailRecent)+" recent emails."\n'})}),"\n",(0,t.jsx)(s.h2,{id:"getboxlist",children:".getBoxList()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".getBoxList"}),"( { ",(0,t.jsx)(s.em,{children:"parameters"})," : object } ) : collection"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"parameters"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Parameter object"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Collection of mailbox objects"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-14",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".getBoxList()"})," function returns a collection of mailboxes describing all of the available mailboxes. This function allows you to locally manage the list of messages located on the IMAP mail server."]}),"\n",(0,t.jsxs)(s.p,{children:["In the optional ",(0,t.jsx)(s.em,{children:"parameters"})," parameter, pass an object containing values to filter the returned mailboxes. You can pass:"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"isSubscribed"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsxs)(s.td,{children:[(0,t.jsxs)("li",{children:[(0,t.jsx)(s.strong,{children:"true"})," to return only subscribed mailboxes"]}),(0,t.jsxs)("li",{children:[" ",(0,t.jsx)(s.strong,{children:"false"})," to return all available mailboxes"]})]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"names"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:'Collection of objects containing a "name" attribute or collection of texts containing the box names'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"withBoxProperties"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsxs)(s.td,{children:["If true (default): adds the ",(0,t.jsx)(s.code,{children:"selectable"}),", ",(0,t.jsx)(s.code,{children:"inferior"}),", and ",(0,t.jsx)(s.code,{children:"interesting"})," attributes to the result object. If false, these attributes are omitted."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"withBoxInfo"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsxs)(s.td,{children:["Default value is false. If true, adds the ",(0,t.jsx)(s.code,{children:"mailCount"}),", ",(0,t.jsx)(s.code,{children:"mailRecent"}),", and ",(0,t.jsx)(s.code,{children:"id"})," attributes to the result object."]})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"result-1",children:"Result"}),"\n",(0,t.jsx)(s.p,{children:"Each object of the returned collection contains the following properties:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"[].name"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Name of the mailbox. Returned if withBoxProperties=true or withBoxInfo=true"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"[].selectable"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsxs)(s.td,{children:["Indicates whether or not the access rights allow the mailbox to be selected: ",(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"true - the mailbox can be selected"}),(0,t.jsx)("li",{children:"false - the mailbox can not be selected"})]}),"Returned if withBoxProperties=true"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"[].inferior"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsxs)(s.td,{children:["Indicates whether or not the access rights allow creating a lower hierachy in the mailbox: ",(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"true - a lower level can be created"}),(0,t.jsx)("li",{children:"false - a lower level can not be created"})]}),"Returned if withBoxProperties=true"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"[].interesting"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsxs)(s.td,{children:['Indicates if the mailbox has been marked "interesting" by the server: ',(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:'true - The mailbox has been marked "interesting" by the server. For example, it may contain new messages.'}),(0,t.jsx)("li",{children:'false - The mailbox has not been marked "interesting" by the server.'})]}),"Returned if withBoxProperties=true"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"[].mailCount"}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:"Number of messages in inbox. Returned if withBoxInfo=true"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"[].mailRecent"}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:'Number of messages marked "recent" (indicating new messages). Returned if withBoxInfo=true'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"[].mailUnseen"}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:'Number of messages marked "unseen". Returned if withBoxInfo=true'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"[].id"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Unique mailbox identifier. Returned if withBoxInfo=true"})]})]})]}),"\n",(0,t.jsx)(s.p,{children:"If the account does not contain any mailboxes, an empty collection is returned."}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["If there is no open connection, ",(0,t.jsx)(s.code,{children:".getBoxList()"})," will open a connection."]}),"\n",(0,t.jsxs)(s.li,{children:["If the connection has not been used since the designated connection delay (see ",(0,t.jsx)(s.code,{children:"4D.IMAPTransporter.new"}),"), the ",(0,t.jsx)(s.code,{children:".checkConnection( )"})," function is automatically called."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"example-7",children:"Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server : object\n var transporter : 4D.IMAPTransporter\n var boxList : collection\n var info, split : string\n transporter = 4D.IMAPTransporter.new(server)\n\n boxList = transporter.getBoxList()\n\n forEach(box,boxList)\n    if(box.interesting)\n       split = splitString(box.name,transporter.getDelimiter())\n       info = "New emails are available in the box: "+split[split.length-1])\n    end\n end\n'})}),"\n",(0,t.jsx)(s.h2,{id:"getdelimiter",children:".getDelimiter()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".getDelimiter"}),"() : string"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Hierarchy delimiter character"})]})})]}),"\n",(0,t.jsx)(s.h4,{id:"description-15",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".getDelimiter()"})," function returns the character used to delimit levels of hierarchy in the mailbox name."]}),"\n",(0,t.jsx)(s.p,{children:"The delimiter is a character which can be used to:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"create lower level (inferior) mailboxes"}),"\n",(0,t.jsx)(s.li,{children:"search higher or lower within the mailbox hierarchy"}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"result-2",children:"Result"}),"\n",(0,t.jsx)(s.p,{children:"Mailbox name delimiter character."}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["If there is no open connection, ",(0,t.jsx)(s.code,{children:".getDelimiter()"})," will open a connection."]}),"\n",(0,t.jsxs)(s.li,{children:["If the connection has not been used since the ",(0,t.jsx)(s.a,{href:"#checkconnectiondelay",children:"designated connection delay"}),", the ",(0,t.jsx)(s.a,{href:"#checkconnection",children:(0,t.jsx)(s.code,{children:".checkConnection()"})})," function is automatically called."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"example-8",children:"Example"}),"\n",(0,t.jsxs)(s.p,{children:["See ",(0,t.jsxs)(s.a,{href:"#getboxlist",children:[(0,t.jsx)(s.code,{children:"getBoxList()"})," example"]}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"getmail",children:".getMail()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".getMail"}),"( ",(0,t.jsx)(s.em,{children:"msgNumber"}),": integer { , ",(0,t.jsx)(s.em,{children:"options"})," : object } ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".getMail"}),"( ",(0,t.jsx)(s.em,{children:"msgID"}),": string { , ",(0,t.jsx)(s.em,{children:"options"})," : object } ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgNumber"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Sequence number of the message"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgID"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Unique ID of the message"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"options"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Message handling instructions"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.a,{href:"EmailObjectClass#properties",children:"Email object"})})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-16",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".getMail()"})," function returns the ",(0,t.jsx)(s.code,{children:"Email"})," object corresponding to the ",(0,t.jsx)(s.em,{children:"msgNumber"})," or ",(0,t.jsx)(s.em,{children:"msgID"})," in the mailbox designated by the ",(0,t.jsx)(s.code,{children:"IMAP transporter"})," object. This function allows you to locally handle the email contents."]}),"\n",(0,t.jsx)(s.p,{children:"In the first parameter, you can pass either:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.em,{children:"msgNumber"}),", an ",(0,t.jsx)(s.em,{children:"integer"})," value indicating the sequence number of the message to retrieve or"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.em,{children:"msgID"}),", a ",(0,t.jsx)(s.em,{children:"string"})," value indicating the unique ID of the message to retrieve."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["The optional ",(0,t.jsx)(s.em,{children:"options"})," parameter allows you pass an object defining additional instructions for handling the message. The following properties are available:"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"updateSeen"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:'If true, the message is marked as "seen" in the mailbox. If False, the message is not marked as "seen". Default value: true'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"withBody"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"Pass true to return the body of the message. If False, only the message header is returned. Default value: true"})]})]})]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The function generates an error and returns ",(0,t.jsx)(s.strong,{children:"Null"})," if ",(0,t.jsx)(s.em,{children:"msgID"})," designates a non-existing message,"]}),"\n",(0,t.jsxs)(s.li,{children:["If no mailbox is selected with the ",(0,t.jsx)(s.a,{href:"#selectbox",children:(0,t.jsx)(s.code,{children:".selectBox()"})})," function, an error is generated,"]}),"\n",(0,t.jsxs)(s.li,{children:["If there is no open connection, ",(0,t.jsx)(s.code,{children:".getMail()"})," will open a connection the last mailbox specified with ",(0,t.jsx)(s.a,{href:"#selectbox",children:(0,t.jsx)(s.code,{children:".selectBox()"})}),"`."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"result-3",children:"Result"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:".getMail()"})," returns an ",(0,t.jsxs)(s.a,{href:"EmailObjectClass",children:[(0,t.jsx)(s.code,{children:"Email"})," object"]})," with the following specific IMAP properties: ",(0,t.jsx)(s.em,{children:"id"}),", ",(0,t.jsx)(s.em,{children:"receivedAt"}),", and ",(0,t.jsx)(s.em,{children:"size"}),"."]}),"\n",(0,t.jsx)(s.h4,{id:"example-9",children:"Example"}),"\n",(0,t.jsx)(s.p,{children:"You want to get the message with ID = 1:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server : object\n var info, mail, boxInfo : variant\n var transporter : 4D.IMAPTransporter\n\n server = newObject()\n server.host = "imap.gmail.com" //Mandatory\n server.port = 993\n server.user = "qodly@gmail.com"\n server.password = "XXXXXXXX"\n\n  //create transporter\n transporter = 4D.IMAPTransporter.new(server)\n\n  //select mailbox\n boxInfo = transporter.selectBox("Inbox")\n\n  //get Email object with ID 1\n mail = transporter.getMail(1)\n'})}),"\n",(0,t.jsx)(s.h2,{id:"getmails",children:".getMails()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".getMails"}),"( ",(0,t.jsx)(s.em,{children:"ids"})," : collection { , ",(0,t.jsx)(s.em,{children:"options"})," : object } ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".getMails"}),"( ",(0,t.jsx)(s.em,{children:"startMsg"})," : integer , ",(0,t.jsx)(s.em,{children:"endMsg"})," : integer { , ",(0,t.jsx)(s.em,{children:"options"})," : object } ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"ids"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Collection of message ID"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"startMsg"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Sequence number of the first message"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"endMsg"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Sequence number of the last message"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"options"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Message handling instructions"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsxs)(s.td,{children:["Object containing:",(0,t.jsx)("br",{}),(0,t.jsxs)("ul",{children:[(0,t.jsxs)("li",{children:["a collection of ",(0,t.jsx)(s.a,{href:"EmailObjectClass#properties",children:"Email objects"})," and"]}),(0,t.jsx)("li",{children:"a collection of IDs or numbers for missing messages, if any"})]})]})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-17",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".getMails()"})," function returns an object containing a collection of ",(0,t.jsx)(s.code,{children:"Email"})," objects."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"First Syntax:"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.em,{children:(0,t.jsx)(s.strong,{children:".getMails( ids { , options } ) -> result"})})}),"\n",(0,t.jsx)(s.p,{children:"The first syntax allows you to retrieve messages based on their IDs."}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"ids"})," parameter, pass a collection of IDs for the messages to return. You can get the IDs with ",(0,t.jsx)(s.a,{href:"#getmail",children:(0,t.jsx)(s.code,{children:".getMail()"})}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["The optional ",(0,t.jsx)(s.em,{children:"options"})," parameter allows you to define the parts of the messages to be returned. See the ",(0,t.jsx)(s.strong,{children:"Options"})," table below for a description of the available properties."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Second syntax:"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.em,{children:(0,t.jsx)(s.strong,{children:".getMails( startMsg , endMsg { , options } ) -> result"})})}),"\n",(0,t.jsx)(s.p,{children:"The second syntax allows you to retrieve messages based on a sequential range. The values passed represent the position of the messages in the mailbox."}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"startMsg"})," parameter, pass an ",(0,t.jsx)(s.em,{children:"integer"})," value corresponding to the number of the first message in a sequential range. If you pass a negative number (",(0,t.jsx)(s.em,{children:"startMsg"})," <= 0), the first message of the mailbox will be used as the beginning of the sequence."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"endMsg"})," parameter, pass an ",(0,t.jsx)(s.em,{children:"integer"})," value corresponding to the number of the last message to be included in a sequential range. If you pass a negative number (",(0,t.jsx)(s.em,{children:"endMsg"})," <= 0), the last message of the mailbox will be used as the end of the sequence."]}),"\n",(0,t.jsxs)(s.p,{children:["The optional ",(0,t.jsx)(s.em,{children:"options"})," parameter allows you to define the parts of the messages to be returned."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Options"})}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"updateSeen"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:'If true, the specified messages are marked as "seen" in the mailbox. If False, the messages are not marked as "seen". Default value: true'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"withBody"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"Pass true to return the body of the specified messages. If false, only the message headers are returned. Default value: true"})]})]})]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["If no mailbox is selected with the ",(0,t.jsx)(s.a,{href:"#selectbox",children:(0,t.jsx)(s.code,{children:".selectBox()"})})," command, an error is generated."]}),"\n",(0,t.jsxs)(s.li,{children:["If there is no open connection, ",(0,t.jsx)(s.code,{children:".getMails()"})," will open a connection the last mailbox specified with ",(0,t.jsx)(s.a,{href:"#selectbox",children:(0,t.jsx)(s.code,{children:".selectBox()"})}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"result-4",children:"Result"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:".getMails()"})," returns an object containing the following collections:"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"list"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsxs)(s.td,{children:["collection of ",(0,t.jsxs)(s.a,{href:"EmailObjectClass#properties",children:[(0,t.jsx)(s.code,{children:"Email"})," objects"]}),". If no Email objects are found, an empty collection is returned."]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"notFound"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsxs)(s.td,{children:["collection of:",(0,t.jsx)("br",{}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"first syntax - previously passed message IDs that do not exist"}),(0,t.jsx)("li",{children:"second syntax - sequence numbers of messages between startMsg and endMsg that do not exist"})]}),"An empty collection is returned if all messages are found."]})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-10",children:"Example"}),"\n",(0,t.jsx)(s.p,{children:'You want to retrieve the 20 most recent emails without changing their "seen" status:'}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server,boxInfo,result : object\n var transporter : 4D.IMAPTransporter\n\n server = newObject()\n server.host = "imap.gmail.com" //Mandatory\n server.port = 993\n server.user = "qodly@gmail.com"\n server.password = "XXXXXXXX"\n\n  //create transporter\n transporter = 4D.IMAPTransporter.new(server)\n\n  //select mailbox\n boxInfo = transporter.selectBox("INBOX")\n\n  if(boxInfo.mailCount>0)\n	// retrieve the headers of the last 20 messages\n	// without marking them as read\n    result = transporter.getMails(boxInfo.mailCount-20,boxInfo.mailCount,\\\n     	newObject("withBody",false,"updateSeen",false))\n    forEach(mail,result.list)\n    	// ...\n    end\n end\n'})}),"\n",(0,t.jsx)(s.h2,{id:"getmimeasblob",children:".getMIMEAsblob()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".getMIMEAsblob"}),"( ",(0,t.jsx)(s.em,{children:"msgNumber"})," : integer { , ",(0,t.jsx)(s.em,{children:"updateSeen"})," : boolean } ) : blob",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".getMIMEAsblob"}),"( ",(0,t.jsx)(s.em,{children:"msgID"})," : string { , ",(0,t.jsx)(s.em,{children:"updateSeen"})," : boolean } ) : blob"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgNumber"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Sequence number of the message"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgID"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Unique ID of the message"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"updateSeen"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:'If true, the message is marked "seen" in the mailbox. If False the message is left untouched.'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"BLOB"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"blob of the MIME string returned from the mail server"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-18",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".getMIMEAsblob()"})," function returns a BLOB containing the MIME contents for the message corresponding to the ",(0,t.jsx)(s.em,{children:"msgNumber"})," or ",(0,t.jsx)(s.em,{children:"msgID"})," in the mailbox designated by the ",(0,t.jsx)(s.code,{children:"IMAP_transporter"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"In the first parameter, you can pass either:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.em,{children:"msgNumber"}),", an ",(0,t.jsx)(s.em,{children:"integer"})," value indicating the sequence number of the message to retrieve or"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.em,{children:"msgID"}),", a ",(0,t.jsx)(s.em,{children:"string"})," value indicating the unique ID of the message to retrieve."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["The optional ",(0,t.jsx)(s.em,{children:"updateSeen"}),' parameter allows you to specify if the message is marked as "seen" in the mailbox. You can pass:']}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"true"}),' - to mark the message as "seen" (indicating the message has been read)']}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"false"}),' - to leave the message\'s "seen" status untouched']}),"\n"]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The function returns an empty blob if ",(0,t.jsx)(s.em,{children:"msgNumber"})," or msgID* designates a non-existing message,"]}),"\n",(0,t.jsxs)(s.li,{children:["If no mailbox is selected with the ",(0,t.jsx)(s.a,{href:"#selectbox",children:(0,t.jsx)(s.code,{children:".selectBox()"})})," command, an error is generated,"]}),"\n",(0,t.jsxs)(s.li,{children:["If there is no open connection, ",(0,t.jsx)(s.code,{children:".getMIMEAsblob()"})," will open a connection the last mailbox specified with ",(0,t.jsx)(s.code,{children:".selectBox()"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"result-5",children:"Result"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:".getMIMEAsblob()"})," returns a ",(0,t.jsx)(s.code,{children:"blob"})," which can be archived in a database or converted to an ",(0,t.jsxs)(s.a,{href:"EmailObjectClass#properties",children:[(0,t.jsx)(s.code,{children:"Email"})," object"]})," with the ",(0,t.jsx)(s.code,{children:"mailConvertFromMIME"})," command."]}),"\n",(0,t.jsx)(s.h4,{id:"example-11",children:"Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server : object\n var boxInfo : variant\n var blob : blob\n var transporter : 4D.IMAPTransporter\n\n server = newObject()\n server.host = "imap.gmail.com"\n server.port = 993\n server.user = "qodly@gmail.com"\n server.password = "XXXXXXXX"\n\n  //create transporter\n transporter = 4D.IMAPTransporter.new(server)\n\n  //select mailbox\n boxInfo = transporter.selectBox("Inbox")\n\n  //get BLOB\n blob = transporter.getMIMEAsblob(1)\n'})}),"\n",(0,t.jsx)(s.h2,{id:"host",children:".host"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".host"})," : string"]}),"\n",(0,t.jsx)(s.h4,{id:"description-19",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".host"})," property contains the name or the IP address of the host server. Used for mail transactions (SMTP, POP3, IMAP)."]}),"\n",(0,t.jsx)(s.h2,{id:"logfile",children:".logFile"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".logFile"})," : string"]}),"\n",(0,t.jsx)(s.h4,{id:"description-20",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".logFile"})," property contains the path of the extended log file defined (if any) for the mail connection."]}),"\n",(0,t.jsx)(s.h2,{id:"move",children:".move()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".move"}),"( ",(0,t.jsx)(s.em,{children:"msgsIDs"})," : collection , ",(0,t.jsx)(s.em,{children:"destinationBox"})," : string ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".move"}),"( ",(0,t.jsx)(s.em,{children:"allMsgs"})," : integer , ",(0,t.jsx)(s.em,{children:"destinationBox"})," : string ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgsIDs"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"collection of message unique IDs (strings)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"allMsgs"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.code,{children:"kIMAPAll"}),": All messages in the selected mailbox"]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"destinationBox"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Mailbox to receive moved messages"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the move operation"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-21",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".move()"})," function moves the messages defined by ",(0,t.jsx)(s.em,{children:"msgsIDs"})," or ",(0,t.jsx)(s.em,{children:"allMsgs"})," to the ",(0,t.jsx)(s.em,{children:"destinationBox"})," on the IMAP server."]}),"\n",(0,t.jsx)(s.p,{children:"You can pass:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["in the ",(0,t.jsx)(s.em,{children:"msgsIDs"})," parameter, a collection containing the unique IDs of the specific messages to move, or"]}),"\n",(0,t.jsxs)(s.li,{children:["in the ",(0,t.jsx)(s.em,{children:"allMsgs"})," parameter, the ",(0,t.jsx)(s.code,{children:"kIMAPAll"})," constant (integer) to move all messages in the selected mailbox."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.em,{children:"destinationBox"})," parameter allows you to pass a string value with the name of the mailbox where the messages will be moved."]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:["This function is only supported by IMAP servers compliant with RFC ",(0,t.jsx)(s.a,{href:"https://tools.ietf.org/html/rfc8474",children:"8474"}),"."]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"4D error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-1-3",children:"Example 1"}),"\n",(0,t.jsx)(s.p,{children:"To move a selection of messages:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server,boxInfo,status : object\n var mailIds : collection\n var transporter : 4D.IMAPTransporter\n\n server = newObject()\n server.host = "imap.gmail.com" //Mandatory\n server.port = 993\n server.user = "qodly@gmail.com"\n server.password = "XXXXXXXX"\n\n transporter = 4D.IMAPTransporter.new(server)\n\n  //select mailbox\n boxInfo = transporter.selectBox("inbox")\n\n  //get collection of message unique IDs\n mailIds = transporter.searchMails("subject \\"New feature:\\"")\n\n  // Move found messages from the current mailbox to the "documents" mailbox\n status = transporter.move(mailIds,"documents")\n'})}),"\n",(0,t.jsx)(s.h4,{id:"example-2-3",children:"Example 2"}),"\n",(0,t.jsx)(s.p,{children:"To move all messages in the current mailbox:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server,boxInfo,status : object\n var transporter : 4D.IMAPTransporter\n\n server = newObject()\n server.host = "imap.gmail.com" //Mandatory\n server.port = 993\n server.user = "4d@gmail.com"\n server.password = "XXXXXXXX"\n\n transporter = 4D.IMAPTransporter.new(server)\n\n  //select mailbox\n boxInfo = transporter.selectBox("inbox")\n\n  // move all messages in the current mailbox to the "documents" mailbox\n status = transporter.move(kIMAPAll,"documents")\n'})}),"\n",(0,t.jsx)(s.h2,{id:"numtoid",children:".numToID()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".numToID"}),"( ",(0,t.jsx)(s.em,{children:"startMsg"})," : integer , ",(0,t.jsx)(s.em,{children:"endMsg"})," : integer ) : collection"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"startMsg"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Sequence number of the first message"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"endMsg"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Sequence number of the last message"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"collection of unique IDs"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-22",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".numToID()"})," function converts the sequence numbers to IMAP unique IDs for the messages in the sequential range designated by ",(0,t.jsx)(s.em,{children:"startMsg"})," and ",(0,t.jsx)(s.em,{children:"endMsg"})," in the currently selected mailbox."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"startMsg"})," parameter, pass an integer value corresponding to the number of the first message in a sequential range. If you pass a negative number (",(0,t.jsx)(s.em,{children:"startMsg"})," <= 0), the first message of the mailbox will be used as the beginning of the sequence."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"endMsg"})," parameter, pass an integer value corresponding to the number of the last message to be included in a sequential range. If you pass a negative number (",(0,t.jsx)(s.em,{children:"endMsg"})," <= 0), the last message of the mailbox will be used as the end of the sequence."]}),"\n",(0,t.jsx)(s.h4,{id:"result-6",children:"Result"}),"\n",(0,t.jsx)(s.p,{children:"The function returns a collection of strings (unique IDs)."}),"\n",(0,t.jsx)(s.h4,{id:"example-12",children:"Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var transporter : 4D.IMAPTransporter\n var server,boxInfo,status : object\n var mailIds : collection\n\n server = newObject()\n server.host = "imap.gmail.com" //Mandatory\n server.port = 993\n server.user = "qodly@gmail.com"\n server.password = "XXXXXXXX"\n\n transporter = 4D.IMAPTransporter.new(server)\n\n  //select mailbox\n boxInfo = transporter.selectBox("inbox")\n\n  //get IDs for 5 last messages received\n mailIds = transporter.numToID((boxInfo.mailCount-5),boxInfo.mailCount)\n\n  //delete the messages from the current mailbox\n status = transporter.delete(mailIds)\n'})}),"\n",(0,t.jsx)(s.h2,{id:"removeflags",children:".removeFlags()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".removeFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : collection , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".removeFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : string , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object",(0,t.jsx)("br",{}),(0,t.jsx)(s.strong,{children:".removeFlags"}),"( ",(0,t.jsx)(s.em,{children:"msgIDs"})," : integer , ",(0,t.jsx)(s.em,{children:"keywords"})," :  object ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgIDs"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Collection of strings: Message unique IDs (string)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgIDs"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"Unique ID of a message"}),(0,t.jsx)(s.td,{})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"msgIDs"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"kIMAPAll: All messages in the selected mailbox"}),(0,t.jsx)(s.td,{})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"keywords"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Keyword flags to remove"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the removeFlags operation"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-23",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".removeFlags()"})," function removes flags from the ",(0,t.jsx)(s.em,{children:"msgIDs"})," for the specified ",(0,t.jsx)(s.code,{children:"keywords"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"msgIDs"})," parameter, you can pass either:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["a ",(0,t.jsx)(s.em,{children:"collection"})," containing the unique IDs of specific messages or"]}),"\n",(0,t.jsxs)(s.li,{children:["the unique ID (",(0,t.jsx)(s.em,{children:"string"}),") of a single message or"]}),"\n",(0,t.jsxs)(s.li,{children:["the following constant (",(0,t.jsx)(s.em,{children:"integer"}),") for all messages in the selected mailbox:"]}),"\n"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Constant"}),(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Comment"})]})}),(0,t.jsx)(s.tbody,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"kIMAPAll"}),(0,t.jsx)(s.td,{children:"1"}),(0,t.jsx)(s.td,{children:"Select all messages in the selected mailbox"})]})})]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"keywords"})," parameter lets you define the flags to remove from ",(0,t.jsx)(s.em,{children:"msgIDs"}),". You can use the following standard flags as well as custom flags:"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"$draft"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:'true to remove the "draft" flag from the message'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"$seen"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:'true to remove the "seen" flag from the message'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"$flagged"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:'true to remove the "flagged" flag from the message'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"$answered"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:'true to remove the "answered" flag from the message'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"$deleted"}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:'true to remove the "deleted" flag from the message'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"<custom flag>"})}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true to remove the custom flag from the message"})]})]})]}),"\n",(0,t.jsxs)(s.p,{children:["Please refer to ",(0,t.jsx)(s.a,{href:"#addflags",children:".addFlags()"})," for more information on custom flags."]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"For a keyword to be taken into account it has to be true."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"Number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-13",children:"Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:'var options,boxInfo,status : object\nvar transporter : 4D.IMAPTransporter\n\noptions = newObject()\noptions.host = "imap.gmail.com"\noptions.port = 993\noptions.user = "qodly@gmail.com"\noptions.password = "xxxxx"\n\n// Create transporter\ntransporter = 4D.IMAPTransporter.new(options)\n\n// Select mailbox\nboxInfo = transporter.selectBox("INBOX")\n\n// Mark all messages from INBOX as unseen\nflags = newObject\nflags["$seen"] = true\nstatus = transporter.removeFlags(kIMAPAll,flags)\n'})}),"\n",(0,t.jsx)(s.h2,{id:"renamebox",children:".renameBox()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".renameBox"}),"( ",(0,t.jsx)(s.em,{children:"currentName"})," : string , ",(0,t.jsx)(s.em,{children:"newName"})," : string ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"currentName"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Name of the current mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"newName"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"New mailbox name"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the renaming operation"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-24",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".renameBox()"})," function changes the name of a mailbox on the IMAP server. Attempting to rename a mailbox from a mailbox name that does not exist or to a mailbox name that already exists will generate an error."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.code,{children:"currentName"})," parameter, pass the name of the mailbox to be renamed."]}),"\n",(0,t.jsxs)(s.p,{children:["Pass the new name for the mailbox in the ",(0,t.jsx)(s.code,{children:"newName"})," parameter."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"Number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-14",children:"Example"}),"\n",(0,t.jsx)(s.p,{children:'To to rename your "Invoices mailbox to "Bills":'}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:'var options, status : object\nvar transporter : 4D.IMAPTransporter\nvar info : string\n\noptions = newObject()\n\noptions.host = "imap.gmail.com"\noptions.user = "test@gmail.com"\noptions.password = "XXXXX"\n\ntransporter = 4D.IMAPTransporter.new(options)\n\n// rename mailbox\nstatus = transporter.renameBox("Invoices", "Bills")\n\nif(status.success)\n   info = "Mailbox renaming successful!"\nelse\n   info = "Error: "+status.statusText\nend\n'})}),"\n",(0,t.jsx)(s.h2,{id:"port",children:".port"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".port"})," : integer"]}),"\n",(0,t.jsx)(s.h4,{id:"description-25",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".port"})," property contains  the port number used for mail transactions. By default, if the ",(0,t.jsx)(s.em,{children:"port"})," property has not been set in the ",(0,t.jsx)(s.em,{children:"server"})," object (used to create the transporter object), the port used is:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"SMTP"})," - 587"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"POP3"})," - 995"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"IMAP"})," - 993"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"searchmails",children:".searchMails()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".searchMails"}),"( ",(0,t.jsx)(s.em,{children:"searchCriteria"})," : string ) : collection"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"searchCriteria"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Search criteria"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"collection of message numbers"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-26",children:"Description"}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:["This function is based upon the specification for the ",(0,t.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol",children:"IMAP protocol"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".searchMails()"})," function searches for messages that match the given ",(0,t.jsx)(s.em,{children:"searchCriteria"})," in the current mailbox. ",(0,t.jsx)(s.em,{children:"searchCriteria"})," consists of one or more search keys."]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.em,{children:"searchCriteria"})," is a string parameter listing one or more search keys (see ",(0,t.jsx)(s.a,{href:"#authorized-search-keys",children:"Authorized search-keys"})," below) associated or not with values to look for. A search key may be a single or multiple items. For example:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"SearchKey1 = FLAGGED\nSearchKey2 = NOT FLAGGED\nSearchKey3 = FLAGGED DRAFT\n"})}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:"Matching is usually not case-sensitive"}),"\n"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["If the ",(0,t.jsx)(s.em,{children:"searchCriteria"})," is a null string, the search will be equivalent to a \u201Cselect all\u201D."]}),"\n",(0,t.jsxs)(s.li,{children:["If the ",(0,t.jsx)(s.em,{children:"searchCriteria"})," includes multiple search keys, the result is the intersection (AND function) of all the messages that match those keys."]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'searchCriteria = FLAGGED FROM "SMITH"\n'})}),"\n",(0,t.jsx)(s.p,{children:"... returns all messages with \\Flagged flag set AND sent by Smith."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["You can use the ",(0,t.jsx)(s.strong,{children:"OR"})," or ",(0,t.jsx)(s.strong,{children:"NOT"})," operators as follows:"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"searchCriteria = OR SEEN FLAGGED\n"})}),"\n",(0,t.jsx)(s.p,{children:"... returns all messages with \\Seen flag set OR \\Flagged flag set"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"searchCriteria = NOT SEEN\n"})}),"\n",(0,t.jsx)(s.p,{children:"... returns all messages with \\Seen flag not set."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'searchCriteria = HEADER CONTENT-TYPE "MIXED" NOT HEADER CONTENT-TYPE "TEXT"...\n'})}),"\n",(0,t.jsx)(s.p,{children:"... returns message whose content-type header contains \u201CMixed\u201D and does not contain \u201Cstring\u201D."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'searchCriteria = HEADER CONTENT-TYPE "E" NOT SUBJECT "o" NOT HEADER CONTENT-TYPE "MIXED"\n'})}),"\n",(0,t.jsx)(s.p,{children:"... returns message whose content-type header contains \u201C e \u201D and whose Subject header does not contain \u201C o \u201D and whose content-type header is not \u201C Mixed \u201D."}),"\n",(0,t.jsx)(s.p,{children:"As concerns the last two examples, notice that the result of the search is different when you remove the parentheses of the first search key list."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.em,{children:"searchCriteria"}),' may include the optional [CHARSET] specification. This consists of the "CHARSET" word followed by a registered [CHARSET] (US ASCII, ISO-8859). It indicates the charset of the ',(0,t.jsx)(s.em,{children:"searchCriteria"})," string. Therefore, you must convert the ",(0,t.jsx)(s.em,{children:"searchCriteria"})," string into the specified charset if you use the [CHARSET] specification (see the ",(0,t.jsx)(s.code,{children:"CONVERT FROM TEXT"})," or ",(0,t.jsx)(s.code,{children:"Convert to string"})," commands).\nBy default, 4D encodes in Quotable Printable the searchCriteria string if it contains extended characters."]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'searchCriteria = CHARSET "ISO-8859" BODY "Help"\n'})}),"\n",(0,t.jsx)(s.p,{children:"... means the search criteria uses the charset iso-8859 and the server will have to convert the search criteria before searching, if necessary."}),"\n",(0,t.jsx)(s.h4,{id:"search-value-types",children:"Search value types"}),"\n",(0,t.jsx)(s.p,{children:"Search-keys may request the value to search for:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Search-keys with a date value"}),": the date is a string that must be formatted as follows: ",(0,t.jsx)(s.em,{children:'date-day+"-"+date-month+"-"+date-year'})," where date-day indicates the number of the day of the month (max. 2 characters), date-month indicates the name of the month (Jan/Feb/Mar/Apr/May/Jun/Jul/Aug/Sep/Oct/Dec) and date-year indicates the year (4 characters).\nExample: ",(0,t.jsx)(s.code,{children:"searchCriteria = SENTBEFORE 1-Feb-2020"})," (a date does not usually need to be quoted since it does not contain any special characters)"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Search-keys with a string value"}),": the string may contain any character and must be quoted. If the string does not contain any special characters, like the space character for instance, it does not need to be quoted. Quoting such strings will ensure that your string value will be correctly interpreted.\nExample: ",(0,t.jsx)(s.code,{children:'searchCriteria = FROM "SMITH"'}),"\nFor all search keys that use strings, a message matches the key if the string is a substring of the field. Matching is not case-sensitive."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Search-keys with a field-name value"}),": the field-name is the name of a header field.\nExample: ",(0,t.jsx)(s.code,{children:'searchCriteria = HEADER CONTENT-TYPE "MIXED"'})]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Search-keys with a flag value"}),": the flag may accept one or several keywords (including standard flags), separated by spaces.\nExample: ",(0,t.jsx)(s.code,{children:"searchCriteria = KEYWORD \\Flagged \\Draft"})]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Search-keys with a message set value"}),": Identifies a set of messages. For message sequence numbers, these are consecutive numbers from 1 to the total number of messages in the mailbox. A comma delimits individual numbers, a colon delimits between two numbers inclusive.\nExamples:\n",(0,t.jsx)(s.code,{children:"2,4:7,9,12:*"})," is ",(0,t.jsx)(s.code,{children:"2,4,5,6,7,9,12,13,14,15"})," for a mailbox with 15 messages.\n",(0,t.jsx)(s.code,{children:"searchCriteria = 1:5 ANSWERED"})," search in message selection from message sequence number 1 to 5 for messages which have the \\Answered flag set.\n",(0,t.jsx)(s.code,{children:"searchCriteria =  2,4 ANSWERED"})," search in the message selection (message numbers 2 and 4) for messages which have the \\Answered flag set."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"authorized-search-keys",children:"Authorized search-keys"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"ALL"}),": All messages in the mailbox.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"ANSWERED"}),": Messages with the \\Answered flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"UNANSWERED"}),": Messages that do not have the \\Answered flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"DELETED"}),": Messages with the \\Deleted flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"UNDELETED"}),": Messages that do not have the \\Deleted flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"DRAFT"}),": Messages with the \\Draft flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"UNDRAFT"}),": Messages that do not have the \\Draft flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"FLAGGED"}),": Messages with the \\Flagged flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"UNFLAGGED"}),": Messages that do not have the \\Flagged flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"RECENT"}),": Messages that have the \\Recent flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"OLD"}),": Messages that do not have the \\Recent flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"SEEN"}),": Messages that have the \\Seen flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"UNSEEN"}),": Messages that do not have the \\Seen flag set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsx)(s.strong,{children:"NEW"}),": Messages that have the \\Recent flag set but not the \\Seen flag. This is functionally equivalent to \u201C(RECENT UNSEEN)\u201D.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["KEYWORD ",(0,t.jsx)(s.em,{children:"flag"})]}),": Messages with the specified keyword set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["UNKEYWORD ",(0,t.jsx)(s.em,{children:"flag"})]}),": Messages that do not have the specified keyword set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["BEFORE ",(0,t.jsx)(s.em,{children:"date"})]}),": Messages whose internal date is earlier than the specified date.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["ON ",(0,t.jsx)(s.em,{children:"date"})]}),": Messages whose internal date is within the specified date.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["SINCE ",(0,t.jsx)(s.em,{children:"date"})]}),": Messages whose internal date is within or later than the specified date.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["SENTBEFORE ",(0,t.jsx)(s.em,{children:"date"})]}),": Messages whose Date header is earlier than the specified date.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["SENTON ",(0,t.jsx)(s.em,{children:"date"})]}),": Messages whose Date header is within the specified date.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["SENTSINCE ",(0,t.jsx)(s.em,{children:"date"})]}),": Messages whose Date header is within or later than the specified date.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["TO ",(0,t.jsx)(s.em,{children:"string"})]}),": Messages that contain the specified string in the TO header.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["FROM ",(0,t.jsx)(s.em,{children:"string"})]}),": Messages that contain the specified string in the FROM header.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["CC ",(0,t.jsx)(s.em,{children:"string"})]}),": Messages that contain the specified string in the CC header.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["BCC ",(0,t.jsx)(s.em,{children:"string"})]}),": Messages that contain the specified string in the BCC header.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["SUBJECT ",(0,t.jsx)(s.em,{children:"string"})]}),": Messages that contain the specified string in the Subject header.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["BODY ",(0,t.jsx)(s.em,{children:"string"})]}),": Messages that contain the specified string in the message body.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["TEXT ",(0,t.jsx)(s.em,{children:"string"})]}),": Messages that contain the specified string in the header or in the message body.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["HEADER ",(0,t.jsx)(s.em,{children:"field-name"})," ",(0,t.jsx)(s.em,{children:"string"})]}),": Messages that have a header with the specified field-name and that contain the specified string in the field-body.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["UID ",(0,t.jsx)(s.em,{children:"message-UID"})]}),": Messages with unique identifiers corresponding to the specified unique identifier set.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["LARGER ",(0,t.jsx)(s.em,{children:"n"})]}),": Messages with a size larger than the specified number of bytes.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["SMALLER ",(0,t.jsx)(s.em,{children:"n"})]}),": Messages with a size smaller than the specified number of bytes.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["NOT ",(0,t.jsx)(s.em,{children:"search-key"})]}),": Messages that do not match the specified search key.",(0,t.jsx)(s.br,{}),"\n",(0,t.jsxs)(s.strong,{children:["OR ",(0,t.jsx)(s.em,{children:"search-key1"})," ",(0,t.jsx)(s.em,{children:"search-key2"})]}),": Messages that match either search key."]}),"\n",(0,t.jsx)(s.h2,{id:"selectbox",children:".selectBox()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".selectBox"}),"( ",(0,t.jsx)(s.em,{children:"name"})," : string { , ",(0,t.jsx)(s.em,{children:"state"})," : integer } ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"name"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Name of the mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"state"}),(0,t.jsx)(s.td,{children:"integer"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Mailbox access status"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"boxInfo object"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-27",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".selectBox()"})," function selects the ",(0,t.jsx)(s.em,{children:"name"})," mailbox as the current mailbox. This function allows you to retrieve information about the mailbox."]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:["To get the information from a mailbox without changing the current mailbox, use ",(0,t.jsx)(s.a,{href:"#getboxinfo",children:(0,t.jsx)(s.code,{children:".getBoxInfo()"})}),"."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"name"})," parameter, pass the name of the mailbox to access. The name represents an unambiguous left-to-right hierarchy with levels separated by a specific delimiter character. The delimiter can be found with the ",(0,t.jsx)(s.a,{href:"#getdelimiter",children:(0,t.jsx)(s.code,{children:".getDelimiter()"})})," function."]}),"\n",(0,t.jsxs)(s.p,{children:["The optional ",(0,t.jsx)(s.em,{children:"state"})," parameter defines the type of access to the mailbox. The possible values are:"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Constant"}),(0,t.jsx)(s.th,{children:"Value"}),(0,t.jsx)(s.th,{children:"Comment"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"IMAP read only state"}),(0,t.jsx)(s.td,{children:"1"}),(0,t.jsx)(s.td,{children:'The selected mailbox is accessed with read only privileges. Messages with a "recent" flag (indicating new messages) remain unchanged.'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"IMAP read write state"}),(0,t.jsx)(s.td,{children:"0"}),(0,t.jsx)(s.td,{children:'The selected mailbox is accessed with read and write privileges. Messages are considered "seen" and lose the "recent" flag (indicating new messages). (Default value)'})]})]})]}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The function generates an error and returns ",(0,t.jsx)(s.strong,{children:"Null"})," if ",(0,t.jsx)(s.em,{children:"name"})," designates a non-existing mailbox."]}),"\n",(0,t.jsxs)(s.li,{children:["If there is no open connection, ",(0,t.jsx)(s.code,{children:".selectBox()"})," will open a connection."]}),"\n",(0,t.jsxs)(s.li,{children:["If the connection has not been used since the designated connection delay (see ",(0,t.jsx)(s.code,{children:"4D.IMAPTransporter.new"}),"), the ",(0,t.jsx)(s.a,{href:"#checkconnection",children:(0,t.jsx)(s.code,{children:".checkConnection()"})})," function is automatically called."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"boxInfo"})," object returned contains the following properties:"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"name"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Name of the mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"mailCount"}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:"Number of messages in the mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"mailRecent"}),(0,t.jsx)(s.td,{children:"number"}),(0,t.jsx)(s.td,{children:'Number of messages with the "recent" flag'})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"id"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Unique id of the mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"flags"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"List of flags currently used for the mailbox, separated by spaces"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"permanentFlags"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"List of flags that the client can change permanently (except for the \\Recent flag, which is managed by the IMAP server), separated by spaces"})]})]})]}),"\n",(0,t.jsx)(s.admonition,{type:"info",children:(0,t.jsxs)(s.p,{children:["If ",(0,t.jsx)(s.code,{children:"permanentFlags"})," string includes the special flag *, it means that the server supports ",(0,t.jsx)(s.a,{href:"#addflags",children:"custom flags"}),"."]})}),"\n",(0,t.jsx)(s.h4,{id:"example-15",children:"Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:' var server, boxinfo : object\n var transporter : 4D.IMAPTransporter\n server = newObject()\n server.host = "imap.gmail.com" //Mandatory\n server.user = "4d@gmail.com"\n server.password = "XXXXXXXX"\n\n transporter = 4D.IMAPTransporter.new(server)\n boxInfo = transporter.selectBox("INBOX")\n'})}),"\n",(0,t.jsx)(s.h2,{id:"subscribe",children:".subscribe()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".subscribe"}),"( ",(0,t.jsx)(s.em,{children:"name"})," : string ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"name"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Name of the mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the subscribe operation"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-28",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".subscribe()"})," function allows adding or removing of the specified mailbox to/from the IMAP server\u2019s set of \u201Csubscribed\u201D mailboxes. As such, you can choose to narrow down a large list of available mailboxes by subscribing to those you usually want to see."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.em,{children:"name"}),' parameter, pass the name of the mailbox to add (subscribe) to your "subscribed" mailboxes.']}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"Number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-16",children:"Example"}),"\n",(0,t.jsx)(s.p,{children:'To subscribe to the "Atlas Corp" mailbox in the "Bills" hierarchy:'}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:'var name, info : string\nvar options, status : object\nvar transporter : 4D.IMAPTransporter\n\noptions = newObject()\n\noptions.host = "imap.gmail.com"\noptions.user = "test@gmail.com"\noptions.password = "XXXXXX"\n\ntransporter = 4D.IMAPTransporter.new(options)\n\nname = "Bills"+transporter.getDelimiter()+"Atlas Corp"\nstatus = transporter.subscribe(name)\n\nif(status.success)\n   info = "Mailbox subscription successful!"\nelse\n   info = "Error: "+status.statusText\nend\n'})}),"\n",(0,t.jsx)(s.h2,{id:"unsubscribe",children:".unsubscribe()"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".unsubscribe"}),"( ",(0,t.jsx)(s.em,{children:"name"})," : string ) : object"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Parameter"}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{style:{textAlign:"center"}}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"name"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2192"}),(0,t.jsx)(s.td,{children:"Name of the mailbox"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Result"}),(0,t.jsx)(s.td,{children:"object"}),(0,t.jsx)(s.td,{style:{textAlign:"center"},children:"\u2190"}),(0,t.jsx)(s.td,{children:"Status of the unsubscribe operation"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"description-29",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".unsubscribe()"})," function removes a mailbox from a set of subscribed mailboxes. This allows you reduce the number of mailboxes you usually see."]}),"\n",(0,t.jsxs)(s.p,{children:["In the ",(0,t.jsx)(s.code,{children:"name"})," parameter, pass the name of the mailbox to remove (unsubscribe) from your active mailboxes."]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Returned object"})}),"\n",(0,t.jsx)(s.p,{children:"The function returns an object describing the IMAP status:"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Property"}),(0,t.jsx)(s.th,{}),(0,t.jsx)(s.th,{children:"Type"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"success"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"boolean"}),(0,t.jsx)(s.td,{children:"true if the operation is successful, False otherwise"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"statusText"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Status message returned by the IMAP server, or last error returned in the Qodly error stack"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"errors"}),(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"collection"}),(0,t.jsx)(s.td,{children:"Qodly error stack (not returned if a IMAP server response is received)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].errcode"}),(0,t.jsx)(s.td,{children:"Number"}),(0,t.jsx)(s.td,{children:"Qodly error code"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].message"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Description of the Qodly error"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{}),(0,t.jsx)(s.td,{children:"[].componentSignature"}),(0,t.jsx)(s.td,{children:"string"}),(0,t.jsx)(s.td,{children:"Signature of the internal component which returned the error"})]})]})]}),"\n",(0,t.jsx)(s.h4,{id:"example-17",children:"Example"}),"\n",(0,t.jsx)(s.p,{children:'To unsubscribe from the "Atlas Corp\u201D mailbox in the "Bills" hierarchy:'}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-qs",children:'var info, name : string\nvar options, status : object\nvar transporter : 4D.IMAPTransporter\n\noptions = newObject()\n\n\noptions.host = "imap.gmail.com"\noptions.user = "test@gmail.com"\noptions.password = pw\n\ntransporter = 4D.IMAPTransporter.new(options)\n\nname = "Bills"+transporter.getDelimiter()+"Atlas Corp"\nstatus = transporter.unsubscribe(name)\n\nif(status.success)\n   info = "Mailbox unsubscription successful!"\nelse\n   info = "Error: "+status.statusText\nend\n'})}),"\n",(0,t.jsx)(s.h2,{id:"user",children:".user"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:".user"})," : string"]}),"\n",(0,t.jsx)(s.h4,{id:"description-30",children:"Description"}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:".user"})," property contains  the user name used for authentication on the mail server."]})]})}function a(e={}){let{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},50065:function(e,s,n){n.d(s,{Z:function(){return d},a:function(){return l}});var r=n(67294);let t={},i=r.createContext(t);function l(e){let s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);