"use strict";(self.webpackChunkqodly=self.webpackChunkqodly||[]).push([["37676"],{21865:function(e,n,r){r.r(n),r.d(n,{metadata:()=>t,contentTitle:()=>l,default:()=>o,assets:()=>c,toc:()=>h,frontMatter:()=>d});var t=JSON.parse('{"id":"api/$queryplan","title":"$queryplan","description":"Functionality","source":"@site/versioned_docs/version-1.1.0/api/$queryplan.md","sourceDirName":"api","slug":"/api/$queryplan","permalink":"/docs/api/$queryplan","draft":false,"unlisted":false,"editUrl":"https://github.com/qodly/docs/issues/new?title=Comment%20on%20api%2F%24queryplan.md%20(1.1.0)&body=Share%20any%20feedback%20about%20this%20page%20%E2%80%94%20report%20issues%2C%20suggest%20improvements%2C%20or%20tell%20us%20what%E2%80%99s%20helpful.%0A%0AIf%20it%E2%80%99s%20an%20issue%3A%0A-%20What%E2%80%99s%20the%20issue%3F%20(e.g.%2C%20typo%2C%20incorrect%20information%2C%20unclear%20explanation)%0A-%20Where%20is%20it%3F%20(e.g.%2C%20section%20name%2C%20specific%20paragraph%2C%20or%20line)%0A%0AThank%20you%20for%20helping%20us%20improve!%20%F0%9F%9A%80%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20","tags":[],"version":"1.1.0","frontMatter":{"id":"$queryplan","title":"$queryplan"},"sidebar":"Integrations","previous":{"title":"$orderby","permalink":"/docs/api/$orderby"},"next":{"title":"$querypath","permalink":"/docs/api/$querypath"}}'),i=r("85893"),s=r("50065");let d={id:"$queryplan",title:"$queryplan"},l=void 0,c={},h=[{value:"Functionality",id:"functionality",level:2},{value:"Definition",id:"definition",level:3},{value:"Syntax",id:"syntax",level:3},{value:"Properties Returned",id:"properties-returned",level:2},{value:"General Properties",id:"general-properties",level:3},{value:"<code>__queryPlan</code> Details",id:"__queryplan-details",level:3},{value:"Within <code>And</code> Array",id:"within-and-array",level:4},{value:"<code>__extendedQueryPlan</code> Details",id:"__extendedqueryplan-details",level:3},{value:"Within <code>parts</code> Array",id:"within-parts-array",level:4},{value:"<code>__ENTITIES</code> Details",id:"__entities-details",level:3},{value:"Combining with Other Parameters",id:"combining-with-other-parameters",level:2},{value:"Sample Usage in Postman",id:"sample-usage-in-postman",level:2},{value:"Sample Response",id:"sample-response",level:2}];function a(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"functionality",children:"Functionality"}),"\n",(0,i.jsx)(n.h3,{id:"definition",children:"Definition"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"$queryplan"})," endpoint is designed to provide insights into the execution strategy of queries processed by the server. This endpoint helps developers and database administrators to analyze and optimize query performance by returning a detailed breakdown of the query execution plan."]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["For additional information, please consult the ",(0,i.jsx)(n.a,{href:"../language/DataClassClass#about-queryplan-and-querypath",children:'"About queryPlan and queryPath"'})," documentation."]})}),"\n",(0,i.jsx)(n.h3,{id:"syntax",children:"Syntax"}),"\n",(0,i.jsxs)(n.p,{children:["To use the ",(0,i.jsx)(n.code,{children:"$queryplan"})," parameter, use the following syntax:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"GET /rest/{{dataClass}}/?$queryplan=true\n"})}),"\n",(0,i.jsx)(n.h2,{id:"properties-returned",children:"Properties Returned"}),"\n",(0,i.jsx)(n.h3,{id:"general-properties",children:"General Properties"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"$queryplan"})," endpoint returns structured information as outlined in the following table:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Property"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#__queryplan-details",children:(0,i.jsx)(n.code,{children:"__queryPlan"})})}),(0,i.jsx)(n.td,{children:"Object"}),(0,i.jsx)(n.td,{children:"Simplified overview of the query execution plan."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#__extendedqueryplan-details",children:(0,i.jsx)(n.code,{children:"__extendedQueryPlan"})})}),(0,i.jsx)(n.td,{children:"Object"}),(0,i.jsx)(n.td,{children:"Detailed structured representation of the query execution plan."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"__DATACLASS"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Specifies the data class targeted by the query."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"__entityModel"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Specifies the entity model used in the query."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"__GlobalStamp"})}),(0,i.jsx)(n.td,{children:"Integer"}),(0,i.jsx)(n.td,{children:"Server-wide modification timestamp."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"__COUNT"})}),(0,i.jsx)(n.td,{children:"Integer"}),(0,i.jsx)(n.td,{children:"Number of entities affected by the query."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"__FIRST"})}),(0,i.jsx)(n.td,{children:"Integer"}),(0,i.jsx)(n.td,{children:"Index of the first entity in the query results."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#__entities-details",children:(0,i.jsx)(n.code,{children:"__ENTITIES"})})}),(0,i.jsx)(n.td,{children:"Array"}),(0,i.jsx)(n.td,{children:"Detailed data about the entities affected by the query."})]})]})]}),"\n",(0,i.jsxs)(n.h3,{id:"__queryplan-details",children:[(0,i.jsx)(n.code,{children:"__queryPlan"})," Details"]}),"\n",(0,i.jsx)(n.p,{children:"This section simplifies the query execution paths:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Key"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#within-and-array",children:(0,i.jsx)(n.code,{children:"And"})})}),(0,i.jsx)(n.td,{children:"Array"}),(0,i.jsx)(n.td,{children:"Array of conditions combined with a logical AND operator."})]})})]}),"\n",(0,i.jsxs)(n.h4,{id:"within-and-array",children:["Within ",(0,i.jsx)(n.code,{children:"And"})," Array"]}),"\n",(0,i.jsx)(n.p,{children:"Details of conditions and subqueries:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Key"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"item"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Description of the query condition or join operation."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"subquery"})}),(0,i.jsx)(n.td,{children:"Array"}),(0,i.jsx)(n.td,{children:"Details of any subqueries related to the condition."})]})]})]}),"\n",(0,i.jsxs)(n.h3,{id:"__extendedqueryplan-details",children:[(0,i.jsx)(n.code,{children:"__extendedQueryPlan"})," Details"]}),"\n",(0,i.jsx)(n.p,{children:"Provides a more intricate view of the query execution strategy:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Key"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"type"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["Type of node in the query plan, e.g., ",(0,i.jsx)(n.code,{children:"LogicOperatorNode"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"logicOper"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["Logical operator used, e.g., ",(0,i.jsx)(n.code,{children:"And"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"#within-parts-array",children:(0,i.jsx)(n.code,{children:"parts"})})}),(0,i.jsx)(n.td,{children:"Array"}),(0,i.jsx)(n.td,{children:"Details of operations performed in the query plan."})]})]})]}),"\n",(0,i.jsxs)(n.h4,{id:"within-parts-array",children:["Within ",(0,i.jsx)(n.code,{children:"parts"})," Array"]}),"\n",(0,i.jsx)(n.p,{children:"Complex operations within the query:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Key"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"type"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["Specific type of operation, e.g., ",(0,i.jsx)(n.code,{children:"JoinNode"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"targetTable"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Target table for the operation."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"joinPath"})}),(0,i.jsx)(n.td,{children:"Array"}),(0,i.jsx)(n.td,{children:"Details of the join path used in the operation."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"filter"})}),(0,i.jsx)(n.td,{children:"Object"}),(0,i.jsx)(n.td,{children:"Filter conditions applied within the operation."})]})]})]}),"\n",(0,i.jsxs)(n.h3,{id:"__entities-details",children:[(0,i.jsx)(n.code,{children:"__ENTITIES"})," Details"]}),"\n",(0,i.jsx)(n.p,{children:"Information about the entities affected by the query:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Key"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"__KEY"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Unique key for the entity."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"__TIMESTAMP"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"Timestamp of the last update to the entity."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"__STAMP"})}),(0,i.jsx)(n.td,{children:"Integer"}),(0,i.jsx)(n.td,{children:"Version stamp for the entity."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ID"})}),(0,i.jsx)(n.td,{children:"Integer"}),(0,i.jsx)(n.td,{children:"Identifier of the entity."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Quantity"})}),(0,i.jsx)(n.td,{children:"Integer"}),(0,i.jsx)(n.td,{children:"Example attribute, e.g., quantity in an order."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Purchaser"})}),(0,i.jsx)(n.td,{children:"Object"}),(0,i.jsx)(n.td,{children:"Example attribute, e.g., details about the purchaser, using deferred loading."})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"combining-with-other-parameters",children:"Combining with Other Parameters"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"$queryplan"})," parameter can be combined with other parameters to gain insights into how queries are executed, which can help in optimizing performance:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"$filter"}),": Apply filters to the dataset to see how they affect the query plan."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"$orderby"}),": Observe how sorting impacts the execution plan."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"$top/$limit"})," and ",(0,i.jsx)(n.strong,{children:"$skip"}),": Check the effect of limiting and skipping records on the query execution."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"$expand"}),": Include related data and see how joining related tables or collections influences the query plan."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"$attributes"}),": Specify which attributes are included in the query and understand their impact on the query performance."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"$method"}),": Combine with various method operations to analyze their execution plans."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"$compute"}),": Evaluate the impact of computations on the query execution."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"$entityset"}),": Analyze the query plan for operations involving entity sets."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"$savedfilter"}),": Save and reuse filters to analyze their impact on the query plan."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"$savedorderby"}),": Save and reuse sorting criteria to analyze their impact on the query plan."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"sample-usage-in-postman",children:"Sample Usage in Postman"}),"\n",(0,i.jsx)(n.p,{children:"How to Use:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Method"}),": GET"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"URL"}),": ",(0,i.jsx)(n.code,{children:'/rest/Orders?$filter="Quantity > 4 AND Purchaser.Name = user2"&$queryplan=true'})]}),"\n"]}),"\n",(0,i.jsx)("img",{src:r(21241).Z,style:{borderRadius:"6px"}}),"\n",(0,i.jsx)(n.h2,{id:"sample-response",children:"Sample Response"}),"\n",(0,i.jsxs)(n.p,{children:["The response structure for the ",(0,i.jsx)(n.code,{children:"$queryplan"})," endpoint looks something like this in practice:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "__queryPlan": {\n        "And": [\n            {\n                "item": "Join on Table : Users  :  Orders.Purchaser = Users.ID",\n                "subquery": [\n                    {\n                        "item": "Users.Name === user2"\n                    }\n                ]\n            },\n            {\n                "item": "Orders.Quantity > 4"\n            }\n        ]\n    },\n    "__extendedQueryPlan": {\n        "type": "LogicOperatorNode",\n        "logicOper": "And",\n        "parts": [\n            {\n                "type": "JoinNode",\n                "targetTable": "Users",\n                "instance": 0,\n                "joinPath": [\n                    {\n                        "leftTable": "Orders",\n                        "leftField": "Purchaser",\n                        "leftInstance": 0,\n                        "rightTable": "Users",\n                        "rightField": "ID",\n                        "rightInstance": 0\n                    }\n                ],\n                "filter": {\n                    "type": "SeqNode",\n                    "field": "Name",\n                    "table": "Users",\n                    "instance": 0,\n                    "oper": " === ",\n                    "value": "user2"\n                }\n            },\n            {\n                "type": "SeqNode",\n                "field": "Quantity",\n                "table": "Orders",\n                "instance": 0,\n                "oper": " > ",\n                "value": 4\n            }\n        ]\n    },\n    "__DATACLASS": "Orders",\n    "__entityModel": "Orders",\n    "__GlobalStamp": 0,\n    "__COUNT": 1,\n    "__FIRST": 0,\n    "__ENTITIES": [\n        {\n            "__KEY": "20",\n            "__TIMESTAMP": "2024-05-09T17:01:36.995Z",\n            "__STAMP": 1,\n            "ID": 20,\n            "Quantity": 5,\n            "Purchaser": {\n                "__deferred": {\n                    "uri": "/rest/Users[2]",\n                    "__KEY": "2"\n                }\n            },\n            "OrderedProduct": {\n                "__deferred": {\n                    "uri": "/rest/Products[2]",\n                    "__KEY": "2"\n                }\n            },\n            "paymentsSelection": {\n                "__deferred": {\n                    "uri": "/rest/Orders[20]/paymentsSelection?$expand=paymentsSelection"\n                }\n            }\n        }\n    ],\n    "__SENT": 1\n}\n'})})]})}function o(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},21241:function(e,n,r){r.d(n,{Z:function(){return t}});let t=r.p+"assets/images/restQueryPlan-f3832d83a03409b5cf2306182a57e461.png"},50065:function(e,n,r){r.d(n,{Z:function(){return l},a:function(){return d}});var t=r(67294);let i={},s=t.createContext(i);function d(e){let n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);