"use strict";(self.webpackChunkqodly=self.webpackChunkqodly||[]).push([[6011],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>N});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=a.createContext({}),o=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=o(e.components);return a.createElement(d.Provider,{value:t},e.children)},s="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},k=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,d=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),s=o(n),k=r,N=s["".concat(d,".").concat(k)]||s[k]||m[k]||l;return n?a.createElement(N,i(i({ref:t},u),{},{components:n})):a.createElement(N,i({ref:t},u))}));function N(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,i=new Array(l);i[0]=k;var p={};for(var d in t)hasOwnProperty.call(t,d)&&(p[d]=t[d]);p.originalType=e,p[s]="string"==typeof e?e:r,i[1]=p;for(var o=2;o<l;o++)i[o]=n[o];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}k.displayName="MDXCreateElement"},59718:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>s,frontMatter:()=>l,metadata:()=>p,toc:()=>o});var a=n(87462),r=(n(67294),n(3905));const l={id:"$querypath",title:"$querypath"},i="Tracing Query Execution Paths",p={unversionedId:"api/$querypath",id:"api/$querypath",title:"$querypath",description:"Overview",source:"@site/docs/api/$querypath.md",sourceDirName:"api",slug:"/api/$querypath",permalink:"/docs/api/$querypath",draft:!1,editUrl:"https://github.com/docQodly/docs/edit/main/docs/api/$querypath.md",tags:[],version:"current",frontMatter:{id:"$querypath",title:"$querypath"},sidebar:"API",previous:{title:"$queryplan",permalink:"/docs/api/$queryplan"}},d={},o=[{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Properties Returned",id:"properties-returned",level:2},{value:"General Properties",id:"general-properties",level:3},{value:"<code>__queryPath</code> Details",id:"__querypath-details",level:3},{value:"Within <code>steps</code> Array",id:"within-steps-array",level:3},{value:"<code>__extendedQueryPlan</code> Details",id:"__extendedqueryplan-details",level:3},{value:"Within <code>parts</code> Array",id:"within-parts-array",level:4},{value:"<code>__ENTITIES</code> Details",id:"__entities-details",level:3},{value:"Sample Usage in Postman",id:"sample-usage-in-postman",level:2},{value:"Sample Response",id:"sample-response",level:2}],u={toc:o};function s(e){let{components:t,...l}=e;return(0,r.kt)("wrapper",(0,a.Z)({},u,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"tracing-query-execution-paths"},"Tracing Query Execution Paths"),(0,r.kt)("h2",{id:"overview"},"Overview"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"$querypath")," endpoint allows developers to understand how queries are executed in the backend. It provides a step-by-step breakdown of the query execution, showing each operation, its performance, and the results obtained at each stage. It also reveales optimization techniques and the exact path taken by the server to fetch the required data."),(0,r.kt)("h2",{id:"key-features"},"Key Features"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"$querypath")," not only reflects the intended query operations but also how these operations are actually executed, including dynamic optimizations that the server might apply during runtime. For instance, an indexed search may be converted to a sequential scan based on real-time performance assessments, which can significantly alter the execution path. This feature is particularly useful in scenarios where the dataset is small, and a full scan might prove faster than indexed access, allowing developers to see and understand these optimizations directly in the query path output."),(0,r.kt)("h2",{id:"properties-returned"},"Properties Returned"),(0,r.kt)("h3",{id:"general-properties"},"General Properties"),(0,r.kt)("p",null,"The response from the ",(0,r.kt)("inlineCode",{parentName:"p"},"$querypath")," endpoint is structured to provide a detailed insight into the query execution process:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"__queryPath")),(0,r.kt)("td",{parentName:"tr",align:null},"Object"),(0,r.kt)("td",{parentName:"tr",align:null},"Contains the detailed steps taken to execute the query.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"__extendedQueryPath")),(0,r.kt)("td",{parentName:"tr",align:null},"Object"),(0,r.kt)("td",{parentName:"tr",align:null},"Provides an advanced, detailed logical structure of the query execution.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"__DATACLASS")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"The data class targeted by the query.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"__entityModel")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"The entity model used during the query.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"__GlobalStamp")),(0,r.kt)("td",{parentName:"tr",align:null},"Integer"),(0,r.kt)("td",{parentName:"tr",align:null},"Global modification timestamp indicating the last update across the server.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"__COUNT")),(0,r.kt)("td",{parentName:"tr",align:null},"Integer"),(0,r.kt)("td",{parentName:"tr",align:null},"Number of entities returned by the query.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"__FIRST")),(0,r.kt)("td",{parentName:"tr",align:null},"Integer"),(0,r.kt)("td",{parentName:"tr",align:null},"Index of the first returned entity.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"__ENTITIES")),(0,r.kt)("td",{parentName:"tr",align:null},"Array"),(0,r.kt)("td",{parentName:"tr",align:null},"Detailed information about the entities affected by the query.")))),(0,r.kt)("h3",{id:"__querypath-details"},(0,r.kt)("inlineCode",{parentName:"h3"},"__queryPath")," Details"),(0,r.kt)("p",null,"Detailed information about the steps involved in the query:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Key"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#within-steps-array"},(0,r.kt)("inlineCode",{parentName:"a"},"steps"))),(0,r.kt)("td",{parentName:"tr",align:null},"Array"),(0,r.kt)("td",{parentName:"tr",align:null},"An array containing detailed steps of the query execution process.")))),(0,r.kt)("h3",{id:"within-steps-array"},"Within ",(0,r.kt)("inlineCode",{parentName:"h3"},"steps")," Array"),(0,r.kt)("p",null,"Each step within the query execution path is detailed:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Key"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"description")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Describes the action taken, e.g., a join or filter operation.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"time")),(0,r.kt)("td",{parentName:"tr",align:null},"Number"),(0,r.kt)("td",{parentName:"tr",align:null},"Time in milliseconds taken to execute this part of the query.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"recordsfounds")),(0,r.kt)("td",{parentName:"tr",align:null},"Number"),(0,r.kt)("td",{parentName:"tr",align:null},"Number of records found as a result of this step.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"steps")),(0,r.kt)("td",{parentName:"tr",align:null},"Array"),(0,r.kt)("td",{parentName:"tr",align:null},"Nested steps detailing sub-operations or subsequent actions in the query path.")))),(0,r.kt)("h3",{id:"__extendedqueryplan-details"},(0,r.kt)("inlineCode",{parentName:"h3"},"__extendedQueryPlan")," Details"),(0,r.kt)("p",null,"Provides a more intricate view of the query execution strategy:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Key"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"type")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Type of node in the query plan, e.g., ",(0,r.kt)("inlineCode",{parentName:"td"},"LogicOperatorNode"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"logicOper")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Logical operator used, e.g., ",(0,r.kt)("inlineCode",{parentName:"td"},"And"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#within-parts-array"},(0,r.kt)("inlineCode",{parentName:"a"},"parts"))),(0,r.kt)("td",{parentName:"tr",align:null},"Array"),(0,r.kt)("td",{parentName:"tr",align:null},"Details of operations performed in the query plan.")))),(0,r.kt)("h4",{id:"within-parts-array"},"Within ",(0,r.kt)("inlineCode",{parentName:"h4"},"parts")," Array"),(0,r.kt)("p",null,"Each element in the ",(0,r.kt)("inlineCode",{parentName:"p"},"parts")," array represents a detailed aspect of the query execution:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Key"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"type")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Specifies the type of operation, like ",(0,r.kt)("inlineCode",{parentName:"td"},"JoinNode")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"SeqNode"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"field")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Field involved in this part of the query.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"table")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Table that the field belongs to.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"instance")),(0,r.kt)("td",{parentName:"tr",align:null},"Integer"),(0,r.kt)("td",{parentName:"tr",align:null},"Instance identifier for complex queries involving multiple uses of the same table.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"oper")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Operator used in the query, such as ",(0,r.kt)("inlineCode",{parentName:"td"},">")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"==="),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"value")),(0,r.kt)("td",{parentName:"tr",align:null},"Various"),(0,r.kt)("td",{parentName:"tr",align:null},"The value used in the operation, reflecting the filter or condition applied.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"timeTaken")),(0,r.kt)("td",{parentName:"tr",align:null},"Number"),(0,r.kt)("td",{parentName:"tr",align:null},"Execution time for this part of the query.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"foundRecords")),(0,r.kt)("td",{parentName:"tr",align:null},"Number"),(0,r.kt)("td",{parentName:"tr",align:null},"Number of records that matched this part of the query.")))),(0,r.kt)("h3",{id:"__entities-details"},(0,r.kt)("inlineCode",{parentName:"h3"},"__ENTITIES")," Details"),(0,r.kt)("p",null,"Information about the entities affected by the query:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Key"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"__KEY")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Unique key for the entity.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"__TIMESTAMP")),(0,r.kt)("td",{parentName:"tr",align:null},"String"),(0,r.kt)("td",{parentName:"tr",align:null},"Timestamp of the last update to the entity.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"__STAMP")),(0,r.kt)("td",{parentName:"tr",align:null},"Integer"),(0,r.kt)("td",{parentName:"tr",align:null},"Version stamp for the entity.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"ID")),(0,r.kt)("td",{parentName:"tr",align:null},"Integer"),(0,r.kt)("td",{parentName:"tr",align:null},"Identifier of the entity.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Quantity")),(0,r.kt)("td",{parentName:"tr",align:null},"Integer"),(0,r.kt)("td",{parentName:"tr",align:null},"Example attribute, e.g., quantity in an order.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"Purchaser")),(0,r.kt)("td",{parentName:"tr",align:null},"Object"),(0,r.kt)("td",{parentName:"tr",align:null},"Example attribute, e.g., details about the purchaser, using deferred loading.")))),(0,r.kt)("h2",{id:"sample-usage-in-postman"},"Sample Usage in Postman"),(0,r.kt)("p",null,"How to Use:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Method"),": GET"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"URL"),": ",(0,r.kt)("inlineCode",{parentName:"li"},'{{ApiEndpoint}}/rest/Orders/?$filter="Quantity > 4 AND Purchaser.Name = user2"&$querypath=true'))),(0,r.kt)("img",{alt:"explorer",src:n(62705).Z,style:{borderRadius:"6px"}}),(0,r.kt)("h2",{id:"sample-response"},"Sample Response"),(0,r.kt)("p",null,"The response structure for the ",(0,r.kt)("inlineCode",{parentName:"p"},"$querypath")," endpoint looks something like this in practice:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'\n{\n    "__queryPath": {\n        "steps": [\n            {\n                "description": "AND",\n                "time": 0,\n                "recordsfounds": 1,\n                "steps": [\n                    {\n                        "description": "Join on Table : Users  :  Orders.Purchaser = Users.ID",\n                        "time": 0,\n                        "recordsfounds": 1,\n                        "steps": [\n                            {\n                                "steps": [\n                                    {\n                                        "description": "Users.Name === user2",\n                                        "time": 0,\n                                        "recordsfounds": 1\n                                    }\n                                ]\n                            }\n                        ]\n                    },\n                    {\n                        "description": "Orders.Quantity > 4",\n                        "time": 0,\n                        "recordsfounds": 1\n                    }\n                ]\n            }\n        ]\n    },\n    "__extendedQueryPath": {\n        "type": "LogicOperatorNode",\n        "logicOper": "And",\n        "parts": [\n            {},\n            {\n                "type": "SeqNode",\n                "field": "Quantity",\n                "table": "Orders",\n                "instance": 0,\n                "oper": " > ",\n                "value": 4,\n                "timeTaken": 0,\n                "foundRecords": 1\n            }\n        ],\n        "timeTaken": 0,\n        "foundRecords": 1\n    },\n    "__DATACLASS": "Orders",\n    "__entityModel": "Orders",\n    "__GlobalStamp": 0,\n    "__COUNT": 1,\n    "__FIRST": 0,\n    "__ENTITIES": [\n        {\n            "__KEY": "20",\n            "__TIMESTAMP": "2024-05-09T17:01:36.995Z",\n            "__STAMP": 1,\n            "ID": 20,\n            "Quantity": 5,\n            "Purchaser": {\n                "__deferred": {\n                    "uri": "/rest/Users[2]",\n                    "__KEY": "2"\n                }\n            },\n            "OrderedProduct": {\n                "__deferred": {\n                    "uri": "/rest/Products[2]",\n                    "__KEY": "2"\n                }\n            },\n            "paymentsSelection": {\n                "__deferred": {\n                    "uri": "/rest/Orders[20]/paymentsSelection?$expand=paymentsSelection"\n                }\n            }\n        }\n    ],\n    "__SENT": 1\n}\n\n')))}s.isMDXComponent=!0},62705:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/restQueryPath-6f587968610a27074f1c29e7c1f2d450.png"}}]);