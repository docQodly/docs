"use strict";(self.webpackChunkqodly=self.webpackChunkqodly||[]).push([[2091],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>c});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},k=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,p=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),d=s(n),k=r,c=d["".concat(p,".").concat(k)]||d[k]||u[k]||l;return n?a.createElement(c,o(o({ref:t},m),{},{components:n})):a.createElement(c,o({ref:t},m))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=k;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[d]="string"==typeof e?e:r,o[1]=i;for(var s=2;s<l;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}k.displayName="MDXCreateElement"},31120:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>i,toc:()=>s});var a=n(87462),r=(n(67294),n(3905));const l={id:"POP3TransporterClass",title:"POP3Transporter"},o=void 0,i={unversionedId:"language/POP3TransporterClass",id:"language/POP3TransporterClass",title:"POP3Transporter",description:"The POP3Transporter class allows you to retrieve messages from a POP3 email server.",source:"@site/docs/language/POP3TransporterClass.md",sourceDirName:"language",slug:"/language/POP3TransporterClass",permalink:"/docs/language/POP3TransporterClass",draft:!1,editUrl:"https://github.com/docQodly/docs/edit/main/docs/language/POP3TransporterClass.md",tags:[],version:"current",frontMatter:{id:"POP3TransporterClass",title:"POP3Transporter"},sidebar:"Develop",previous:{title:"MailAttachment",permalink:"/docs/language/MailAttachmentClass"},next:{title:"Session",permalink:"/docs/language/SessionClass"}},p={},s=[{value:"Functions and properties",id:"functions-and-properties",level:3},{value:"4D.POP3Transporter.new()",id:"4dpop3transporternew",level:2},{value:"Description",id:"description",level:4},{value:"Result",id:"result",level:4},{value:"Example",id:"example",level:4},{value:".acceptUnsecureConnection",id:"acceptunsecureconnection",level:2},{value:"Description",id:"description-1",level:4},{value:".authenticationMode",id:"authenticationmode",level:2},{value:"Description",id:"description-2",level:4},{value:".checkConnection()",id:"checkconnection",level:2},{value:"Description",id:"description-3",level:4},{value:"Returned object",id:"returned-object",level:4},{value:"Example",id:"example-1",level:4},{value:".connectionTimeOut",id:"connectiontimeout",level:2},{value:"Description",id:"description-4",level:4},{value:".delete()",id:"delete",level:2},{value:"Description",id:"description-5",level:5},{value:"Example",id:"example-2",level:5},{value:".getBoxInfo()",id:"getboxinfo",level:2},{value:"Description",id:"description-6",level:5},{value:"Example",id:"example-3",level:5},{value:".getMail()",id:"getmail",level:2},{value:"Description",id:"description-7",level:5},{value:"Example",id:"example-4",level:5},{value:".getMailInfo()",id:"getmailinfo",level:2},{value:"Description",id:"description-8",level:5},{value:"Example",id:"example-5",level:5},{value:".getMailInfoList()",id:"getmailinfolist",level:2},{value:"Description",id:"description-9",level:5},{value:"number and ID properties",id:"number-and-id-properties",level:4},{value:"Example",id:"example-6",level:5},{value:".getMIMEAsBlob()",id:"getmimeasblob",level:2},{value:"Description",id:"description-10",level:5},{value:"Example",id:"example-7",level:5},{value:".host",id:"host",level:2},{value:"Description",id:"description-11",level:4},{value:".logFile",id:"logfile",level:2},{value:"Description",id:"description-12",level:4},{value:".port",id:"port",level:2},{value:"Description",id:"description-13",level:4},{value:".undeleteAll()",id:"undeleteall",level:2},{value:"Description",id:"description-14",level:5},{value:".user",id:"user",level:2},{value:"Description",id:"description-15",level:4}],m={toc:s};function d(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3Transporter")," class allows you to retrieve messages from a POP3 email server."),(0,r.kt)("h3",{id:"functions-and-properties"},"Functions and properties"),(0,r.kt)("p",null,"POP3 Transporter objects provide the following properties and functions:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null}))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#4dpop3transporternew"},(0,r.kt)("strong",{parentName:"a"},"4D.POP3Transporter.new"),"( ",(0,r.kt)("em",{parentName:"a"},"server")," : object ) : 4D.POP3Transporter"),(0,r.kt)("br",null),"configures a new POP3 connection")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#acceptunsecureconnection"},(0,r.kt)("strong",{parentName:"a"},".acceptUnsecureConnection")," : boolean"),(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"td"},"true")," if Qodly is allowed to establish an unencrypted connection")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#authenticationmode"},(0,r.kt)("strong",{parentName:"a"},".authenticationMode")," : string"),(0,r.kt)("br",null),"the authentication mode used to open the session on the mail server")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#checkconnection"},(0,r.kt)("strong",{parentName:"a"},".checkConnection()")," : object"),(0,r.kt)("br",null)," checks the connection using information stored in the transporter object")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#connectiontimeout"},(0,r.kt)("strong",{parentName:"a"},".connectionTimeOut")," : integer"),(0,r.kt)("br",null),"the maximum wait time (in seconds) allowed to establish a connection to the server")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#delete"},(0,r.kt)("strong",{parentName:"a"},".delete"),"( ",(0,r.kt)("em",{parentName:"a"},"msgNumber")," : integer )"),(0,r.kt)("br",null),"flags the ",(0,r.kt)("em",{parentName:"td"},"msgNumber")," email for deletion from the POP3 server")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#getboxinfo"},(0,r.kt)("strong",{parentName:"a"},".getBoxInfo()")," : object"),(0,r.kt)("br",null),"returns a ",(0,r.kt)("inlineCode",{parentName:"td"},"boxInfo")," object corresponding to the mailbox designated by the ",(0,r.kt)("inlineCode",{parentName:"td"},"POP3 transporter")," object")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#getmail"},(0,r.kt)("strong",{parentName:"a"},".getMail"),"( ",(0,r.kt)("em",{parentName:"a"},"msgNumber")," : integer { ; ",(0,r.kt)("em",{parentName:"a"},"headerOnly")," : boolean } ) : object"),(0,r.kt)("br",null),"returns the ",(0,r.kt)("inlineCode",{parentName:"td"},"Email")," object corresponding to the ",(0,r.kt)("em",{parentName:"td"},"msgNumber")," in the mailbox designated by the ",(0,r.kt)("a",{parentName:"td",href:"#pop3-transporter-object"},(0,r.kt)("inlineCode",{parentName:"a"},"POP3 transporter")))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#getmailinfo"},(0,r.kt)("strong",{parentName:"a"},".getMailInfo"),"( ",(0,r.kt)("em",{parentName:"a"},"msgNumber")," : integer ) : object"),(0,r.kt)("br",null),"returns a ",(0,r.kt)("inlineCode",{parentName:"td"},"mailInfo")," object corresponding  corresponding to the ",(0,r.kt)("em",{parentName:"td"},"msgNumber")," in the mailbox designated by the ",(0,r.kt)("inlineCode",{parentName:"td"},"POP3 transporter"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#getmailinfolist"},(0,r.kt)("strong",{parentName:"a"},".getMailInfoList()")," : collection"),(0,r.kt)("br",null),"returns a collection of ",(0,r.kt)("inlineCode",{parentName:"td"},"mailInfo")," objects describing all messages in the mailbox designated by the ",(0,r.kt)("inlineCode",{parentName:"td"},"POP3 transporter"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#getmimeasblob"},(0,r.kt)("strong",{parentName:"a"},".getMIMEAsBlob"),"( ",(0,r.kt)("em",{parentName:"a"},"msgNumber")," : integer ) : Blob"),(0,r.kt)("br",null),"returns a BLOB containing the MIME contents for the message corresponding to the ",(0,r.kt)("em",{parentName:"td"},"msgNumber")," in the mailbox designated by the ",(0,r.kt)("inlineCode",{parentName:"td"},"POP3_transporter"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#host"},(0,r.kt)("strong",{parentName:"a"},".host")," : string"),(0,r.kt)("br",null),"the name or the IP address of the host server")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#logfile"},(0,r.kt)("strong",{parentName:"a"},".logFile")," : string"),(0,r.kt)("br",null),"the path of the extended log file defined (if any) for the mail connection")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#port"},(0,r.kt)("strong",{parentName:"a"},".port")," : integer"),(0,r.kt)("br",null)," the port number used for mail transactions")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#undeleteall"},(0,r.kt)("strong",{parentName:"a"},".undeleteAll()")),(0,r.kt)("br",null),"removes all delete flags set on the emails in the ",(0,r.kt)("inlineCode",{parentName:"td"},"POP3_transporter")," object")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#user"},(0,r.kt)("strong",{parentName:"a"},".user")," : string"),(0,r.kt)("br",null)," the user name used for authentication on the mail server")))),(0,r.kt)("h2",{id:"4dpop3transporternew"},"4D.POP3Transporter.new()"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"4D.POP3Transporter.new"),"( ",(0,r.kt)("em",{parentName:"p"},"server")," : object ) : 4D.POP3Transporter"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:"center"}),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"server"),(0,r.kt)("td",{parentName:"tr",align:null},"object"),(0,r.kt)("td",{parentName:"tr",align:"center"},"->"),(0,r.kt)("td",{parentName:"tr",align:null},"Mail server information")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Result"),(0,r.kt)("td",{parentName:"tr",align:null},"4D.POP3Transporter"),(0,r.kt)("td",{parentName:"tr",align:"center"},"<-"),(0,r.kt)("td",{parentName:"tr",align:null},"POP3 transporter object")))),(0,r.kt)("h4",{id:"description"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"4D.POP3Transporter.new()")," function configures a new POP3 connectionaccording to the ",(0,r.kt)("em",{parentName:"p"},"server")," parameter and returns a new ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"#pop3-transporter-object"},"POP3 transporter"))," object. The returned transporter object will then usually be used to receive emails."),(0,r.kt)("p",null,"In the ",(0,r.kt)("em",{parentName:"p"},"server")," parameter, pass an object containing the following properties:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"th"},"server")),(0,r.kt)("th",{parentName:"tr",align:null},"Default value (if omitted)"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#acceptunsecureconnection"},(0,r.kt)("strong",{parentName:"a"},".acceptUnsecureConnection")," : boolean"),(0,r.kt)("br",null),(0,r.kt)("strong",{parentName:"td"},"true")," if Qodly is allowed to establish an unencrypted connection"),(0,r.kt)("td",{parentName:"tr",align:null},"false")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".",(0,r.kt)("strong",{parentName:"td"},"accessTokenOAuth2"),": string",(0,r.kt)("br",null),".",(0,r.kt)("strong",{parentName:"td"},"accessTokenOAuth2"),": object",(0,r.kt)("br",null),"string string or token object representing OAuth2 authorization credentials. Used only with OAUTH2 ",(0,r.kt)("inlineCode",{parentName:"td"},"authenticationMode"),". If ",(0,r.kt)("inlineCode",{parentName:"td"},"accessTokenOAuth2")," is used but ",(0,r.kt)("inlineCode",{parentName:"td"},"authenticationMode")," is omitted, the OAuth 2 protocol is used (if allowed by the server). Not returned in ",(0,r.kt)("em",{parentName:"td"},(0,r.kt)("a",{parentName:"em",href:"#smtptransporterobject"},"SMTP transporter"))," object."),(0,r.kt)("td",{parentName:"tr",align:null},"none")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#authenticationmode"},(0,r.kt)("strong",{parentName:"a"},".authenticationMode")," : string"),(0,r.kt)("br",null),"the authentication mode used to open the session on the mail server"),(0,r.kt)("td",{parentName:"tr",align:null},"the most secure authentication mode supported by the server is used")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#connectiontimeout"},(0,r.kt)("strong",{parentName:"a"},".connectionTimeOut")," : integer"),(0,r.kt)("br",null),"the maximum wait time (in seconds) allowed to establish a connection to the server"),(0,r.kt)("td",{parentName:"tr",align:null},"30")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#host"},(0,r.kt)("strong",{parentName:"a"},".host")," : string"),(0,r.kt)("br",null),"the name or the IP address of the host server"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"td"},"mandatory"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#logfile"},(0,r.kt)("strong",{parentName:"a"},".logFile")," : string"),(0,r.kt)("br",null),"the path of the extended log file defined (if any) for the mail connection"),(0,r.kt)("td",{parentName:"tr",align:null},"none")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},".password")," : string",(0,r.kt)("br",null),"User password for authentication on the server. Not returned in ",(0,r.kt)("em",{parentName:"td"},(0,r.kt)("a",{parentName:"em",href:"#smtptransporterobject"},"SMTP transporter"))," object."),(0,r.kt)("td",{parentName:"tr",align:null},"none")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#port"},(0,r.kt)("strong",{parentName:"a"},".port")," : integer"),(0,r.kt)("br",null)," the port number used for mail transactions"),(0,r.kt)("td",{parentName:"tr",align:null},"995")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"#user"},(0,r.kt)("strong",{parentName:"a"},".user")," : string"),(0,r.kt)("br",null)," the user name used for authentication on the mail server"),(0,r.kt)("td",{parentName:"tr",align:null},"none")))),(0,r.kt)("h4",{id:"result"},"Result"),(0,r.kt)("p",null,"The function returns a ",(0,r.kt)("strong",{parentName:"p"},"POP3 transporter object"),". All returned properties are ",(0,r.kt)("strong",{parentName:"p"},"read-only"),"."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"The POP3 connection is automatically closed when the transporter object is destroyed.")),(0,r.kt)("h4",{id:"example"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},'var server : object\nvar transporter : 4D.POP3Transporter\nvar status : object\nvar info : string\n\n\nserver = newObject()\nserver.host = "pop.gmail.com" //Mandatory\nserver.port = 995\nserver.user = "qodly@gmail.com"\nserver.password = "XXXXXXXX"\nserver.logFile = "LogTest.txt" //log to save in the Logs folder\n\ntransporter = 4D.POP3Transporter.new(server)\n\nstatus = transporter.checkConnection()\nif(not(status.success))\n  info = "An error occurred receiving the mail: "+status.statusText)\nend\n')),(0,r.kt)("h2",{id:"acceptunsecureconnection"},".acceptUnsecureConnection"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".acceptUnsecureConnection")," : boolean"),(0,r.kt)("h4",{id:"description-1"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".acceptUnsecureConnection")," property contains ",(0,r.kt)("strong",{parentName:"p"},"true")," if Qodly is allowed to establish an unencrypted connection when encrypted connection is not possible."),(0,r.kt)("p",null,"It contains ",(0,r.kt)("strong",{parentName:"p"},"false")," if unencrypted connections are unallowed, in which case an error in returned when encrypted connection is not possible."),(0,r.kt)("p",null,"Available secured ports are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"SMTP"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"465: SMTPS"),(0,r.kt)("li",{parentName:"ul"},"587 or 25: SMTP with STARTTLS upgrade if supported by the server."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"IMAP"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"143: IMAP non-encrypted port"),(0,r.kt)("li",{parentName:"ul"},"993: IMAP with STARTTLS upgrade if supported by the server"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"POP3"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"110: POP3 non-encrypted port"),(0,r.kt)("li",{parentName:"ul"},"995: POP3 with STARTTLS upgrade if supported by the server.")))),(0,r.kt)("h2",{id:"authenticationmode"},".authenticationMode"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".authenticationMode")," : string"),(0,r.kt)("h4",{id:"description-2"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".authenticationMode")," property contains the authentication mode used to open the session on the mail server."),(0,r.kt)("p",null,"By default, the most secured mode supported by the server is used."),(0,r.kt)("p",null,"Possible values are:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Value"),(0,r.kt)("th",{parentName:"tr",align:null},"Constants"),(0,r.kt)("th",{parentName:"tr",align:null},"Comment"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"APOP"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"kPOP3AuthenticationAPOP")),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication using APOP protocol (POP3 only)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"CRAM-MD5"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"kPOP3AuthenticationCRAMMD5")),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication using CRAM-MD5 protocol")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"LOGIN"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"kPOP3AuthenticationLogin")),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication using LOGIN protocol")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"OAUTH2"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"kPOP3AuthenticationOAUTH2")),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication using OAuth2 protocol")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"PLAIN"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"kPOP3AuthenticationPlain")),(0,r.kt)("td",{parentName:"tr",align:null},"Authentication using PLAIN protocol")))),(0,r.kt)("h2",{id:"checkconnection"},".checkConnection()"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".checkConnection()")," : object"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:"center"}),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Result"),(0,r.kt)("td",{parentName:"tr",align:null},"object"),(0,r.kt)("td",{parentName:"tr",align:"center"},"<-"),(0,r.kt)("td",{parentName:"tr",align:null},"Status of the transporter object connection")))),(0,r.kt)("h4",{id:"description-3"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".checkConnection()")," function  checks the connection using information stored in the transporter object, recreates the connection if necessary, and returns the status. This function allows you to verify that the values provided by the user are valid and consistent."),(0,r.kt)("h4",{id:"returned-object"},"Returned object"),(0,r.kt)("p",null,"The function sends a request to the mail server and returns an object describing the mail status. This object can contain the following properties:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null}),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"success"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:null},"true if the check is successful, false otherwise")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"status"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"number"),(0,r.kt)("td",{parentName:"tr",align:null},"(SMTP only) Status code returned by the mail server (0 in case of an issue unrelated to the mail processing)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"statusText"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"text"),(0,r.kt)("td",{parentName:"tr",align:null},"Status message returned by the mail server, or last error returned in the Qodly error stack")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"errors"),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"collection"),(0,r.kt)("td",{parentName:"tr",align:null},"Qodly error stack (not returned if a mail server response is received)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"["," ].errCode"),(0,r.kt)("td",{parentName:"tr",align:null},"number"),(0,r.kt)("td",{parentName:"tr",align:null},"Qodly error code")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"["," ].message"),(0,r.kt)("td",{parentName:"tr",align:null},"text"),(0,r.kt)("td",{parentName:"tr",align:null},"Description of the Qodly error")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"["," ].componentSignature"),(0,r.kt)("td",{parentName:"tr",align:null},"text"),(0,r.kt)("td",{parentName:"tr",align:null},"Signature of the internal component which returned the error")))),(0,r.kt)("h4",{id:"example-1"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},'var options : object\nvar transporter : 4D.POP3Transporter\nvar status : object\nvar info : string\n\noptions = newObject()\n\noptions.host = "pop3.gmail.com"\noptions.user = "test@gmail.com"\noptions.password = "XXXXXXXX"\n\ntransporter = 4D.POP3Transporter.new(options)\n\nstatus = transporter.checkConnection()\nif(status.success)\n  info = "POP3 connection check successful!"\nelse\n  info = "Error: "+status.statusText\nend\n')),(0,r.kt)("h2",{id:"connectiontimeout"},".connectionTimeOut"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".connectionTimeOut")," : integer"),(0,r.kt)("h4",{id:"description-4"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".connectionTimeOut")," property contains the maximum wait time (in seconds) allowed to establish a connection to the server. By default, if the property has not been set in the server object (used to create the transporter object with ",(0,r.kt)("inlineCode",{parentName:"p"},"SMTP New transporter"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3 New transporter"),", or ",(0,r.kt)("inlineCode",{parentName:"p"},"IMAP New transporter"),"), the value is 30."),(0,r.kt)("h2",{id:"delete"},".delete()"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".delete"),"( ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," : integer )"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:"center"}),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"msgNumber"),(0,r.kt)("td",{parentName:"tr",align:null},"integer"),(0,r.kt)("td",{parentName:"tr",align:"center"},"->"),(0,r.kt)("td",{parentName:"tr",align:null},"Number of the message to delete")))),(0,r.kt)("h5",{id:"description-5"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".delete()")," function flags the ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," email for deletion from the POP3 server."),(0,r.kt)("p",null,"In the ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," parameter, pass the number of the email to delete. This number is returned in the number property by the ",(0,r.kt)("a",{parentName:"p",href:"#getmailinfolist"},(0,r.kt)("inlineCode",{parentName:"a"},".getMailInfoList()"))," function."),(0,r.kt)("p",null,"Executing this function does not actually remove any email. The flagged email will be deleted from the POP3 server only when the ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3_transporter")," object is destroyed. The flag could be also be removed using the ",(0,r.kt)("inlineCode",{parentName:"p"},".undeleteAll()")," function."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"If the current session unexpectedly terminates and the connection is closed (e.g., timeout, network failure, etc.), an error message is generated and messages marked for deletion will remain on the POP3 server.")),(0,r.kt)("h5",{id:"example-2"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},'var mailInfoList : collection\nvar mailInfo : object\nvar confirmed : boolean\n\nmailInfoList = POP3_transporter.getMailInfoList()\nforEach (mailInfo , mailInfoList)\n  // Mark your mail as "to be deleted at the end of the session"\n  POP3_transporter.delete(mailInfo.number)\nend\n  // Force the session closure to delete the mails marked for deletion\n\nif(confirmed) //deletion is confirmed by a user\n  POP3_transporter = null\nelse\n  POP3_transporter.undeleteAll() //remove deletion flags\nend\n')),(0,r.kt)("h2",{id:"getboxinfo"},".getBoxInfo()"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".getBoxInfo()")," : object"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:"center"}),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Result"),(0,r.kt)("td",{parentName:"tr",align:null},"object"),(0,r.kt)("td",{parentName:"tr",align:"center"},"<-"),(0,r.kt)("td",{parentName:"tr",align:null},"boxInfo object")))),(0,r.kt)("h5",{id:"description-6"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".getBoxInfo()")," function returns a ",(0,r.kt)("inlineCode",{parentName:"p"},"boxInfo")," object corresponding to the mailbox designated by the ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3 transporter")," object. This function allows you to retrieve information about the mailbox."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"boxInfo")," object returned contains the following properties:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"mailCount"),(0,r.kt)("td",{parentName:"tr",align:null},"number"),(0,r.kt)("td",{parentName:"tr",align:null},"Number of messages in the mailbox")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"size"),(0,r.kt)("td",{parentName:"tr",align:null},"number"),(0,r.kt)("td",{parentName:"tr",align:null},"Message size in bytes")))),(0,r.kt)("h5",{id:"example-3"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},'var server , boxinfo : object\nvar transporter : 4D.POP3Transporter\nvar info : string\n\n\nserver = newObject()\nserver.host = "pop.gmail.com" //Mandatory\nserver.port = 995\nserver.user = "qodly@gmail.com"\nserver.password = "XXXXXXXX"\n\ntransporter = 4D.POP3Transporter.new(server)\n\n  //mailbox info\nboxInfo = transporter.getBoxInfo()\ninfo = "The mailbox contains "+string(boxInfo.mailCount)+" messages.")\n')),(0,r.kt)("h2",{id:"getmail"},".getMail()"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".getMail"),"( ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," : integer { ; ",(0,r.kt)("em",{parentName:"p"},"headerOnly")," : boolean } ) : object"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:"center"}),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"msgNumber"),(0,r.kt)("td",{parentName:"tr",align:null},"integer"),(0,r.kt)("td",{parentName:"tr",align:"center"},"->"),(0,r.kt)("td",{parentName:"tr",align:null},"Number of the message in the list")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"headerOnly"),(0,r.kt)("td",{parentName:"tr",align:null},"boolean"),(0,r.kt)("td",{parentName:"tr",align:"center"},"->"),(0,r.kt)("td",{parentName:"tr",align:null},"True to download only the email headers (default is false)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Result"),(0,r.kt)("td",{parentName:"tr",align:null},"object"),(0,r.kt)("td",{parentName:"tr",align:"center"},"<-"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"/docs/language/EmailObjectClass"},"Email object"))))),(0,r.kt)("h5",{id:"description-7"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".getMail()")," function returns the ",(0,r.kt)("inlineCode",{parentName:"p"},"Email")," object corresponding to the ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," in the mailbox designated by the ",(0,r.kt)("a",{parentName:"p",href:"#pop3-transporter-object"},(0,r.kt)("inlineCode",{parentName:"a"},"POP3 transporter")),". This function allows you to locally handle the email contents."),(0,r.kt)("p",null,"Pass in ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," the number of the message to retrieve. This number is returned in the ",(0,r.kt)("inlineCode",{parentName:"p"},"number")," property by the ",(0,r.kt)("a",{parentName:"p",href:"#getmailinfolist"},(0,r.kt)("inlineCode",{parentName:"a"},".getMailInfoList()"))," function."),(0,r.kt)("p",null,"Optionally, you can pass ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," in the ",(0,r.kt)("em",{parentName:"p"},"headerOnly")," parameter to exclude the body parts from the returned ",(0,r.kt)("inlineCode",{parentName:"p"},"Email")," object. Only headers properties (",(0,r.kt)("a",{parentName:"p",href:"/docs/language/EmailObjectClass#headers"},(0,r.kt)("inlineCode",{parentName:"a"},"headers")),", ",(0,r.kt)("a",{parentName:"p",href:"/docs/language/EmailObjectClass#to"},(0,r.kt)("inlineCode",{parentName:"a"},"to")),", ",(0,r.kt)("a",{parentName:"p",href:"/docs/language/EmailObjectClass#from"},(0,r.kt)("inlineCode",{parentName:"a"},"from")),"...) are then returned. This option allows you to optimize the downloading step when a lot of emails are on the server.   "),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"The ",(0,r.kt)("em",{parentName:"p"},"headerOnly")," option may not be supported by the server.")),(0,r.kt)("p",null,"The function returns Null if:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"msgNumber")," designates a non-existing message,"),(0,r.kt)("li",{parentName:"ul"},"the message was marked for deletion using ",(0,r.kt)("a",{parentName:"li",href:"#delete"},(0,r.kt)("inlineCode",{parentName:"a"},".delete()")),".")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Returned object")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},".getMail()")," returns an ",(0,r.kt)("a",{parentName:"p",href:"/docs/language/EmailObjectClass#email-object"},(0,r.kt)("inlineCode",{parentName:"a"},"Email")," object"),"."),(0,r.kt)("h5",{id:"example-4"},"Example"),(0,r.kt)("p",null,"You want to know the sender of the first mail of the mailbox:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},'var server : object\nvar transporter : 4D.POP3Transporter\nvar mailInfo : collection\nvar sender : variant\n\nserver = newObject()\nserver.host = "pop.gmail.com" //Mandatory\nserver.port = 995\nserver.user = "qodly@gmail.com"\nserver.password = "XXXXXXXX"\n\ntransporter = 4D.POP3Transporter.new (server)\n\nmailInfo = transporter.getMailInfoList()\n\nsender = transporter.getMail(mailInfo[0].number).from\n')),(0,r.kt)("h2",{id:"getmailinfo"},".getMailInfo()"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".getMailInfo"),"( ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," : integer ) : object"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:"center"}),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"msgNumber"),(0,r.kt)("td",{parentName:"tr",align:null},"integer"),(0,r.kt)("td",{parentName:"tr",align:"center"},"->"),(0,r.kt)("td",{parentName:"tr",align:null},"Number of the message in the list")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Result"),(0,r.kt)("td",{parentName:"tr",align:null},"object"),(0,r.kt)("td",{parentName:"tr",align:"center"},"<-"),(0,r.kt)("td",{parentName:"tr",align:null},"mailInfo object")))),(0,r.kt)("h5",{id:"description-8"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".getMailInfo()")," function returns a ",(0,r.kt)("inlineCode",{parentName:"p"},"mailInfo")," object corresponding  corresponding to the ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," in the mailbox designated by the ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3 transporter"),". This function allows you to retrieve information about the email."),(0,r.kt)("p",null,"In ",(0,r.kt)("em",{parentName:"p"},"msgNumber"),', pass the number of the message to retrieve. This number is returned in the "number" property by the ',(0,r.kt)("a",{parentName:"p",href:"#getmailinfolist"},(0,r.kt)("inlineCode",{parentName:"a"},".getMailInfoList()"))," function."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"mailInfo")," object returned contains the following properties:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"size"),(0,r.kt)("td",{parentName:"tr",align:null},"number"),(0,r.kt)("td",{parentName:"tr",align:null},"Message size in bytes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"id"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Unique ID of the message")))),(0,r.kt)("p",null,"The method returns ",(0,r.kt)("strong",{parentName:"p"},"Null")," if:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"msgNumber")," designates a non-existing message,"),(0,r.kt)("li",{parentName:"ul"},"the message was marked for deletion using ",(0,r.kt)("a",{parentName:"li",href:"#delete"},(0,r.kt)("inlineCode",{parentName:"a"},".delete()")),".")),(0,r.kt)("h5",{id:"example-5"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},'var server , mailInfo : object\nvar mailNumber : integer\nvar transporter : 4D.POP3Transporter\nvar info : string\n\nserver.host = "pop.gmail.com" //Mandatory\nserver.port = 995\nserver.user = "qodly@gmail.com"\nserver.password:="XXXXXXXX"\n\ntransporter = 4D.POP3Transporter.new (server)\n\n //message info\nmailInfo = transporter.getMailInfo(1) //get the first mail\nif (mailInfo != null)\n   info = "First mail size is:"+string(mailInfo.size)+" bytes."\nend\n')),(0,r.kt)("h2",{id:"getmailinfolist"},".getMailInfoList()"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".getMailInfoList()")," : collection"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:"center"}),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Result"),(0,r.kt)("td",{parentName:"tr",align:null},"collection"),(0,r.kt)("td",{parentName:"tr",align:"center"},"<-"),(0,r.kt)("td",{parentName:"tr",align:null},"Collection of ",(0,r.kt)("inlineCode",{parentName:"td"},"mailInfo")," objects")))),(0,r.kt)("h5",{id:"description-9"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".getMailInfoList()")," function returns a collection of ",(0,r.kt)("inlineCode",{parentName:"p"},"mailInfo")," objects describing all messages in the mailbox designated by the ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3 transporter"),". This function allows you to locally manage the list of messages located on the POP3 mail server."),(0,r.kt)("p",null,"Each ",(0,r.kt)("inlineCode",{parentName:"p"},"mailInfo")," object in the returned collection contains the following properties:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"[","].size"),(0,r.kt)("td",{parentName:"tr",align:null},"number"),(0,r.kt)("td",{parentName:"tr",align:null},"Message size in bytes")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"[","].number"),(0,r.kt)("td",{parentName:"tr",align:null},"number"),(0,r.kt)("td",{parentName:"tr",align:null},"Message number")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"[","].id"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Unique ID of the message (useful if you store the message locally)")))),(0,r.kt)("p",null,"If the mailbox does not contain a message, an empty collection is returned."),(0,r.kt)("h4",{id:"number-and-id-properties"},"number and ID properties"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"number")," is the number of a message in the mailbox at the time the ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3_transporter")," was created. The ",(0,r.kt)("em",{parentName:"p"},"number")," property is not a static value in relation to any specific message and will change from session to session dependent on its relation to other messages in the mailbox at the time the session was opened. The numbers assigned to the messages are only valid during the lifetime of the ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3_transporter")," object. At the time the ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3_transporter")," is deleted any message marked for deletion will be removed. When the user logs back into the server, the current messages in the mailbox will be renumbered from 1 to x."),(0,r.kt)("p",null,"The ",(0,r.kt)("em",{parentName:"p"},"id")," however is a unique number assigned to the message when it was received by the server. This number is calculated using the time and date that the message is received and is a value assigned by your POP3 server. Unfortunately, POP3 servers do not use the ",(0,r.kt)("em",{parentName:"p"},"id")," as the primary reference to their messages. Throughout the POP3 sessions you will need to specify the ",(0,r.kt)("em",{parentName:"p"},"number")," as the reference to messages on the server. Developers may need to take some care if developing solutions which bring references to messages into a database but leave the body of the message on the server."),(0,r.kt)("h5",{id:"example-6"},"Example"),(0,r.kt)("p",null,"You want to know the total number and size of emails in the mailbox:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},'var server : object\nvar transporter : 4D.POP3Transporter\nvar mailInfo : collection\nvar vNum , vSize : integer\nvar info = string\n\nserver = newObject()\nserver.host = "pop.gmail.com" //Mandatory\nserver.port = 995\nserver.user = "qodly@gmail.com"\nserver.password = "XXXXXXXX"\n\ntransporter = 4D.POP3Transporter.new (server)\n\nmailInfo = transporter.getMailInfoList()\nvNum = mailInfo.length\nvSize = mailInfo.sum("size")\n\ninfo = "The mailbox contains "+string(vNum)+" message(s) for "+string(vSize)+" bytes.")\n')),(0,r.kt)("h2",{id:"getmimeasblob"},".getMIMEAsBlob()"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".getMIMEAsBlob"),"( ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," : integer ) : Blob"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:"center"}),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"msgNumber"),(0,r.kt)("td",{parentName:"tr",align:null},"integer"),(0,r.kt)("td",{parentName:"tr",align:"center"},"->"),(0,r.kt)("td",{parentName:"tr",align:null},"Number of the message in the list")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Result"),(0,r.kt)("td",{parentName:"tr",align:null},"blob"),(0,r.kt)("td",{parentName:"tr",align:"center"},"<-"),(0,r.kt)("td",{parentName:"tr",align:null},"Blob of the MIME string returned from the mail server")))),(0,r.kt)("h5",{id:"description-10"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".getMIMEAsBlob()")," function returns a BLOB containing the MIME contents for the message corresponding to the ",(0,r.kt)("em",{parentName:"p"},"msgNumber")," in the mailbox designated by the ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3_transporter"),"."),(0,r.kt)("p",null,"In ",(0,r.kt)("em",{parentName:"p"},"msgNumber"),', pass the number of the message to retrieve. This number is returned in the "number" property by the ',(0,r.kt)("a",{parentName:"p",href:"#getmailinfolist"},(0,r.kt)("inlineCode",{parentName:"a"},".getMailInfoList()"))," function."),(0,r.kt)("p",null,"The function returns an empty BLOB if:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"msgNumber")," designates a non-existing message,"),(0,r.kt)("li",{parentName:"ul"},"the message was marked for deletion using ",(0,r.kt)("a",{parentName:"li",href:"#delete"},(0,r.kt)("inlineCode",{parentName:"a"},".delete()")),".")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Returned blob")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},".getMIMEAsBlob()")," returns a ",(0,r.kt)("inlineCode",{parentName:"p"},"blob")," which can be archived in a database or converted to an ",(0,r.kt)("a",{parentName:"p",href:"/docs/language/EmailObjectClass#email-object"},(0,r.kt)("inlineCode",{parentName:"a"},"Email")," object")," with the ",(0,r.kt)("a",{parentName:"p",href:"/docs/language/commands/mailConvertFromMIME"},(0,r.kt)("inlineCode",{parentName:"a"},"MAIL Convert from MIME"))," command."),(0,r.kt)("h5",{id:"example-7"},"Example"),(0,r.kt)("p",null,"You want to know the total number and size of emails in the mailbox:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},'var server : object\nvar mailInfo : collection\nvar blob : blob\nvar transporter : 4D.POP3Transporter\n\nserver = newObject()\nserver.host = "pop.gmail.com" //Mandatory\nserver.port = 995\nserver.user = "qodly@gmail.com"\nserver.password = "XXXXXXXX"\n\ntransporter = 4D.POP3Transporter.new (server)\n\nmailInfo = transporter.getMailInfoList()\nblob = transporter.getMIMEAsBlob(mailInfo[0].number)\n')),(0,r.kt)("h2",{id:"host"},".host"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".host")," : string"),(0,r.kt)("h4",{id:"description-11"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".host")," property contains the name or the IP address of the host server. Used for mail transactions (SMTP, POP3, IMAP)."),(0,r.kt)("h2",{id:"logfile"},".logFile"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".logFile")," : string"),(0,r.kt)("h4",{id:"description-12"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".logFile")," property contains the path of the extended log file defined (if any) for the mail connection. "),(0,r.kt)("h2",{id:"port"},".port"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".port")," : integer"),(0,r.kt)("h4",{id:"description-13"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".port")," property contains  the port number used for mail transactions. By default, if the ",(0,r.kt)("em",{parentName:"p"},"port")," property has not been set in the ",(0,r.kt)("em",{parentName:"p"},"server")," object (used to create the transporter object), the port used is:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"SMTP")," - 587"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"POP3")," - 995"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"IMAP")," - 993")),(0,r.kt)("h2",{id:"undeleteall"},".undeleteAll()"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".undeleteAll()")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:"center"}),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:"center"}),(0,r.kt)("td",{parentName:"tr",align:null},"Does not require any parameters")))),(0,r.kt)("h5",{id:"description-14"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".undeleteAll()")," function removes all delete flags set on the emails in the ",(0,r.kt)("inlineCode",{parentName:"p"},"POP3_transporter")," object."),(0,r.kt)("h2",{id:"user"},".user"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},".user")," : string"),(0,r.kt)("h4",{id:"description-15"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".user")," property contains  the user name used for authentication on the mail server."))}d.isMDXComponent=!0}}]);