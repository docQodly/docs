"use strict";(self.webpackChunkqodly=self.webpackChunkqodly||[]).push([["92462"],{42217:function(e,n,s){s.r(n),s.d(n,{metadata:()=>t,contentTitle:()=>a,default:()=>h,assets:()=>c,toc:()=>r,frontMatter:()=>l});var t=JSON.parse('{"id":"api/classFunctionsOverview","title":"Overview","description":"Introduction","source":"@site/versioned_docs/version-1.1.0/api/classFunctionsOverview.md","sourceDirName":"api","slug":"/api/classFunctionsOverview","permalink":"/docs/api/classFunctionsOverview","draft":false,"unlisted":false,"editUrl":"https://github.com/qodly/docs/issues/new?title=Comment%20on%20api%2FclassFunctionsOverview.md%20(1.1.0)&body=Share%20any%20feedback%20about%20this%20page%20%E2%80%94%20report%20issues%2C%20suggest%20improvements%2C%20or%20tell%20us%20what%E2%80%99s%20helpful.%0A%0AIf%20it%E2%80%99s%20an%20issue%3A%0A-%20What%E2%80%99s%20the%20issue%3F%20(e.g.%2C%20typo%2C%20incorrect%20information%2C%20unclear%20explanation)%0A-%20Where%20is%20it%3F%20(e.g.%2C%20section%20name%2C%20specific%20paragraph%2C%20or%20line)%0A%0AThank%20you%20for%20helping%20us%20improve!%20%F0%9F%9A%80%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20","tags":[],"version":"1.1.0","frontMatter":{"id":"classFunctionsOverview","title":"Overview"},"sidebar":"Integrations","previous":{"title":"$version","permalink":"/docs/api/$version"},"next":{"title":"Function Parameters","permalink":"/docs/api/classFunctionsParameters"}}'),i=s("85893"),o=s("50065");let l={id:"classFunctionsOverview",title:"Overview"},a=void 0,c={},r=[{value:"Introduction",id:"introduction",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"<code>exposed</code> Functions",id:"exposed-functions",level:3},{value:"<code>onHttpGet</code> Functions",id:"onhttpget-functions",level:3},{value:"Key Concepts",id:"key-concepts",level:2},{value:"Function Call Syntax",id:"function-call-syntax",level:3},{value:"Handling Non-Exposed Functions",id:"handling-non-exposed-functions",level:3},{value:"REST API Endpoints",id:"rest-api-endpoints",level:2},{value:"Calling Dataclass or Entity Selection Functions",id:"calling-dataclass-or-entity-selection-functions",level:2},{value:"Use Case",id:"use-case",level:2},{value:"Step 1: Defining and Exposing a Function",id:"step-1-defining-and-exposing-a-function",level:3},{value:"Step 2: Calling the Function via REST API",id:"step-2-calling-the-function-via-rest-api",level:3},{value:"Step 3: Request",id:"step-3-request",level:3},{value:"Equivalent Code",id:"equivalent-code",level:4},{value:"Step 4: Sample Response",id:"step-4-sample-response",level:3},{value:"Error Handling",id:"error-handling",level:2}];function d(e){let n={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsxs)(n.p,{children:["ORDA (Object Relational Data Access) allows developers to interact with the data model of an application through REST APIs. Class functions defined in the ORDA data model and ",(0,i.jsx)(n.a,{href:"/docs/api/$singleton",children:"singleton class functions"})," can be exposed and called via REST requests. This allows external systems and clients to leverage the data and business logic encapsulated within an application."]}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.h3,{id:"exposed-functions",children:[(0,i.jsx)(n.code,{children:"exposed"})," Functions"]}),"\n",(0,i.jsxs)(n.p,{children:["Only functions marked with the ",(0,i.jsx)(n.code,{children:"exposed"})," keyword can be called from REST requests. This ensures that only intended functions are available for external access."]}),"\n",(0,i.jsx)(n.admonition,{title:"Example: Exposing a Function",type:"tip",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-qs",children:'exposed function getTest() : string\n    return "test"\n'})})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["For more details, refer to the section on ",(0,i.jsx)(n.a,{href:"/docs/guides/data-model-objects#exposed-vs-non-exposed-functions",children:"Exposed vs. Non-Exposed Functions"}),"."]})}),"\n",(0,i.jsxs)(n.h3,{id:"onhttpget-functions",children:[(0,i.jsx)(n.code,{children:"onHttpGet"})," Functions"]}),"\n",(0,i.jsxs)(n.p,{children:["Functions allowed to be called from HTTP ",(0,i.jsx)(n.code,{children:"GET"})," requests must also be specifically declared with the ",(0,i.jsxs)(n.a,{href:"/docs/guides/data-model-objects#onhttpget-keyword",children:[(0,i.jsx)(n.code,{children:"onHttpGet"})," keyword"]}),". For example:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-qs",children:"//allowing GET requests\nexposed onHttpGet function getSomeInfo() : 4D.OutgoingMessage\n"})}),"\n",(0,i.jsx)(n.h2,{id:"key-concepts",children:"Key Concepts"}),"\n",(0,i.jsx)(n.h3,{id:"function-call-syntax",children:"Function Call Syntax"}),"\n",(0,i.jsx)(n.p,{children:"Functions are called using POST or GET requests on the appropriate ORDA interface without parentheses. The URL and body of the request vary depending on the type of class function being called."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"POST {{ApiEndpoint}}/rest/Product/getProductDetails\n"})}),"\n",(0,i.jsx)(n.p,{children:"POST requests provide a better security level because they avoid running sensitive code through an action as simple as clicking on a link. However, GET requests can be more compliant with user experience, allowing to call functions by entering an URL in a browser (note: the developer must ensure no sensitive action is done in such functions)."}),"\n",(0,i.jsx)(n.h3,{id:"handling-non-exposed-functions",children:"Handling Non-Exposed Functions"}),"\n",(0,i.jsx)(n.p,{children:"If a class function is not marked as exposed, it is treated as an attribute rather than a function, resulting in an error response."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "__ERROR": [\n        {\n            "message": "The \\"getProductDetails\\" attribute cannot be found in The \\"Product\\" dataclass",\n            "componentSignature": "dbmg",\n            "errCode": 1500\n        },\n        {\n            "message": "Cannot completely build a list of attributes with \\"getProductDetails\\" for the \\"Product\\" dataclass",\n            "componentSignature": "dbmg",\n            "errCode": 1804\n        }\n    ]\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"rest-api-endpoints",children:"REST API Endpoints"}),"\n",(0,i.jsx)(n.p,{children:"The ORDA REST API provides several endpoints to call class functions:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Class function"}),(0,i.jsx)(n.th,{children:"Syntax"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"/docs/guides/data-model-objects#datastore",children:"Datastore Class"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/rest/$catalog/DataStoreClassFunction"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"/docs/guides/data-model-objects#dataclass",children:"Dataclass Class"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/rest/{{dataClass}}/DataClassClassFunction"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"/docs/guides/data-model-objects#entityselection-class",children:"EntitySelection Class"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/rest/{{dataClass}}/EntitySelectionClassFunction"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"/docs/guides/data-model-objects#entity-class",children:"Entity Class"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/rest/{{dataClass}}(key)/EntityClassFunction"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"/docs/language/basics/lang-classes#singleton-classes",children:"Singleton class"})}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"/rest/$singleton/SingletonClass/SingletonClassFunction"})," (see ",(0,i.jsx)(n.a,{href:"/docs/api/$singleton",children:"$singleton page"}),")"]})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"calling-dataclass-or-entity-selection-functions",children:"Calling Dataclass or Entity Selection Functions"}),"\n",(0,i.jsxs)(n.p,{children:["The endpoint ",(0,i.jsx)(n.code,{children:"{{ApiEndpoint}}/rest/{{dataClass}}/Function"})," is versatile and can be used to call either a dataclass function or an entity selection function. When making a call to this endpoint, the following process is followed to determine which function to execute:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Entity Selection Search"}),": The REST API first checks if the function exists in the entity selection class associated with the specified ",(0,i.jsx)(n.code,{children:"dataClass"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Dataclass Search"}),": If the function is not found in the entity selection class, the API then searches for the function in the ",(0,i.jsx)(n.code,{children:"dataClass"})," itself."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Function Execution"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"If the function is found in the entity selection class, it is executed with the context of the entity selection."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If the function is not found in the entity selection class but exists in the ",(0,i.jsx)(n.code,{children:"dataClass"}),", it is executed with the context of the ",(0,i.jsx)(n.code,{children:"dataClass"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If the function exists in both the ",(0,i.jsx)(n.code,{children:"dataClass"})," and the entity selection class, the function in the entity selection class will be executed, and the ",(0,i.jsx)(n.code,{children:"dataclass"})," function will be ignored. This prioritization ensures that operations intended for collections of entities are given precedence over those intended for individual entities or the ",(0,i.jsx)(n.code,{children:"dataClass"})," structure."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Fallback Behavior"}),": If the function is not found in either the entity selection class or the ",(0,i.jsx)(n.code,{children:"dataClass"}),", an error is returned indicating that the function does not exist."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"use-case",children:"Use Case"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-defining-and-exposing-a-function",children:"Step 1: Defining and Exposing a Function"}),"\n",(0,i.jsxs)(n.p,{children:["Consider a scenario where we have a ",(0,i.jsx)(n.code,{children:"Customer"})," dataClass with a function to retrieve customer details based on their ID:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-qs",children:'exposed function getCustomerDetails(customerID : Integer) : cs.CustomerEntity\n    return ds.Customer.query("ID = :1", customerID).first()\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In this example, the ",(0,i.jsx)(n.code,{children:"getCustomerDetails"})," function is exposed and can be called via the REST API to fetch details of a specific customer."]}),"\n",(0,i.jsx)(n.h3,{id:"step-2-calling-the-function-via-rest-api",children:"Step 2: Calling the Function via REST API"}),"\n",(0,i.jsxs)(n.p,{children:["To call the ",(0,i.jsx)(n.code,{children:"getCustomerDetails"}),' function for a customer with ID "123", you would use the following request:']}),"\n",(0,i.jsx)(n.h3,{id:"step-3-request",children:"Step 3: Request"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Method:"})," POST",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"URL:"})," ",(0,i.jsx)(n.code,{children:"{{ApiEndpoint}}/rest/Customer/getCustomerDetails"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Body:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:"[123]\n"})}),"\n",(0,i.jsx)(n.h4,{id:"equivalent-code",children:"Equivalent Code"}),"\n",(0,i.jsx)(n.p,{children:"This call is equivalent to:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-qs",children:"customerDetails = ds.Customer.getCustomerDetails(123)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"step-4-sample-response",children:"Step 4: Sample Response"}),"\n",(0,i.jsx)(n.p,{children:"The response from the server would look something like this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n    "__entityModel": "Customer",\n    "__DATACLASS": "Customer",\n    "__KEY": "123",\n    "__TIMESTAMP": "2024-05-23T18:11:34.485Z",\n    "__STAMP": 1,\n    "ID": 123,\n    "firstName": "John",\n    "lastName": "Doe",\n    "email": "john.doe@example.com",\n    "orders": {\n        "__deferred": {\n            "uri": "/rest/Order?$filter=customerID=123",\n            "__COUNT": 5\n        }\n    },\n    "profilePicture": null\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.p,{children:"When making REST API calls to ORDA class functions, proper error handling should be implemented to manage cases where the function call fails or returns an unexpected result."}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"Ensure that your client application can gracefully handle errors and retries as necessary."})})]})}function h(e={}){let{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},50065:function(e,n,s){s.d(n,{Z:function(){return a},a:function(){return l}});var t=s(67294);let i={},o=t.createContext(i);function l(e){let n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);