"use strict";(self.webpackChunkqodly=self.webpackChunkqodly||[]).push([[8531],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var m=a.createContext({}),s=function(e){var t=a.useContext(m),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(m.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,m=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=s(n),u=r,g=c["".concat(m,".").concat(u)]||c[u]||d[u]||l;return n?a.createElement(g,o(o({ref:t},p),{},{components:n})):a.createElement(g,o({ref:t},p))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=u;var i={};for(var m in t)hasOwnProperty.call(t,m)&&(i[m]=t[m]);i.originalType=e,i[c]="string"==typeof e?e:r,o[1]=i;for(var s=2;s<l;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},7910:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>o,default:()=>c,frontMatter:()=>l,metadata:()=>i,toc:()=>s});var a=n(87462),r=(n(67294),n(3905));const l={id:"mailConvertToMIME",title:"mailConvertToMIME"},o=void 0,i={unversionedId:"language/commands/mailConvertToMIME",id:"language/commands/mailConvertToMIME",title:"mailConvertToMIME",description:"mailConvertToMIME( mail object } ) : string",source:"@site/docs/language/commands/mailConvertToMIME.md",sourceDirName:"language/commands",slug:"/language/commands/mailConvertToMIME",permalink:"/docs/language/commands/mailConvertToMIME",draft:!1,editUrl:"https://github.com/docQodly/docs/edit/main/docs/language/commands/mailConvertToMIME.md",tags:[],version:"current",frontMatter:{id:"mailConvertToMIME",title:"mailConvertToMIME"},sidebar:"Develop",previous:{title:"mailConvertFromMIME",permalink:"/docs/language/commands/mailConvertFromMIME"},next:{title:"matchRegex",permalink:"/docs/language/commands/matchRegex"}},m={},s=[{value:"Description",id:"description",level:4},{value:"Example",id:"example",level:4}],p={toc:s};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"mailConvertToMIME"),"( ",(0,r.kt)("em",{parentName:"p"},"mail")," : object { , ",(0,r.kt)("em",{parentName:"p"},"options")," : object } ) : string"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:"center"}),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"mail"),(0,r.kt)("td",{parentName:"tr",align:null},"object"),(0,r.kt)("td",{parentName:"tr",align:"center"},"->"),(0,r.kt)("td",{parentName:"tr",align:null},"Email object")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"options"),(0,r.kt)("td",{parentName:"tr",align:null},"object"),(0,r.kt)("td",{parentName:"tr",align:"center"},"->"),(0,r.kt)("td",{parentName:"tr",align:null},"Charset and encoding mail options")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Result"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:"center"},"<-"),(0,r.kt)("td",{parentName:"tr",align:null},"Email object converted to MIME")))),(0,r.kt)("h4",{id:"description"},"Description"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"mailConvertToMIME")," command converts an email object into MIME string. This command is called internally by ",(0,r.kt)("inlineCode",{parentName:"p"},"SMTP_transporter.send()")," to format the email object before sending it. It can be used to analyze the MIME format of the object."),(0,r.kt)("p",null,"In ",(0,r.kt)("em",{parentName:"p"},"mail"),", pass the content and the structure details of the email to convert. This includes information such as the email addresses (sender and recipient(s)), the message itself, and the type of display for the message."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"QodlyScript follows the ",(0,r.kt)("a",{parentName:"p",href:"https://jmap.io/spec-mail.html"},"JMAP specification")," to format the email object.")),(0,r.kt)("p",null,"In ",(0,r.kt)("em",{parentName:"p"},"options"),", you can set a specific charset and encoding configuration for the mail. The following properties are available:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Property"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"headerCharset"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Charset and encoding used for the following parts of the email: subject, attachment filenames, and email name attribute(s). Possible values:",(0,r.kt)("table",null,(0,r.kt)("tr",null,(0,r.kt)("th",null,"Constant"),(0,r.kt)("th",null,"Value"),(0,r.kt)("th",null,"Comment")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"kMailModeUTF8"),(0,r.kt)("td",null,"US-ASCII_UTF8_QP"),(0,r.kt)("td",null,(0,r.kt)("i",null,"headerCharset")," & ",(0,r.kt)("i",null,"bodyCharset"),": US-ASCII if possible, otherwise UTF-8 & Quoted-printable (",(0,r.kt)("strong",{parentName:"td"},"default value"),")")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"kMailModeUTF8InBase64"),(0,r.kt)("td",null,"US-ASCII_UTF8_B64"),(0,r.kt)("td",null,(0,r.kt)("i",null,"headerCharset")," & ",(0,r.kt)("i",null,"bodyCharset"),": US-ASCII if possible, otherwise UTF-8 & base64"))))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"bodyCharset"),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Charset and encoding used for the html and string body contents of the email. Possible values: Same as for headerCharset (see above)")))),(0,r.kt)("p",null,"If the ",(0,r.kt)("em",{parentName:"p"},"options")," parameter is omitted, the mail mode UTF8 configuration is used for header and body parts."),(0,r.kt)("h4",{id:"example"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-qs"},'var mail: object\nvar mime: string\nmail = newObject\n\n// Creation of a mail\nmail.from = "tsales@massmarket.com"\nmail.subject = "Terrific Sale! This week only!"\nmail.stringBody = "string format email"\nmail.htmlBody = "<html><body>HTML format email</body></html>"\nmail.to = newcollection\nmail.to.push(newObject("email","noreply@4d.com"))\nmail.to.push(newObject("email","test@4d.com"))\n\n// transform the mail object in MIME\nmime = mailConvertToMIME(mail)\n\n// Contents of mime:\n// MIME-Version: 1.0\n// Date: Thu, 15 Dec 2022 15:42:25 GMT\n// Message-ID: <7CA5D25B2B5E0047A36F2E8CB30362E2>\n// Sender: tsales@massmarket.com\n// From: tsales@massmarket.com\n// To: noreply@qodly.com\n// To: test@qodly.com\n// Content-Type: multipart/alternative, boundary = "E0AE5773D5E95245BBBD80DD0687E218"\n// Subject: Terrific Sale! This week only!\n//\n// --E0AE5773D5E95245BBBD80DD0687E218\n// Content-Type: string/plain, charset = "UTF-8"\n// Content-Transfer-Encoding: quoted-printable\n//\n// string format email\n// --E0AE5773D5E95245BBBD80DD0687E218\n// Content-Type: string/html, charset = "UTF-8"\n// Content-Transfer-Encoding: quoted-printable\n//\n// <html><body>HTML format email</body></html>\n// --E0AE5773D5E95245BBBD80DD0687E218--\n')))}c.isMDXComponent=!0}}]);