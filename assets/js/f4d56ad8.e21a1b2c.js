"use strict";(self.webpackChunkqodly=self.webpackChunkqodly||[]).push([["33281"],{64953:function(e,t,n){n.r(t),n.d(t,{metadata:()=>s,contentTitle:()=>c,default:()=>h,assets:()=>d,toc:()=>l,frontMatter:()=>r});var s=JSON.parse('{"id":"language/DataStoreClass","title":"DataStore","description":"A Datastore is the interface object provided by ORDA to reference and access a database. A Datastore object is returned by the ds command (a shortcut to the main datastore) or the openDatastore command.","source":"@site/versioned_docs/version-1.0.0/language/DataStoreClass.md","sourceDirName":"language","slug":"/language/DataStoreClass","permalink":"/docs/1.0.0/language/DataStoreClass","draft":false,"unlisted":false,"editUrl":"https://github.com/qodly/docs/issues/new?title=Comment%20on%20language%2FDataStoreClass.md%20(1.0.0)&body=Share%20any%20feedback%20about%20this%20page%20%E2%80%94%20report%20issues%2C%20suggest%20improvements%2C%20or%20tell%20us%20what%E2%80%99s%20helpful.%0A%0AIf%20it%E2%80%99s%20an%20issue%3A%0A-%20What%E2%80%99s%20the%20issue%3F%20(e.g.%2C%20typo%2C%20incorrect%20information%2C%20unclear%20explanation)%0A-%20Where%20is%20it%3F%20(e.g.%2C%20section%20name%2C%20specific%20paragraph%2C%20or%20line)%0A%0AThank%20you%20for%20helping%20us%20improve!%20%F0%9F%9A%80%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20","tags":[],"version":"1.0.0","frontMatter":{"id":"DataStoreClass","title":"DataStore"},"sidebar":"Develop","previous":{"title":"DataClass","permalink":"/docs/1.0.0/language/DataClassClass"},"next":{"title":"Email","permalink":"/docs/1.0.0/language/EmailObjectClass"}}'),a=n("85893"),i=n("50065");let r={id:"DataStoreClass",title:"DataStore"},c=void 0,d={},l=[{value:"Functions and properties",id:"functions-and-properties",level:3},{value:".cancelTransaction()",id:"canceltransaction",level:2},{value:"Description",id:"description",level:4},{value:"Example",id:"example",level:4},{value:"<em>.dataclassName</em>",id:"dataclassname",level:2},{value:"Description",id:"description-1",level:4},{value:"Example",id:"example-1",level:4},{value:".isAdminProtected()",id:"isadminprotected",level:2},{value:"Description",id:"description-2",level:4},{value:"See also",id:"see-also",level:4},{value:".setAdminProtection()",id:"setadminprotection",level:2},{value:"Description",id:"description-3",level:4},{value:"Example",id:"example-2",level:4},{value:"See also",id:"see-also-1",level:4},{value:".startTransaction()",id:"starttransaction",level:2},{value:"Description",id:"description-4",level:4},{value:"Example",id:"example-3",level:4},{value:".validateTransaction()",id:"validatetransaction",level:2},{value:"Description",id:"description-5",level:4},{value:"Example",id:"example-4",level:4}];function o(e){let t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(t.p,{children:["A ",(0,a.jsx)(t.a,{href:"/docs/1.0.0/guides/data-model-objects#datastore",children:"Datastore"})," is the interface object provided by ORDA to reference and access a database. A ",(0,a.jsx)(t.code,{children:"Datastore"})," object is returned by the ",(0,a.jsx)(t.a,{href:"/docs/1.0.0/language/commands/ds",children:(0,a.jsx)(t.code,{children:"ds"})})," command (a shortcut to the main datastore) or the ",(0,a.jsx)(t.a,{href:"/docs/1.0.0/language/commands/openDatastore",children:(0,a.jsx)(t.code,{children:"openDatastore"})})," command."]}),"\n",(0,a.jsx)(t.h3,{id:"functions-and-properties",children:"Functions and properties"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsx)(t.tr,{children:(0,a.jsx)(t.th,{})})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsx)(t.tr,{children:(0,a.jsxs)(t.td,{children:[(0,a.jsxs)(t.a,{href:"#canceltransaction",children:[(0,a.jsx)(t.strong,{children:".cancelTransaction"}),"()"]}),"\xa0\xa0\xa0\xa0cancels the transaction"]})}),(0,a.jsx)(t.tr,{children:(0,a.jsxs)(t.td,{children:[(0,a.jsxs)(t.a,{href:"#dataclassname",children:[(0,a.jsx)(t.em,{children:(0,a.jsx)(t.strong,{children:".dataclassName"})})," : 4D.DataClass"]}),"\xa0\xa0\xa0\xa0all attributes of the dataclass as objects"]})}),(0,a.jsx)(t.tr,{children:(0,a.jsxs)(t.td,{children:[(0,a.jsxs)(t.a,{href:"#isadminprotected",children:[(0,a.jsx)(t.strong,{children:".isAdminProtected"}),"() : boolean"]}),"\xa0\xa0\xa0\xa0returns ",(0,a.jsx)(t.code,{children:"true"})," if Data Explorer access has been disabled for the working session"]})}),(0,a.jsx)(t.tr,{children:(0,a.jsxs)(t.td,{children:[(0,a.jsxs)(t.a,{href:"#setadminprotection",children:[(0,a.jsx)(t.strong,{children:".setAdminProtection"}),"( ",(0,a.jsx)(t.em,{children:"status"})," : boolean )"]}),"\xa0\xa0\xa0\xa0allows disabling any data access on the ",(0,a.jsx)(t.a,{href:"https://developer.4d.com/docs/en/Admin/webAdmin.html#webadmin-settings",children:"web admin port"}),", including for the ",(0,a.jsx)(t.a,{href:"https://developer.4d.com/docs/en/Admin/dataExplorer.html",children:"Data Explorer"})," in ",(0,a.jsx)(t.code,{children:"WebAdmin"})," sessions"]})}),(0,a.jsx)(t.tr,{children:(0,a.jsxs)(t.td,{children:[(0,a.jsxs)(t.a,{href:"#starttransaction",children:[(0,a.jsx)(t.strong,{children:".startTransaction"}),"()"]}),"\xa0\xa0\xa0\xa0starts a transaction in the current process on the database matching the datastore to which it applies"]})}),(0,a.jsx)(t.tr,{children:(0,a.jsxs)(t.td,{children:[(0,a.jsxs)(t.a,{href:"#validatetransaction",children:[(0,a.jsx)(t.strong,{children:".validateTransaction"}),"() "]}),"\xa0\xa0\xa0\xa0accepts the transaction"]})})]})]}),"\n",(0,a.jsx)(t.h2,{id:"canceltransaction",children:".cancelTransaction()"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:".cancelTransaction"}),"()"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Parameter"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{style:{textAlign:"center"}}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{}),(0,a.jsx)(t.td,{}),(0,a.jsx)(t.td,{style:{textAlign:"center"}}),(0,a.jsx)(t.td,{children:"Does not require any parameters"})]})})]}),"\n",(0,a.jsx)(t.h4,{id:"description",children:"Description"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:".cancelTransaction()"})," function cancels the transaction opened by the ",(0,a.jsx)(t.a,{href:"#starttransaction",children:(0,a.jsx)(t.code,{children:".startTransaction()"})})," function at the corresponding level in the current process for the specified datastore."]}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:".cancelTransaction()"})," function cancels any changes made to the data during the transaction."]}),"\n",(0,a.jsxs)(t.p,{children:["You can nest several transactions (sub-transactions). If the main transaction is cancelled, all of its sub-transactions are also cancelled, even if they were validated individually using the ",(0,a.jsx)(t.a,{href:"#validatetransaction",children:(0,a.jsx)(t.code,{children:".validateTransaction()"})})," function."]}),"\n",(0,a.jsx)(t.h4,{id:"example",children:"Example"}),"\n",(0,a.jsxs)(t.p,{children:["See example for the ",(0,a.jsx)(t.a,{href:"#starttransaction",children:(0,a.jsx)(t.code,{children:".startTransaction()"})})," function."]}),"\n",(0,a.jsx)(t.h2,{id:"dataclassname",children:(0,a.jsx)(t.em,{children:".dataclassName"})}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.em,{children:(0,a.jsx)(t.strong,{children:".dataclassName"})})," : 4D.DataClass"]}),"\n",(0,a.jsx)(t.h4,{id:"description-1",children:"Description"}),"\n",(0,a.jsxs)(t.p,{children:["Each dataclass in a datastore is available as a property of the ",(0,a.jsx)(t.a,{href:"/docs/1.0.0/guides/data-model-objects#datastore",children:"DataStore object"}),". The returned cs.object contains all attributes of the dataclass as objects."]}),"\n",(0,a.jsx)(t.h4,{id:"example-1",children:"Example"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-qs",children:" var emp : cs.Employee\n var sel : cs.EmployeeSelection\n emp = ds.Employee //emp contains the Employee dataclass\n sel = emp.all() //gets an entity selection of all employees\n\n  //you could also write directly:\n sel = ds.Employee.all()\n"})}),"\n",(0,a.jsx)(t.h2,{id:"isadminprotected",children:".isAdminProtected()"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:".isAdminProtected"}),"() : boolean"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Parameter"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{style:{textAlign:"center"}}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"Result"}),(0,a.jsx)(t.td,{children:"boolean"}),(0,a.jsx)(t.td,{style:{textAlign:"center"},children:"\u2190"}),(0,a.jsx)(t.td,{children:"true if the Data Explorer access is disabled, false if it is enabled (default)"})]})})]}),"\n",(0,a.jsx)(t.h4,{id:"description-2",children:"Description"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:".isAdminProtected()"})," function returns ",(0,a.jsx)(t.code,{children:"true"})," if Data Explorer access has been disabled for the working session."]}),"\n",(0,a.jsxs)(t.p,{children:["By default, the Data Explorer access is granted for ",(0,a.jsx)(t.code,{children:"webAdmin"})," sessions, but it can be disabled to prevent any data access from administrators (see the ",(0,a.jsx)(t.a,{href:"#setadminprotection",children:(0,a.jsx)(t.code,{children:".setAdminProtection()"})})," function)."]}),"\n",(0,a.jsx)(t.h4,{id:"see-also",children:"See also"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.a,{href:"#setadminprotection",children:(0,a.jsx)(t.code,{children:".setAdminProtection()"})})}),"\n",(0,a.jsx)(t.h2,{id:"setadminprotection",children:".setAdminProtection()"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:".setAdminProtection"}),"( ",(0,a.jsx)(t.em,{children:"status"})," : boolean )"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Parameter"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"status"}),(0,a.jsx)(t.td,{children:"boolean"}),(0,a.jsx)(t.td,{children:"\u2192"}),(0,a.jsxs)(t.td,{children:["true to disable Data Explorer access to data on the ",(0,a.jsx)(t.code,{children:"webAdmin"})," port, false (default) to grant access"]})]})})]}),"\n",(0,a.jsx)(t.h4,{id:"description-3",children:"Description"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:".setAdminProtection()"})," function allows disabling any data access on the ",(0,a.jsx)(t.a,{href:"https://developer.4d.com/docs/en/Admin/webAdmin.html#webadmin-settings",children:"web admin port"}),", including for the ",(0,a.jsx)(t.a,{href:"https://developer.4d.com/docs/en/Admin/dataExplorer.html",children:"Data Explorer"})," in ",(0,a.jsx)(t.code,{children:"WebAdmin"})," sessions."]}),"\n",(0,a.jsxs)(t.p,{children:["By default when the function is not called, access to data is always granted on the web administration port for a session with ",(0,a.jsx)(t.code,{children:"WebAdmin"})," privilege using the Data Explorer. In some configurations, for example when the application server is hosted on a third-party machine, you might not want the administrator to be able to view your data, although they can edit the server configuration, including the ",(0,a.jsx)(t.a,{href:"https://developer.4d.com/docs/en/Admin/webAdmin.html#access-key",children:"access key"})," settings."]}),"\n",(0,a.jsxs)(t.p,{children:["In this case, you can call this function to disable the data access from Data Explorer on the web admin port of the machine, even if the user session has the ",(0,a.jsx)(t.code,{children:"WebAdmin"})," privilege. When this function is executed, the data file is immediately protected and the status is stored on disk: the data file will be protected even if the application is restarted."]}),"\n",(0,a.jsx)(t.h4,{id:"example-2",children:"Example"}),"\n",(0,a.jsxs)(t.p,{children:["You create a ",(0,a.jsx)(t.em,{children:"protectDataFile"})," project method to call before deployments for example:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-qs",children:" ds.setAdminProtection(true) //Disables the Data Explorer data access\n"})}),"\n",(0,a.jsx)(t.h4,{id:"see-also-1",children:"See also"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.a,{href:"#isadminprotected",children:(0,a.jsx)(t.code,{children:".isAdminProtected()"})})}),"\n",(0,a.jsx)(t.h2,{id:"starttransaction",children:".startTransaction()"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:".startTransaction"}),"()"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Parameter"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{}),(0,a.jsx)(t.td,{}),(0,a.jsx)(t.td,{}),(0,a.jsx)(t.td,{children:"Does not require any parameters"})]})})]}),"\n",(0,a.jsx)(t.h4,{id:"description-4",children:"Description"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:".startTransaction()"})," function starts a transaction in the current process on the database matching the datastore to which it applies. Any changes made to the datastore's entities in the transaction's process are temporarily stored until the transaction is either validated or cancelled."]}),"\n",(0,a.jsxs)(t.blockquote,{children:["\n",(0,a.jsxs)(t.p,{children:["If this method is called on the main datastore (i.e. the datastore returned by the ",(0,a.jsx)(t.code,{children:"ds"})," command), the transaction is applied to all operations performed on the main datastore and on the underlying database."]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["You can nest several transactions (sub-transactions). Each transaction or sub-transaction must eventually be cancelled or validated. Note that if the main transaction is cancelled, all of its sub-transactions are also cancelled even if they were validated individually using the ",(0,a.jsx)(t.code,{children:".validateTransaction()"})," function."]}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["A transaction represents a series of changes made within a context on interconnected data. A transaction is only permanently saved in the datastore when the transaction is validated as a whole by calling ",(0,a.jsx)(t.a,{href:"#validatetransaction",children:(0,a.jsx)(t.code,{children:".validateTransaction()"})}),". If a transaction has not been validated, whether it was cancelled or because of some external event, the changes are not saved."]})}),"\n",(0,a.jsx)(t.h4,{id:"example-3",children:"Example"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-qs",children:' var connect,status : object\n var person : cs.PersonsEntity\n var ds : cs.DataStore\n var choice : string\n var error : boolean\n\n ds.startTransaction()\n person = ds.Persons.query("lastname == :1","Peters").first()\n\n if(person != null)\n    person.lastname = "Smith"\n    status = person.save()\n end\n ...\n ...\n if(lastErrors[0].errCode != 0)\n    ds.cancelTransaction()\n else\n    ds.validateTransaction()\n end\n'})}),"\n",(0,a.jsx)(t.h2,{id:"validatetransaction",children:".validateTransaction()"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.strong,{children:".validateTransaction"}),"()"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Parameter"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{}),(0,a.jsx)(t.td,{}),(0,a.jsx)(t.td,{}),(0,a.jsx)(t.td,{children:"Does not require any parameters"})]})})]}),"\n",(0,a.jsx)(t.h4,{id:"description-5",children:"Description"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:".validateTransaction()"})," function accepts the transaction that was started with ",(0,a.jsx)(t.a,{href:"#starttransaction",children:(0,a.jsx)(t.code,{children:".startTransaction()"})})," at the corresponding level."]}),"\n",(0,a.jsx)(t.p,{children:"The function saves the changes to the data that occurred during the transaction."}),"\n",(0,a.jsx)(t.p,{children:"You can nest several transactions (sub-transactions). If the main transaction is cancelled, all of its sub-transactions are also cancelled, even if they were validated individually using this function."}),"\n",(0,a.jsx)(t.h4,{id:"example-4",children:"Example"}),"\n",(0,a.jsxs)(t.p,{children:["See example for ",(0,a.jsx)(t.a,{href:"#starttransaction",children:(0,a.jsx)(t.code,{children:".startTransaction()"})}),"."]})]})}function h(e={}){let{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},50065:function(e,t,n){n.d(t,{Z:function(){return c},a:function(){return r}});var s=n(67294);let a={},i=s.createContext(a);function r(e){let t=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);